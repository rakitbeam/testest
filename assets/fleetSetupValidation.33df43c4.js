var W=Object.defineProperty,K=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var I=(t,e,n)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,c=(t,e)=>{for(var n in e||(e={}))q.call(e,n)&&I(t,n,e[n]);if(Y)for(var n of Y(e))J.call(e,n)&&I(t,n,e[n]);return t},f=(t,e)=>K(t,V(e));import{r as k,b,F as L,j as p,y as X,h as Z,P as Q,G as ee,A as te,z as ne,M as re,E as ue,I as oe,K as ie,v as ae,w as se,x as ce}from"./vendor.612e55a5.js";import{g as fe}from"./domUtils.e9df6b0f.js";import{c as F,b as me,S as _,t as le,s as $,h as R,V as j,X as E,j as de}from"./index.98bcaf9a.js";import{n as P}from"./sorting.c6946657.js";const pe=t=>{const{options:e,icon:n,text:u,value:r,onClick:o,buttonProps:i}=t,[a,s]=k.exports.useState(!1),m=k.exports.useRef(null),l=y=>{s(!1),o(y)};return b(L,{children:[p(X,{variant:"outlined",fullWidth:i==null?void 0:i.fullWidth,ref:m,disabled:i==null?void 0:i.disabled,size:i==null?void 0:i.size,children:p(Z,{startIcon:n,onClick:y=>{y.stopPropagation(),s(!0)},disabled:i==null?void 0:i.disabled,children:u})}),p(Q,{open:a,anchorEl:m.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:2},children:({TransitionProps:y,placement:A})=>p(ee,f(c({},y),{style:{transformOrigin:A==="bottom"?"center top":"center bottom"},children:p(te,{style:{maxHeight:fe(m.current),overflowY:"auto"},children:p(ne,{onClickAway:()=>s(!1),children:p(re,{children:e.map(h=>b(ue,{selected:h.value===r,onClick:x=>{x.stopPropagation(),l(h.value)},disabled:h.disabled,children:[h.icon&&p(oe,{children:h.icon}),p(ie,{children:h.text})]},h.key))})})})}))})]})};var B={},ye=se.exports;Object.defineProperty(B,"__esModule",{value:!0});var w=B.default=void 0,he=ye(ae),Fe=ce,_e=(0,he.default)((0,Fe.jsx)("path",{d:"M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"}),"Sort");w=B.default=_e;var d;(function(t){t.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME="groupByRowSortByTypeAndName",t.GROUP_BY_TYPE_SORT_BY_NAME="groupByTypeSortByName",t.SORT_BY_TYPE_AND_NAME="sortByTypeAndName",t.SORT_BY_NAME="sortByName"})(d||(d={}));const S={initial:0,self:1,ally:2,ally2:3,ally3:4},G=(t,e)=>{var n,u;return S[(n=t.reinforcement)!=null?n:"initial"]-S[(u=e.reinforcement)!=null?u:"initial"]},g=P([(t,e)=>t.shipDefinition.name.localeCompare(e.shipDefinition.name,"ja-JP"),G]),T=P([(t,e)=>$(t.shipDefinition.type,t.shipDefinition.subType)-$(e.shipDefinition.type,e.shipDefinition.subType),g,G]);function Ie(t,e){switch(t){case d.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME:return{groupedBy:t,groups:Ee(e.ships)};case d.GROUP_BY_TYPE_SORT_BY_NAME:return{groupedBy:t,groups:Re(e.ships)};case d.SORT_BY_TYPE_AND_NAME:return{groupedBy:t,groups:[{id:"all",name:"\u7DE8\u6210",ships:e.ships.map(n=>f(c({},n),{carriedShips:[...n.carriedShips].sort(T)})).sort(T),count:e.ships.map(n=>n.count).reduce((n,u)=>n+u,0)}]};case d.SORT_BY_NAME:return{groupedBy:t,groups:[{id:"all",name:"\u7DE8\u6210",ships:e.ships.map(n=>f(c({},n),{carriedShips:[...n.carriedShips].sort(g)})).sort(g),count:e.ships.map(n=>n.count).reduce((n,u)=>n+u,0)}]};default:throw new Error(`Unknown group and sort option "${t}"`)}}function Ee(t){return[_.FRONT,_.MIDDLE,_.BACK].map(e=>{const n=t.filter(r=>r.shipDefinition.row===e).map(r=>f(c({},r),{carriedShips:[...r.carriedShips].sort(T)})).sort(T),u=n.map(r=>r.count).reduce((r,o)=>r+o,0);return{id:e,name:le(e),ships:n,count:u}})}function Re(t){return[F.CARRIER,F.AUXILIARY,F.BATTLE_CRUISER,F.CRUISER,F.DESTROYER,F.FRIGATE].map(e=>{const n=t.filter(r=>r.shipDefinition.type===e).map(r=>f(c({},r),{carriedShips:[...r.carriedShips].sort(g)})).sort(g),u=n.map(r=>r.count).reduce((r,o)=>r+o,0);return{id:e,name:me(e),ships:n,count:u}})}function ke(t,e){return[t.name,e.groups.filter(n=>n.ships.length>0).map(n=>[...e.groups.length>1?[`\u3010${n.name}\u3011`]:[],...n.ships.flatMap(u=>{const r=u.count*u.shipDefinition.cost,o=ge(u);switch(u.reinforcement){case"self":return[`${u.count}\xD7\u3000${u.shipDefinition.name}\uFF08\u5897\u63F4\uFF09`,...o?[o]:[],...D(u.carriedShips)];case"ally":return[`${u.count}\xD7\u3000${u.shipDefinition.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF21\uFF09`,...o?[o]:[],...D(u.carriedShips)];case"ally2":return[`${u.count}\xD7\u3000${u.shipDefinition.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF22\uFF09`,...o?[o]:[],...D(u.carriedShips)];case"ally3":return[`${u.count}\xD7\u3000${u.shipDefinition.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF23\uFF09`,...o?[o]:[],...D(u.carriedShips)];default:return[`${u.count}\xD7\u3000${u.shipDefinition.name}\uFF08${r}Pt\uFF09`,...o?[o]:[],...D(u.carriedShips)]}})].join(`
`)).join(`

`),[`\u5897\u63F4\uFF1A${t.totalReinforcementCount}/${t.maxReinforcement}`,`\u6307\u4EE4Pt\uFF1A${t.totalCost}/${t.maxCost}`].join(`
`)].join(`

`)}function D(t){return t.map(e=>`\u3000\u3000${e.count}\xD7\u3000${e.shipDefinition.name}`)}function ge(t){if(t.moduleSelection===null||t.moduleSelection.static)return null;const e=["M","A","B","C"].flatMap(n=>{var i,a,s;const r=Object.keys((a=(i=t.moduleSelection)==null?void 0:i.groups[n])!=null?a:{}).find(m=>{var l;return((l=t.moduleSelection)==null?void 0:l.groups[n][m].usage)==="used"});if(!r)return[];const o=(s=t.moduleSelection)==null?void 0:s.groups[n][r];return!o||o.module.defaultModule?[]:o?[`${o.module.name}\uFF08${o.module.id}\uFF09`]:[]});return e.length===0?null:e.map(n=>`\u3000\u3000${n}`).join(`
`)}const be=t=>{const{value:e,onChange:n,buttonProps:u}=t;return p(L,{children:p(pe,{icon:p(w,{}),text:"\u8868\u793A",value:e,options:[{key:d.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME,text:"\u914D\u7F6E\u5225\u3001\u8266\u7A2E\u2192\u540D\u524D\u9806",value:d.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME},{key:d.GROUP_BY_TYPE_SORT_BY_NAME,text:"\u8266\u7A2E\u5225\u3001\u540D\u524D\u9806",value:d.GROUP_BY_TYPE_SORT_BY_NAME},{key:d.SORT_BY_TYPE_AND_NAME,text:"\u8266\u7A2E\u2192\u540D\u524D\u9806",value:d.SORT_BY_TYPE_AND_NAME},{key:d.SORT_BY_NAME,text:"\u540D\u524D\u9806",value:d.SORT_BY_NAME}],onClick:n,buttonProps:u})})};function Le(){var t,e,n,u,r;return[(t=C("fleet1"))!=null?t:M(1),(e=C("fleet2"))!=null?e:M(2),(n=C("fleet3"))!=null?n:M(3),(u=C("fleet4"))!=null?u:M(4),(r=C("fleet5"))!=null?r:M(5)]}function $e(t){const e=JSON.stringify(Ce(t));window.localStorage.setItem(t.key,e)}function C(t){const e=window.localStorage.getItem(t);if(!e)return null;const n=xe(e);return n?De(Me(n),t):null}function De(t,e){const n=t.myListOnly===!0,u=t.ships.map(r=>{var o;return f(c({},U({shipDefinition:R(r.shipId),usedModules:(o=r.usedModules)!=null?o:null,count:r.count,reinforcement:r.reinforcement,maxReinforcement:t.maxReinforcement})),{carriedShips:r.carriedShips.map(i=>H({shipId:i.shipId,count:i.count,reinforcement:r.reinforcement}))})});return{key:e,name:t.name,ships:u,totalCost:N(u),totalReinforcementCount:v(u),maxReinforcement:t.maxReinforcement,maxCost:t.maxCost,myListOnly:n}}function Ce(t){return{name:t.name,ships:t.ships.map(e=>({shipId:e.shipDefinition.id,usedModules:e.moduleSelection?Ae(e.moduleSelection):void 0,carriedShips:e.carriedShips.map(n=>({shipId:n.shipDefinition.id,count:n.count})),count:e.count,reinforcement:e.reinforcement})),maxReinforcement:t.maxReinforcement,maxCost:t.maxCost,myListOnly:t.myListOnly}}function Me(t){const e=t.ships.reduce((u,r)=>{const o=j(r.shipId),i=R(o);if(!i)return u;let a;r.usedModules&&i.modules&&(a=r.usedModules.filter(m=>{var l;return!!((l=i.modules)==null?void 0:l.find(y=>y.id===m))}));const s=r.carriedShips.flatMap(m=>{const l=j(m.shipId);return R(l)?[f(c({},m),{shipId:l})]:[]});return[...u,f(c({},r),{shipId:o,usedModules:a,carriedShips:s})]},[]);return f(c({},t),{ships:e})}function Ae(t){const e=[];return Object.keys(t.groups).forEach(n=>{Object.keys(t.groups[n]).forEach(u=>{t.groups[n][u].usage==="used"&&e.push(t.groups[n][u].module.id)})}),e}function xe(t){try{return JSON.parse(t)}catch(e){return alert("ERROR - Failed to restore fleet setup"),console.error(e),null}}function M(t){return{key:`fleet${t}`,name:`${t}\u53F7\u8266\u968A`,ships:[],totalCost:0,totalReinforcementCount:0,maxReinforcement:5,maxCost:400,myListOnly:!0}}function U(t){const{shipDefinition:e,usedModules:n,count:u,reinforcement:r,maxReinforcement:o,temporary:i}=t,a=Te(e,n),s=O(e,a),m=r===null||e.type===F.FIGHTER||e.type===F.CORVETTE?e.operationLimit:Math.min(e.operationLimit,o);return{shipDefinition:e,carrierCapabilities:s,carriedShips:[],count:Math.max(0,u),reinforcement:r,maxCount:m,moduleSelection:a,temporary:i}}function Te(t,e){if(!t.modules||t.modules.length===0)return null;const n=e!=null?e:t.modules.filter(r=>r.defaultModule).map(r=>r.id),u={static:t.staticModules===!0,groups:{}};return t.modules.forEach(r=>{if(u.groups[r.category]||(u.groups[r.category]={}),u.static){u.groups[r.category][r.id]={module:r,usage:"used"};return}u.groups[r.category][r.id]={module:r,usage:n.includes(r.id)?"used":"not_used"}}),u}function O(t,e){var i;let n=0,u=0,r=0,o=(i=t.carryCorvette)!=null?i:0;if(t.carryFighter)switch(t.carryFighterType){case E.LARGE_FIGHTER:{n+=t.carryFighter;break}case E.MEDIUM_FIGHTER:{u+=t.carryFighter;break}case E.SMALL_FIGHTER:{r+=t.carryFighter;break}}return e&&Object.keys(e.groups).forEach(a=>{var s;Object.keys((s=e.groups[a])!=null?s:{}).forEach(m=>{var y,A,h,x;const l=e.groups[a][m];if(l.usage==="used"){switch(l.module.carryFighterType){case E.LARGE_FIGHTER:{n+=(y=l.module.carryFighter)!=null?y:0;break}case E.MEDIUM_FIGHTER:{u+=(A=l.module.carryFighter)!=null?A:0;break}case E.SMALL_FIGHTER:{r+=(h=l.module.carryFighter)!=null?h:0;break}}o+=(x=l.module.carryCorvette)!=null?x:0}})}),{canCarry:n+u+r+o>0,carryUpToLargeFighter:n,carryUpToMediumFighter:u,carryUpToSmallFighter:r,carryCorvette:o}}function H(t){const{shipId:e,count:n,reinforcement:u,temporary:r}=t;return{shipDefinition:R(e),count:Math.max(0,n),reinforcement:u,temporary:r}}function je(t){const{shipId:e,count:n,reinforcement:u,fleetSetup:r,keepZero:o}=t,i=R(e);let a=!0;const s=f(c({},r),{ships:r.ships.flatMap(m=>m.shipDefinition.id!==e||m.reinforcement!==u?m:(a=!1,!o&&n<=0?[]:[f(c({},m),{count:n})]))});return a?f(c({},s),{ships:[...s.ships,U({shipDefinition:i,usedModules:null,count:n,reinforcement:u,maxReinforcement:r.maxReinforcement})],totalCost:N(s.ships),totalReinforcementCount:v(s.ships)}):f(c({},s),{totalCost:N(s.ships),totalReinforcementCount:v(s.ships)})}function Pe(t){const{shipId:e,carrierShipId:n,count:u,reinforcement:r,fleetSetup:o,keepZero:i}=t;return f(c({},o),{ships:o.ships.map(a=>a.shipDefinition.id!==n||a.reinforcement!==r?a:a.carriedShips.find(s=>s.shipDefinition.id===e)?f(c({},a),{carriedShips:a.carriedShips.flatMap(s=>{if(s.shipDefinition.id!==e)return[s];if(s.reinforcement!==r)throw new Error("Detected invalid reinforcement");return!i&&u<=0?[]:[f(c({},s),{count:Math.max(0,u),reinforcement:r})]})}):f(c({},a),{carriedShips:[...a.carriedShips,H({shipId:e,count:u,reinforcement:r})]}))})}function we(t){const{shipId:e,reinforcement:n,moduleSelection:u,fleetSetup:r}=t;return f(c({},r),{ships:r.ships.map(o=>o.shipDefinition.id!==e?o:(n==null?void 0:n.includes("ally"))?o.reinforcement===n?f(c({},o),{moduleSelection:u,carrierCapabilities:O(o.shipDefinition,u)}):o:!o.reinforcement||!o.reinforcement.includes("ally")?f(c({},o),{moduleSelection:u,carrierCapabilities:O(o.shipDefinition,u)}):o)})}function Se(t,e,n){return f(c({},n),{groups:f(c({},n.groups),{[t]:Object.keys(n.groups[t]).reduce((u,r)=>{const o=n.groups[t][r];return f(c({},u),{[r]:r===e?f(c({},o),{usage:"used"}):f(c({},o),{usage:"not_used"})})},n.groups[t])})})}function N(t){return t.filter(e=>e.reinforcement===null).map(e=>e.count*e.shipDefinition.cost).reduce((e,n)=>e+n,0)}function v(t){return t.filter(e=>e.reinforcement!==null).map(e=>e.count).reduce((e,n)=>e+n,0)}function Ge(t){let e=0;const n=t.map(o=>o.count).reduce((o,i)=>o+i,0),u=Object.keys(de).reduce((o,i)=>f(c({},o),{[i]:0}),{}),r={[_.FRONT]:0,[_.MIDDLE]:0,[_.BACK]:0,[_.NONE]:0};return t.forEach(o=>{o.reinforcement===null&&(e+=o.count*o.shipDefinition.cost),u[o.shipDefinition.type]+=o.count,r[o.shipDefinition.row]+=o.count,o.carriedShips.length>0&&o.carriedShips.forEach(i=>{u[i.shipDefinition.type]+=i.count})}),{shipCount:n,shipCountByType:u,shipCountByRow:r,totalCost:e}}function Ue(t){var n,u;const e={};return t.name.length===0&&(e.name="\u5FC5\u9808\u9805\u76EE"),(!Number.isFinite(t.maxReinforcement)||t.maxReinforcement<0)&&(e.maxReinforcement="\u7121\u52B9\u306A\u5024"),(!Number.isFinite(t.maxCost)||t.maxCost<300||t.maxCost>450)&&(e.maxCost="\u7121\u52B9\u306A\u5024"),t.maxCost>400&&t.maxReinforcement>5&&(e.maxReinforcement=(n=e.maxReinforcement)!=null?n:"\u57FA\u5730\u7D50\u5408\u52B9\u679C\u306F\uFF11\u3064\u307E\u3067\u3067\u3059",e.maxCost=(u=e.maxCost)!=null?u:"\u57FA\u5730\u7D50\u5408\u52B9\u679C\u306F\uFF11\u3064\u307E\u3067\u3067\u3059"),e}function He(t){const e={},n={},u={};return t.ships.forEach(r=>{const o=z(r.shipDefinition.id,r.reinforcement);if(n[o]){const i=n[o];n[o]={count:r.reinforcement===null?r.count:i.count,reinforcementCount:r.reinforcement!==null?r.count:i.reinforcementCount,operationLimit:r.shipDefinition.operationLimit}}else n[o]={count:r.reinforcement===null?r.count:0,reinforcementCount:r.reinforcement!==null?r.count:0,operationLimit:r.shipDefinition.operationLimit};r.carriedShips.forEach(i=>{const a=z(i.shipDefinition.id,r.reinforcement);u[a]?u[a].count+=i.count:u[a]={count:i.count,operationLimit:i.shipDefinition.operationLimit}})}),Object.keys(n).forEach(r=>{const o=n[r];o.count+o.reinforcementCount>o.operationLimit&&(e[r]="\u914D\u5099\u3057\u305F\u5408\u8A08\u6570\u304C\u7A3C\u50CD\u4E0A\u9650\u3092\u8D85\u3048\u3066\u3044\u307E\u3059\u3002")}),Object.keys(u).forEach(r=>{const o=u[r];o.count>o.operationLimit&&(e[r]="\u914D\u5099\u3057\u305F\u5408\u8A08\u6570\u304C\u7A3C\u50CD\u4E0A\u9650\u3092\u8D85\u3048\u3066\u3044\u307E\u3059\u3002")}),e}function z(t,e){const n=(e==null?void 0:e.includes("ally"))?e:"self";return`${t}#${n}`}export{pe as B,d as G,be as S,Ge as a,Ie as b,je as c,Pe as d,we as e,ke as f,Le as g,M as h,Ue as i,U as j,Se as k,z as l,H as m,$e as s,He as v};
