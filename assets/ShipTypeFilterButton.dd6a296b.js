var K=Object.defineProperty,L=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var C=(t,e,r)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,d=(t,e)=>{for(var r in e||(e={}))z.call(e,r)&&C(t,r,e[r]);if(M)for(var r of M(e))H.call(e,r)&&C(t,r,e[r]);return t},p=(t,e)=>L(t,W(e));import{r as m,b as x,F as U,s as $,j as n,h as j,P as q,G,t as Y,v as J,M as Q,w as V,x as X,y as Z,z as ee}from"./vendor.4663e7d5.js";import{c as R,i as A,r as k}from"./NavigationBar.ff166a92.js";import{i as w,g as te,S as u,d as v,e as f,t as re}from"./index.bd9adf92.js";import{P as I,W as E}from"./WishState.3db35fd5.js";import{g as se}from"./domUtils.e9df6b0f.js";var T={},ae=A.exports;Object.defineProperty(T,"__esModule",{value:!0});var N=T.default=void 0,le=ae(R),ne=k,oe=(0,le.default)((0,ne.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAlt");N=T.default=oe;var y={},ie=A.exports;Object.defineProperty(y,"__esModule",{value:!0});var P=y.default=void 0,ue=ie(R),ce=k,de=(0,ue.default)((0,ce.jsx)("path",{d:"M19.79 5.61C20.3 4.95 19.83 4 19 4H6.83l7.97 7.97 4.99-6.36zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41L2.81 2.81z"}),"FilterAltOff");P=y.default=de;function fe(t){return(t!=null?t:[u.FRONT,u.MIDDLE,u.BACK]).map(e=>({filterKey:e,name:re(e)}))}function he(t){return(t!=null?t:Object.keys(v)).map(e=>({filterKey:e,name:v[e].name}))}function Se(t={}){var e,r;return[...fe((e=t.shipRows)!=null?e:null),...he((r=t.shipTypes)!=null?r:null)]}function ye(){return d({[u.FRONT]:!1,[u.MIDDLE]:!1,[u.BACK]:!1},Object.keys(v).reduce((t,e)=>p(d({},t),{[e]:!1}),{}))}function pe(t){const e=d({},t);return Object.keys(e).forEach(r=>{e[r]=!1}),e}function _e(t,e){let r=t;return me(e)&&(r=r.filter(s=>e[s.row]===!0)),be(e)&&(r=r.filter(s=>e[s.type]===!0)),r}function Me(t){const e={[f.STARTER_SHIP]:[],[f.TECH_FILE]:[],[f.CITY_TRADE]:[],[f.DOCK_EFFECT]:[],[f.UNKNOWN]:[]};return t.forEach(r=>{e[r.source].push(r)}),e}function me(t){return[u.FRONT,u.MIDDLE,u.BACK].some(e=>t[e]===!0)}function be(t){return Object.keys(v).some(e=>t[e]===!0)}function Ce(t,e){return t.filter(r=>{var s;return((s=e[r.id])==null?void 0:s.possession)===I.POSSESSED})}function je(t,e){return t.filter(r=>{var s;return((s=e[r.id])==null?void 0:s.wish)===E.WANTED})}function Re(t,e){return t.filter(r=>{var s;return w(r.id)&&((s=e[r.id])==null?void 0:s.wish)===E.NOT_WANTED})}function Ae(t,e){return t.filter(a=>a.source===f.TECH_FILE||a.source===f.STARTER_SHIP).filter(a=>{var l;return((l=e[a.id])==null?void 0:l.possession)===I.POSSESSED}).filter(a=>{var l,c,h;if(!!a.modules&&a.modules.length>0||a.baseModelId)return!1;if(!!a.subModelIds||!!a.baseModelId){const b=(h=(c=a.subModelIds)!=null?c:(l=te(a.baseModelId))==null?void 0:l.subModelIds)!=null?h:[];return Fe(b,e)?!(b.filter(i=>w(i)&&!!e[i]&&e[i].possession!==I.POSSESSED).filter(i=>e[i].wish!==E.NOT_WANTED).length>0):!1}return!0})}function Fe(t,e){return t.length>0&&t.every(r=>{var s;return!!((s=e[r])==null?void 0:s.possession)})}const ke=t=>{const{onChange:e,popperProps:r,shipRows:s,shipTypes:a,buttonProps:l}=t,[c,h]=m.exports.useState(t.filter),[b,O]=m.exports.useState(!1),[_]=m.exports.useState(()=>Se({shipRows:s,shipTypes:a})),i=m.exports.useRef(null),g=o=>{h(F=>p(d({},F),{[o]:!F[o]}))},B=()=>{h(o=>pe(o))};m.exports.useEffect(()=>{const o=setTimeout(()=>{e(c)},0);return()=>clearTimeout(o)},[c,e]);const D=Object.values(c).some(o=>o);return x(U,{children:[x($,{variant:"outlined",ref:i,fullWidth:l==null?void 0:l.fullWidth,size:l==null?void 0:l.size,children:[n(j,{startIcon:n(N,{}),onClick:()=>O(!0),sx:{flexShrink:1},children:"\u30D5\u30A3\u30EB\u30BF\u30FC"}),D&&n(j,{size:"small",onClick:B,sx:{flexShrink:3},children:n(P,{})})]},"filter"),n(q,p(d({open:b,anchorEl:i.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:1}},r),{children:({TransitionProps:o,placement:F})=>n(G,p(d({},o),{style:{transformOrigin:F==="bottom"?"center top":"center bottom"},children:n(Y,{style:{maxHeight:se(i.current),overflowY:"auto"},children:n(J,{onClickAway:()=>O(!1),children:n(Q,{id:"split-button-menu",children:_.map(S=>x(V,{selected:c[S.filterKey],onClick:()=>g(S.filterKey),children:[n(X,{children:n(Z,{edge:"start",checked:c[S.filterKey],tabIndex:-1,disableRipple:!0})}),n(ee,{children:S.name})]},S.filterKey))})})})}))}))]})};export{ke as S,_e as a,je as b,ye as c,Re as d,Ce as e,Ae as f,Me as s};
