var K=Object.defineProperty,X=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var H=(l,a,u)=>a in l?K(l,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):l[a]=u,v=(l,a)=>{for(var u in a||(a={}))ee.call(a,u)&&H(l,u,a[u]);if(z)for(var u of z(a))te.call(a,u)&&H(l,u,a[u]);return l},b=(l,a)=>X(l,Z(a));import{u as ae,a as re,r as m,j as e,b as F,c as f,T as o,ak as I,F as M,aa as ue,ab as L,ar as T,ad as E,ae as B,af as R,w as C,D as g,as as P,h as ie,S as O,t as le}from"./vendor.da49bbc3.js";import{c as U,i as V,r as G,N as ne,C as se}from"./NavigationBar.0d38d227.js";import{c as ce,R as A,e as D,f as _,k as j,l as $,m as N,y as he,o as de,L as oe}from"./index.8914962e.js";import{d as q,i as J,b as pe,g as Fe}from"./userSettingsUtils.a26776e7.js";import{u as me,T as ye}from"./useTable.e2a4cba6.js";import{E as Se}from"./ExpandStack.d6e49f55.js";import"./WishState.3db35fd5.js";import"./sorting.c6946657.js";import"./ExpandMore.0181df59.js";function Ce(){return ce.filter(l=>!!l.researchManufacturer||!!l.researchStrategyTypes||!!l.researchTacticTypes)}function fe(l,a){const u=[],h=[],r=[];return l.forEach(s=>{if(q(s.id,a)){h.push(s);return}if(J(s.id,a)){u.push(s);return}r.push(s)}),{wantedShips:u.sort((s,p)=>s.name.localeCompare(p.name)),possessedShips:h.sort((s,p)=>s.name.localeCompare(p.name)),remainingShips:r.sort((s,p)=>s.name.localeCompare(p.name))}}function ve(){const l=[A.NOMA_SHIPPING_GROUP,A.JUPITER_INDUSTRIES,A.ANTONIOS_CONSORTIUM,A.DAWN_ACCORD,null],a=[D.OUTSTANDING_FIREPOWER,D.SUSTAINED_COMBAT,D.STRATEGY_AND_SUPPORT,D.FIGHTER_AND_CORVETTE,null],u=[_.PROJECTILE_WEAPONS,_.DIRECT_FIRE_WEAPONS,null];return l.flatMap(h=>a.flatMap(r=>u.map(s=>({shipId:null,manufacturerFilter:h,strategyTypeFilter:r,tacticTypeFilter:s}))))}let be=0;function Te(l,a,u){const h=a.filter(c=>!(l.manufacturerFilter!==null&&c.researchManufacturer!==l.manufacturerFilter||l.strategyTypeFilter!==null&&c.researchStrategyTypes&&!c.researchStrategyTypes.includes(l.strategyTypeFilter)||l.tacticTypeFilter!==null&&c.researchTacticTypes&&!c.researchTacticTypes.includes(l.tacticTypeFilter))),r=h.reduce((c,S)=>c+S.weight,0),s=h.map(c=>{const S=q(c.id,u);return{shipDefinition:c,chance:c.weight/r,formula:`${c.weight} / ${r}`,possessed:S,wished:J(c.id,u),unwished:pe(c.id,u)}});let p=0,d=0,t=0,i=0,y=0;return s.forEach(c=>{if(!c.possessed){p+=c.chance,c.wished&&(t+=c.chance),c.unwished&&(i+=c.chance);return}if(c.shipDefinition.modules&&c.shipDefinition.modules.length>0){d+=c.chance;return}y+=c.chance}),{id:`${be++}`,filterState:l,shipChances:s,totalShipChance:p,totalModuleChance:d,wishedShipChance:t,unwishedShipChance:i,techPointChance:y}}function ge(l){var a,u,h;return`${(a=l.manufacturerFilter)!=null?a:"null"}.${(u=l.strategyTypeFilter)!=null?u:"null"}.${(h=l.tacticTypeFilter)!=null?h:"null"}`}function Ae(l,a){if(a.shipId!==null)return l.filter(r=>!r.filterState.manufacturerFilter&&!r.filterState.strategyTypeFilter&&!r.filterState.tacticTypeFilter?!1:r.shipChances.find(s=>s.shipDefinition.id===a.shipId)).sort((r,s)=>{var t,i,y,c;const p=(i=(t=r.shipChances.find(S=>S.shipDefinition.id===a.shipId))==null?void 0:t.chance)!=null?i:0;return((c=(y=s.shipChances.find(S=>S.shipDefinition.id===a.shipId))==null?void 0:y.chance)!=null?c:0)-p});const u=[],h=l.filter(r=>a.manufacturerFilter!==null&&r.filterState.manufacturerFilter!==a.manufacturerFilter||a.strategyTypeFilter!==null&&r.filterState.strategyTypeFilter!==a.strategyTypeFilter||a.tacticTypeFilter!==null&&r.filterState.tacticTypeFilter!==a.tacticTypeFilter||!r.filterState.manufacturerFilter&&!r.filterState.strategyTypeFilter&&!r.filterState.tacticTypeFilter?!1:r.filterState.manufacturerFilter===a.manufacturerFilter&&r.filterState.strategyTypeFilter===a.strategyTypeFilter&&r.filterState.tacticTypeFilter===a.tacticTypeFilter?(u.push(r),!1):r);return[...u,...h]}const De=l=>{const{configurations:a}=l,{table:u,setTableData:h}=me(),r=ae(),p=re(r.breakpoints.down("sm"))?"38px":"50px";return m.exports.useEffect(()=>{h({columns:[{id:"filter",renderHeader:()=>"\u30D5\u30A3\u30EB\u30BF\u30FC",renderCell:t=>F(f,{sx:{minWidth:"120px"},children:[t.filterState.manufacturerFilter&&e(o,{variant:"body2",children:j(t.filterState.manufacturerFilter)}),t.filterState.strategyTypeFilter&&e(o,{variant:"body2",children:$(t.filterState.strategyTypeFilter)}),t.filterState.tacticTypeFilter&&e(o,{variant:"body2",children:N(t.filterState.tacticTypeFilter)}),!t.filterState.manufacturerFilter&&!t.filterState.strategyTypeFilter&&!t.filterState.tacticTypeFilter&&e(o,{variant:"body2",children:"\u7121\u3057"})]})},{id:"totalShipChance",renderHeader:()=>"\u8A2D\u8A08\u56F3",renderCell:t=>e(f,{sx:{minWidth:p},children:e(o,{variant:"body2",children:w(t.totalShipChance)})}),sortFn:[(t,i)=>t.totalShipChance-i.totalShipChance,(t,i)=>i.techPointChance-t.techPointChance,(t,i)=>t.wishedShipChance-i.wishedShipChance,(t,i)=>i.unwishedShipChance-t.unwishedShipChance]},{id:"totalModuleChance",renderHeader:()=>"\u30E2\u30B8\u30E5\u30FC\u30EB",renderCell:t=>e(f,{sx:{minWidth:p},children:e(o,{variant:"body2",children:w(t.totalModuleChance)})}),sortFn:[(t,i)=>t.totalModuleChance-i.totalModuleChance,(t,i)=>t.totalShipChance-i.totalShipChance,(t,i)=>i.techPointChance-t.techPointChance,(t,i)=>t.wishedShipChance-i.wishedShipChance,(t,i)=>i.unwishedShipChance-t.unwishedShipChance]},{id:"techPointChance",renderHeader:()=>"\u6280\u8853Pt",renderCell:t=>e(f,{sx:{minWidth:p},children:e(o,{variant:"body2",children:w(t.techPointChance)})}),sortFn:[(t,i)=>t.techPointChance-i.techPointChance,(t,i)=>i.totalShipChance-t.totalShipChance,(t,i)=>i.wishedShipChance-t.wishedShipChance,(t,i)=>t.unwishedShipChance-i.unwishedShipChance]},{id:"wishedShipChance",renderHeader:()=>"\u6B32\u3057\u3044\u8266\u8239",renderCell:t=>e(f,{sx:{minWidth:p},children:e(o,{variant:"body2",children:w(t.wishedShipChance)})}),sortFn:[(t,i)=>t.wishedShipChance-i.wishedShipChance,(t,i)=>i.techPointChance-t.techPointChance,(t,i)=>t.totalShipChance-i.totalShipChance,(t,i)=>i.unwishedShipChance-t.unwishedShipChance]},{id:"unwishedShipChance",renderHeader:()=>"\u6B32\u3057\u304F\u306A\u3044\u8266\u8239",renderCell:t=>e(f,{sx:{minWidth:p},children:e(o,{variant:"body2",children:w(t.unwishedShipChance)})}),sortFn:[(t,i)=>t.unwishedShipChance-i.unwishedShipChance,(t,i)=>i.totalShipChance-t.totalShipChance,(t,i)=>i.wishedShipChance-t.wishedShipChance,(t,i)=>t.techPointChance-i.techPointChance]}],data:a,rowIdFn:t=>ge(t.filterState)})},[h,a,p]),e(ye,{table:u,size:"small"})};function w(l){return`${Number((l*100).toFixed(2))} %`}const we=l=>{const{shipDefinition:a}=l,{openShipDetailDialog:u}=he();return e(o,{variant:"body2",component:"span",children:e(de,{onClick:()=>{u(a.id)},children:a.name})})},xe=l=>{const{configurations:a,filterState:u}=l,h=!!u.manufacturerFilter||!!u.strategyTypeFilter||!!u.tacticTypeFilter;return e(Se,{expandables:a.map(r=>{var s,p;return{id:r.id,initiallyOpened:h,summary:F(o,{variant:"body2",children:[[...r.filterState.manufacturerFilter!==null?[j(r.filterState.manufacturerFilter)]:[],...r.filterState.strategyTypeFilter!==null?[$(r.filterState.strategyTypeFilter)]:[],...r.filterState.tacticTypeFilter!==null?[N(r.filterState.tacticTypeFilter)]:[],...!r.filterState.manufacturerFilter&&!r.filterState.strategyTypeFilter&&!r.filterState.tacticTypeFilter?["\u7121\u3057"]:[]].map(d=>`\u300C${d}\u300D`).join("+"),u.shipId===null&&r.wishedShipChance>0&&e(I,{arrow:!0,disableFocusListener:!0,title:`\u6B32\u3057\u3044\u8266\u8239\u304C\u5F53\u305F\u308B\u78BA\u7387\uFF1A${x(r.wishedShipChance)}`,children:e(o,{variant:"body2",component:"span",sx:{color:"#ffc107",marginLeft:"4px"},children:"\u2605"})}),u.shipId!==null&&e(o,{variant:"body2",component:"span",children:`\u3000\u21D2\u3000${x((p=(s=r.shipChances.find(d=>d.shipDefinition.id===u.shipId))==null?void 0:s.chance)!=null?p:0)}`})]}),details:e(oe,{rows:[{key:`${r.id}.wishedShipChance`,label:"\u6B32\u3057\u3044\u8A2D\u8A08\u56F3",value:x(r.wishedShipChance),separatorAfter:!0},...r.techPointChance>0?[{key:`${r.id}.techPointChance`,label:e(o,{variant:"body2",sx:r.techPointChance>0?{color:"red"}:void 0,children:"\u6280\u8853Pt \xD7\uFF15"}),value:e(o,{variant:"body2",sx:r.techPointChance>0?{color:"red"}:void 0,children:x(r.techPointChance)}),separatorAfter:!0}]:[],...r.shipChances.map(d=>{const t=d.possessed&&d.shipDefinition.modules&&d.shipDefinition.modules.length>0;return{key:`${r.id}.${d.shipDefinition.id}`,label:F(M,{children:[e(we,{shipDefinition:d.shipDefinition}),t&&e(o,{variant:"body2",component:"span",children:"\uFF08\u8FFD\u52A0\u30E2\u30B8\u30E5\u30FC\u30EB\uFF09"}),!t&&d.possessed&&e(o,{variant:"body2",component:"span",children:"\uFF08\u6280\u8853Pt\uFF09"}),d.wished&&e(I,{arrow:!0,disableFocusListener:!0,title:"\u6B32\u3057\u3044\u8266\u8239",children:e(o,{variant:"body2",component:"span",sx:{color:"#ffc107",marginLeft:"4px"},children:"\u2605"})})]}),value:e(I,{arrow:!0,disableFocusListener:!0,title:F(M,{children:[e(o,{variant:"body2",gutterBottom:!0,children:"\u78BA\u7387\u306E\u91CD\u307F / \u5408\u8A08"}),e(o,{variant:"body2",children:d.formula})]}),children:e(o,{variant:"body2",sx:{color:!t&&d.possessed?"red":void 0},children:x(d.chance)})})}})],rowGap:1})}}),unmount:!0})};function x(l){return`${Number((l*100).toFixed(3))} %`}var W={},Ee=V.exports;Object.defineProperty(W,"__esModule",{value:!0});var Q=W.default=void 0,Be=Ee(U),Re=G,Ie=(0,Be.default)((0,Re.jsx)("path",{d:"M22 11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3z"}),"AccountTree");Q=W.default=Ie;var k={},Me=V.exports;Object.defineProperty(k,"__esModule",{value:!0});var Y=k.default=void 0,Pe=Me(U),Oe=G,_e=(0,Pe.default)((0,Oe.jsx)("path",{d:"M21 8H3V4h18v4zm0 2H3v4h18v-4zm0 6H3v4h18v-4z"}),"TableRows");Y=k.default=_e;const je=l=>{const{mode:a,onChange:u}=l;return F(ue,{value:a,exclusive:!0,onChange:(r,s)=>{u(s)},size:"small","aria-label":"view mode",children:[e(L,{value:"ships","aria-label":"ships",children:e(Q,{})}),e(L,{value:"table","aria-label":"table",children:e(Y,{})})]})},$e=l=>{var i,y,c,S;const{filterState:a,shipFilterOptions:u,onChange:h}=l,r=n=>{h(b(v({},a),{shipId:n.target.value===""?null:n.target.value,manufacturerFilter:null,strategyTypeFilter:null,tacticTypeFilter:null}))},s=n=>{h(b(v({},a),{shipId:null,manufacturerFilter:n.target.value===""?null:n.target.value}))},p=n=>{h(b(v({},a),{shipId:null,strategyTypeFilter:n.target.value===""?null:n.target.value}))},d=n=>{h(b(v({},a),{shipId:null,tacticTypeFilter:n.target.value===""?null:n.target.value}))},t=()=>{h(b(v({},a),{shipId:null,manufacturerFilter:null,strategyTypeFilter:null,tacticTypeFilter:null}))};return F(T,{container:!0,spacing:2,children:[e(T,{item:!0,xs:12,sm:8,md:4,children:F(E,{fullWidth:!0,size:"small",children:[e(B,{id:"manufacturer-select-label",children:"\u59D4\u8A17\u4F01\u696D"}),F(R,{labelId:"manufacturer-select-label",value:(i=a.manufacturerFilter)!=null?i:"",label:"\u59D4\u8A17\u4F01\u696D",onChange:s,children:[e(C,{value:"",children:"\u7121\u3057"}),e(g,{}),Object.values(A).map(n=>e(C,{value:n,children:j(n)},n))]})]})}),e(T,{item:!0,xs:12,sm:8,md:4,children:F(E,{fullWidth:!0,size:"small",children:[e(B,{id:"strategy-select-label",children:"\u6226\u7565\u80FD\u529B"}),F(R,{labelId:"strategy-select-label",value:(y=a.strategyTypeFilter)!=null?y:"",label:"\u6226\u7565\u80FD\u529B",onChange:p,children:[e(C,{value:"",children:"\u7121\u3057"}),e(g,{}),Object.values(D).map(n=>e(C,{value:n,children:$(n)},n))]})]})}),e(T,{item:!0,xs:12,sm:8,md:4,children:F(E,{fullWidth:!0,size:"small",children:[e(B,{id:"tactics-select-label",children:"\u6226\u8853\u6027\u80FD"}),F(R,{labelId:"tactics-select-label",value:(c=a.tacticTypeFilter)!=null?c:"",label:"\u6226\u8853\u6027\u80FD",onChange:d,children:[e(C,{value:"",children:"\u7121\u3057"}),e(g,{}),Object.values(_).map(n=>e(C,{value:n,children:N(n)},n))]})]})}),e(T,{item:!0,xs:12,sm:8,children:F(E,{fullWidth:!0,size:"small",children:[e(B,{id:"ship-select-label",children:"\u8266\u8239"}),F(R,{labelId:"ship-select-label",value:(S=a.shipId)!=null?S:"",label:"\u8266\u8239",onChange:r,children:[e(C,{value:"",children:"\u7121\u3057"}),u.wantedShips.length>0&&e(g,{}),u.wantedShips.length>0&&e(P,{disableSticky:!0,children:"\u6B32\u3057\u3044\u8266\u8239\uFF1A"}),u.wantedShips.map(n=>F(C,{value:n.id,children:[n.name,e(o,{variant:"body1",component:"span",sx:{color:"#ffc107",marginLeft:"4px"},children:"\u2605"})]},n.id)),u.remainingShips.length>0&&e(g,{}),u.remainingShips.length>0&&e(P,{disableSticky:!0,children:"\u53D6\u5F97\u53EF\u80FD\u306A\u8266\u8239\uFF1A"}),u.remainingShips.map(n=>e(C,{value:n.id,children:n.name},n.id)),u.possessedShips.length>0&&e(g,{}),u.possessedShips.length>0&&e(P,{disableSticky:!0,children:"\u53D6\u5F97\u6E08\u307F\u306E\u8266\u8239\uFF1A"}),u.possessedShips.map(n=>e(C,{value:n.id,children:n.name},n.id))]})]})}),e(T,{item:!0,xs:12,sm:4,sx:{display:"flex",justifyContent:"end"},children:e(ie,{variant:"outlined",onClick:t,children:"\u30EA\u30BB\u30C3\u30C8"})})]})},Ne=m.exports.memo(De),We=m.exports.memo(xe),Ye=()=>{const[l,a]=m.exports.useState("ships"),u=m.exports.useMemo(()=>Ce(),[]),h=m.exports.useMemo(()=>Fe(),[]),r=m.exports.useMemo(()=>ve(),[]),s=m.exports.useMemo(()=>r.map(y=>Te(y,u,h)),[r,u]),p=m.exports.useMemo(()=>fe(u,h),[u,h]),[d,t]=m.exports.useState({shipId:null,manufacturerFilter:null,strategyTypeFilter:null,tacticTypeFilter:null}),i=m.exports.useMemo(()=>Ae(s,d),[s,d]);return F(M,{children:[e(ne,{currentRoute:"/researchAgreement"}),e(se,{children:e(f,{p:1,children:F(O,{spacing:1,children:[F(O,{pt:1,pb:1,spacing:2,children:[e(o,{variant:"body2",children:"\u3053\u3053\u3067\u306F\u300C\u7814\u7A76\u5354\u5B9A\u300D\u306B\u95A2\u3059\u308B\u5404\u7A2E\u78BA\u7387\u3092\u8868\u793A\u3057\u3066\u3044\u307E\u3059\u3002"}),e(o,{variant:"body2",children:"\u7814\u7A76\u65B9\u91DD\uFF08\u59D4\u8A17\u4F01\u696D\u3001\u6226\u7565\u80FD\u529B\u3001\u6226\u8853\u80FD\u529B\uFF09\u3092\u9078\u629E\u3057\u305F\u5834\u5408\u306F\u305D\u306E\u7D44\u307F\u5408\u308F\u305B\u3067\u624B\u306B\u5165\u308B\u8A2D\u8A08\u56F3\u3084\u8FFD\u52A0\u30E2\u30B8\u30E5\u30FC\u30EB\u306E\u78BA\u7387\u304C\u8868\u793A\u3055\u308C\u307E\u3059\u3002\u8266\u8239\u3092\u9078\u629E\u3057\u305F\u5834\u5408\u306F\u305D\u306E\u8266\u8239\u3092\u542B\u3080\u7814\u7A76\u65B9\u91DD\u304C\u78BA\u7387\u9806\u306B\u8868\u793A\u3055\u308C\u307E\u3059\u3002"}),e(o,{variant:"body2",children:"\u53D6\u5F97\u6E08\u307F\u306E\u8A2D\u8A08\u56F3\u306F\u30DE\u30A4\u30EA\u30B9\u30C8\u3067\u8A2D\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002"})]}),e(le,{children:e(f,{p:2,children:F(O,{spacing:2,children:[e(o,{variant:"body2",children:"\u7814\u7A76\u65B9\u91DD"}),e("div",{children:e($e,{filterState:d,onChange:t,shipFilterOptions:p})}),e(f,{sx:{display:"flex",justifyContent:"end"},children:e(je,{mode:l,onChange:a})})]})})}),l==="ships"&&e(We,{configurations:i,filterState:d}),l==="table"&&e(Ne,{configurations:i})]})})})]})};export{Ye as ResearchAgreementPage,Ye as default};
