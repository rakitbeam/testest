import{t as o,a as B,S as C,b as E,c as F,s as R,g as w,d as j,e as N,f as L,r as p,h as O,i as q,j as h,F as f,k as e,p as W,l as P,m as A,n as _,o as V,B as D,u as v,q as k,T as u,v as z,w as M,x as G,y as H,z as K}from"./index.ab4b431d.js";import{d as J}from"./Settings.4d01f954.js";import{e as $,S as Q,c as X,a as Y,b as Z,d as ee,f as te}from"./ShipTypeFilterButton.85cc3b51.js";import{A as se}from"./ActionBar.b7485479.js";import{C as ae,S as ne,c as ie}from"./ShipDataTable.539175f3.js";import{d as oe,a as I,b as re,I as le,E as ce}from"./ExportDataDialog.5935d5c3.js";import{d as pe}from"./ConfirmationDialog.81593bcd.js";import{B as ue}from"./ButtonMenu.4f2193b3.js";import{n as de}from"./sorting.c6946657.js";import{E as he}from"./ExpandStack.7cafc35e.js";import{R as me}from"./ResponsiveDialog.614f3c8f.js";import{T as ge}from"./TextField.bd47117a.js";import{N as ye,P as fe}from"./PageContent.49b7d4c4.js";import{P as Se}from"./PageFooter.e9d5be0a.js";import"./domUtils.e8e26673.js";import"./useFormControl.5bf868fe.js";import"./useTable.53285754.js";import"./TableRow.a03e076b.js";import"./Download.56fbb24a.js";import"./DialogContentText.ab931aa6.js";import"./Select.aefcfb2a.js";function U(n,t){const s=[],r=[],i=[],d=[],c=[];n.forEach(a=>{switch(a.row){case C.FRONT:{s.push(a);break}case C.MIDDLE:{r.push(a);break}case C.BACK:{i.push(a);break}default:switch(a.type){case F.CORVETTE:{d.push(a);break}case F.FIGHTER:{c.push(a);break}}}});const l=de([(a,m)=>R(a.type,a.subType)-R(m.type,m.subType),(a,m)=>w(a).localeCompare(w(m),j())]);return[o("label.acquiredShipsAndBlueprints"),[o("myList.groupNameForSharing",{name:B(C.FRONT)}),...s.sort(l).map(a=>b(a,t))].join(`
`),[o("myList.groupNameForSharing",{name:B(C.MIDDLE)}),...r.sort(l).map(a=>b(a,t))].join(`
`),[o("myList.groupNameForSharing",{name:B(C.BACK)}),...i.sort(l).map(a=>b(a,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(F.CORVETTE)}),...d.sort(l).map(a=>b(a,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(F.FIGHTER)}),...c.sort(l).map(a=>b(a,t))].join(`
`)].join(`

`)}function b(n,t){const s=N(n,t);return s.length===0?`\u3000${w(n)}`:[`\u3000${w(n)}`,s.map(r=>`\u3000\u2517 ${r.category}${r.categoryNumber} ${L(n.id,r)}`).join(`
`)].join(`
`)}const Ce=n=>{const{onCopyAsText:t,buttonProps:s}=n,[r,i]=p.exports.useState(!1),[d,c]=p.exports.useState(null),[l,a]=p.exports.useState(null),m=p.exports.useCallback(g=>{switch(g){case"copyAsText":{t();break}case"import":{a(q()),i(!0);break}case"export":{c(O());break}}},[]),S=p.exports.useCallback((g,x)=>{if(l===null){x();return}g(l)},[l]);return h(f,{children:[e(ue,{icon:e(oe,{}),text:o("button.share"),value:void 0,buttonProps:s,onClick:m,options:[{key:"copyAsText",icon:e(I,{}),text:o("label.copyAsText"),value:"copyAsText"},{key:"export",icon:e(pe,{}),text:o("label.dataExport"),value:"export"},{key:"import",icon:e(re,{}),text:o("label.dataImport"),value:"import"}]}),r&&e(le,{confirmDialogTitle:o("myList.importConfirmTitle"),confirmWarning:o("myList.importConfirmWarning"),createPreview:be,parseInput:W,canRestore:!!l,onImport:xe,onClose:()=>i(!1),onSelectFile:Fe,onRestoreFromBackup:S}),d&&e(ce,{fileName:"settings",jsonContent:d,onClose:()=>c(null),onStoreBackup:P})]})};function be(n){const t=$(A,n.ships);return U(t,n)}function xe(n){_(n),setTimeout(()=>{window.location.reload()},0)}function Fe(n,t){(async()=>{const s=await V();if(s===null){t();return}n(s)})()}const Te=n=>{const{shipFilter:t,columnConfig:s,onEdit:r,onFilter:i,onCopyAsText:d,onColumnConfigChange:c}=n;return e(se,{left:l=>h(f,{children:[e(ae,{columnConfig:s,onChange:c,disableResearchAgreementOptions:!0,buttonProps:l},"columnConfig"),e(Q,{filter:t,onChange:i,researchManufacturer:!1,researchStrategyTypes:!1,researchTacticTypes:!1,buttonProps:l},"filter"),e(D,{variant:"outlined",startIcon:e(J,{}),onClick:r,...l,children:o("myList.editMyList")},"edit")]}),right:l=>e(f,{children:e(Ce,{onCopyAsText:d,buttonProps:l})})})},we=n=>{const{ship:t}=n,{userSettings:s}=v(),r=p.exports.useMemo(()=>N(t,s),[t,s]);return r.length===0?null:e(k,{mt:.5,children:r.map(i=>h(u,{variant:"body2",color:"text.secondary",children:[e(u,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${i.category}${i.categoryNumber} ${L(t.id,i)}`]},i.id))})},ve=n=>{const{ship:t}=n,{userSettings:s}=v(),r=p.exports.useMemo(()=>z(t,s),[t,s]);return r.length===0?null:e(k,{mt:.5,children:r.map(i=>h(u,{variant:"body2",color:"text.secondary",children:[e(u,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${i.category}${i.categoryNumber} ${L(t.id,i)}`]},i.id))})},T=p.exports.memo(ne),ke=n=>{const{shipListState:t,columnConfig:s}=n;return h(M,{spacing:1,children:[e(he,{expandables:[{id:"possessed-ships",initiallyOpened:!0,summary:e(u,{variant:"body1",children:o("label.acquiredShipsAndBlueprints")}),details:e(T,{shipDefinitions:t.possessed,columnConfig:s,decorateName:(r,i)=>h(f,{children:[r,e(we,{ship:i})]})})},{id:"wished-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("label.wantedBlueprints")}),details:e(T,{shipDefinitions:t.wished,columnConfig:s,decorateName:(r,i)=>h(f,{children:[r,e(ve,{ship:i})]})})},{id:"unwished-by-user-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("label.unwantedBlueprints")}),details:e(T,{shipDefinitions:t.unwishedByUser,columnConfig:s})},{id:"unwished-by-data-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("myList.unwantedDuplicates")}),details:h(f,{children:[e(T,{shipDefinitions:t.unwishedByData,columnConfig:s}),e(k,{pt:1,children:e(u,{variant:"caption",align:"right",paragraph:!0,children:o("myList.unwantedDuplicatesFootnote")})})]})}]}),e(u,{variant:"caption",align:"right",paragraph:!0,children:o("myList.pageFootnote")})]})},Be=n=>{const{ships:t,onClose:s}=n,[r,i]=p.exports.useState(!1),{userSettings:d}=v(),[c,l]=p.exports.useState(()=>U(t.possessed,d)),a=()=>{c&&H(c).then(()=>{i(!0)})},m=g=>{l(g.target.value)},S=()=>{s(),i(!1)};return e(me,{title:o("button.share"),content:h(M,{spacing:1,children:[e(ge,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:m,rows:10,defaultValue:c,fullWidth:!0}),!!navigator.clipboard&&e(D,{variant:"outlined",startIcon:r?e(G,{}):e(I,{}),onClick:a,fullWidth:!0,children:o("button.copyToClipboard")})]}),actions:e(D,{variant:"outlined",onClick:S,children:o("button.close")}),onClose:S})},Je=()=>{const n=K(),{userSettings:t}=v(),[s,r]=p.exports.useState(X),[i,d]=p.exports.useState(null),[c,l]=p.exports.useState(()=>ie({name:!0,row:!0,type:!0,cost:!1,operationLimit:!1})),a=p.exports.useMemo(()=>{const y=Y(A,s);return{possessed:$(y,t.ships),wished:Z(y,t),unwishedByUser:ee(y,t.ships),unwishedByData:te(y,t)}},[t,s]),m=()=>{n("/myList/edit")},S=()=>{d(a)},g=()=>{d(null)},x=Object.values(c).filter(y=>typeof y=="boolean"&&y).length>3;return h(f,{children:[e(ye,{currentRoute:"/myList"}),e(Te,{shipFilter:s,columnConfig:c,onEdit:m,onFilter:r,onCopyAsText:S,onColumnConfigChange:l}),e(fe,{disableContainer:x,children:h(k,{p:1,children:[h(M,{pt:1,pb:2,spacing:2,children:[e(u,{variant:"body2",children:o("myList.pageDescription1")}),e(u,{variant:"body2",children:o("myList.pageDescription2")}),e(u,{variant:"body2",children:o("myList.pageDescription3")})]}),e(ke,{shipListState:a,columnConfig:c})]})}),i&&e(Be,{ships:i,onClose:g}),e(Se,{disableContainer:x})]})};export{Je as MyListPage,Je as default};
