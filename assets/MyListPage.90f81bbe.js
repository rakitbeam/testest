import{t as o,a as D,S as f,b as E,c as b,s as N,g as T,d as O,e as A,f as k,r as u,h as U,j as h,F as y,i as e,p as q,k as R,l as W,o as P,B as L,u as F,m as w,T as p,n as _,q as B,v as V,w as z,x as G}from"./index.d9fc8da9.js";import{d as H}from"./Settings.67918819.js";import{e as $,S as K,c as J,a as Q,b as X,d as Y,f as Z}from"./ShipTypeFilterButton.bd424b65.js";import{A as ee}from"./ActionBar.456f9054.js";import{C as te,S as ae,c as ie}from"./ShipDataTable.9432039c.js";import{d as ne,a as I,b as se,I as oe,E as re}from"./ExportDataDialog.c46f6cbd.js";import{d as le}from"./ConfirmationDialog.98c73ecf.js";import{B as ce}from"./ButtonMenu.0cff48f0.js";import{n as pe}from"./sorting.c6946657.js";import{E as de}from"./ExpandStack.a6c043d6.js";import{R as ue}from"./ResponsiveDialog.7fc6779b.js";import{T as he}from"./TextField.7f834e66.js";import{N as me,P as ge}from"./PageContent.6cd6ae0e.js";import{P as ye}from"./PageFooter.73b8b741.js";import"./domUtils.0ff0b637.js";import"./useFormControl.d91cf48e.js";import"./useTable.4755fac8.js";import"./TableRow.c4f1668b.js";import"./DialogContentText.4250e31a.js";import"./Select.9c9485c2.js";function j(n,t){const a=[],r=[],s=[],d=[],c=[];n.forEach(i=>{switch(i.row){case f.FRONT:{a.push(i);break}case f.MIDDLE:{r.push(i);break}case f.BACK:{s.push(i);break}default:switch(i.type){case b.CORVETTE:{d.push(i);break}case b.FIGHTER:{c.push(i);break}}}});const l=pe([(i,m)=>N(i.type,i.subType)-N(m.type,m.subType),(i,m)=>T(i).localeCompare(T(m),O())]);return[o("label.acquiredShipsAndBlueprints"),[o("myList.groupNameForSharing",{name:D(f.FRONT)}),...a.sort(l).map(i=>S(i,t))].join(`
`),[o("myList.groupNameForSharing",{name:D(f.MIDDLE)}),...r.sort(l).map(i=>S(i,t))].join(`
`),[o("myList.groupNameForSharing",{name:D(f.BACK)}),...s.sort(l).map(i=>S(i,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(b.CORVETTE)}),...d.sort(l).map(i=>S(i,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(b.FIGHTER)}),...c.sort(l).map(i=>S(i,t))].join(`
`)].join(`

`)}function S(n,t){const a=A(n,t);return a.length===0?`\u3000${T(n)}`:[`\u3000${T(n)}`,a.map(r=>`\u3000\u2517 ${r.category}${r.categoryNumber} ${k(n.id,r)}`).join(`
`)].join(`
`)}const fe=n=>{const{onCopyAsText:t,buttonProps:a}=n,[r,s]=u.exports.useState(!1),[d,c]=u.exports.useState(null),l=u.exports.useCallback(i=>{switch(i){case"copyAsText":{t();break}case"import":{s(!0);break}case"export":{c(U());break}}},[]);return h(y,{children:[e(ce,{icon:e(ne,{}),text:o("button.share"),value:void 0,buttonProps:a,onClick:l,options:[{key:"copyAsText",icon:e(I,{}),text:o("label.copyAsText"),value:"copyAsText"},{key:"export",icon:e(le,{}),text:o("label.dataExport"),value:"export"},{key:"import",icon:e(se,{}),text:o("label.dataImport"),value:"import"}]}),r&&e(oe,{confirmDialogTitle:o("myList.importConfirmTitle"),confirmWarning:o("myList.importConfirmWarning"),createPreview:Se,parseInput:q,onImport:Ce,onClose:()=>s(!1),onSelectFile:be}),d&&e(re,{fileName:"settings",jsonContent:d,onClose:()=>c(null)})]})};function Se(n){const t=$(R,n.ships);return j(t,n)}function Ce(n){W(n),setTimeout(()=>{window.location.reload()},0)}function be(n,t){(async()=>{const a=await P();if(a===null){t();return}n(a)})()}const xe=n=>{const{shipFilter:t,columnConfig:a,onEdit:r,onFilter:s,onCopyAsText:d,onColumnConfigChange:c}=n;return e(ee,{left:l=>h(y,{children:[e(te,{columnConfig:a,onChange:c,disableResearchAgreementOptions:!0,buttonProps:l},"columnConfig"),e(K,{filter:t,onChange:s,researchManufacturer:!1,researchStrategyTypes:!1,researchTacticTypes:!1,buttonProps:l},"filter"),e(L,{variant:"outlined",startIcon:e(H,{}),onClick:r,...l,children:o("myList.editMyList")},"edit")]}),right:l=>e(y,{children:e(fe,{onCopyAsText:d,buttonProps:l})})})},Te=n=>{const{ship:t}=n,{userSettings:a}=F(),r=u.exports.useMemo(()=>A(t,a),[t,a]);return r.length===0?null:e(w,{mt:.5,children:r.map(s=>h(p,{variant:"body2",color:"text.secondary",children:[e(p,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${s.category}${s.categoryNumber} ${k(t.id,s)}`]},s.id))})},Fe=n=>{const{ship:t}=n,{userSettings:a}=F(),r=u.exports.useMemo(()=>_(t,a),[t,a]);return r.length===0?null:e(w,{mt:.5,children:r.map(s=>h(p,{variant:"body2",color:"text.secondary",children:[e(p,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${s.category}${s.categoryNumber} ${k(t.id,s)}`]},s.id))})},x=u.exports.memo(ae),we=n=>{const{shipListState:t,columnConfig:a}=n;return h(B,{spacing:1,children:[e(de,{expandables:[{id:"possessed-ships",initiallyOpened:!0,summary:e(p,{variant:"body1",children:o("label.acquiredShipsAndBlueprints")}),details:e(x,{shipDefinitions:t.possessed,columnConfig:a,decorateName:(r,s)=>h(y,{children:[r,e(Te,{ship:s})]})})},{id:"wished-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("label.wantedBlueprints")}),details:e(x,{shipDefinitions:t.wished,columnConfig:a,decorateName:(r,s)=>h(y,{children:[r,e(Fe,{ship:s})]})})},{id:"unwished-by-user-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("label.unwantedBlueprints")}),details:e(x,{shipDefinitions:t.unwishedByUser,columnConfig:a})},{id:"unwished-by-data-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("myList.unwantedDuplicates")}),details:h(y,{children:[e(x,{shipDefinitions:t.unwishedByData,columnConfig:a}),e(w,{pt:1,children:e(p,{variant:"caption",align:"right",paragraph:!0,children:o("myList.unwantedDuplicatesFootnote")})})]})}]}),e(p,{variant:"caption",align:"right",paragraph:!0,children:o("myList.pageFootnote")})]})},ve=n=>{const{ships:t,onClose:a}=n,[r,s]=u.exports.useState(!1),{userSettings:d}=F(),[c,l]=u.exports.useState(()=>j(t.possessed,d)),i=()=>{c&&z(c).then(()=>{s(!0)})},m=v=>{l(v.target.value)},C=()=>{a(),s(!1)};return e(ue,{title:o("button.share"),content:h(B,{spacing:1,children:[e(he,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:m,rows:10,defaultValue:c,fullWidth:!0}),!!navigator.clipboard&&e(L,{variant:"outlined",startIcon:r?e(V,{}):e(I,{}),onClick:i,fullWidth:!0,children:o("button.copyToClipboard")})]}),actions:e(L,{variant:"outlined",onClick:C,children:o("button.close")}),onClose:C})},Ge=()=>{const n=G(),{userSettings:t}=F(),[a,r]=u.exports.useState(J),[s,d]=u.exports.useState(null),[c,l]=u.exports.useState(()=>ie({name:!0,row:!0,type:!0,cost:!1,operationLimit:!1})),i=u.exports.useMemo(()=>{const g=Q(R,a);return{possessed:$(g,t.ships),wished:X(g,t),unwishedByUser:Y(g,t.ships),unwishedByData:Z(g,t)}},[t,a]),m=()=>{n("/myList/edit")},C=()=>{d(i)},v=()=>{d(null)},M=Object.values(c).filter(g=>typeof g=="boolean"&&g).length>3;return h(y,{children:[e(me,{currentRoute:"/myList"}),e(xe,{shipFilter:a,columnConfig:c,onEdit:m,onFilter:r,onCopyAsText:C,onColumnConfigChange:l}),e(ge,{disableContainer:M,children:h(w,{p:1,children:[h(B,{pt:1,pb:2,spacing:2,children:[e(p,{variant:"body2",children:o("myList.pageDescription1")}),e(p,{variant:"body2",children:o("myList.pageDescription2")}),e(p,{variant:"body2",children:o("myList.pageDescription3")})]}),e(we,{shipListState:i,columnConfig:c})]})}),s&&e(ve,{ships:s,onClose:v}),e(ye,{disableContainer:M})]})};export{Ge as MyListPage,Ge as default};
