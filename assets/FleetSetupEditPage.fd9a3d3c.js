var De=Object.defineProperty,Ae=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var J=(r,e,t)=>e in r?De(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,f=(r,e)=>{for(var t in e||(e={}))Ee.call(e,t)&&J(r,t,e[t]);if(Z)for(var t of Z(e))be.call(e,t)&&J(r,t,e[t]);return r},C=(r,e)=>Ae(r,Be(e));import{j as u,t as I,c as R,p as L,b as l,T as F,w as B,F as _,h as k,q as Q,r as d,J as Re,S as g,u as X,a as ee,U as te,as as Te,at as $,ar as ke}from"./vendor.4663e7d5.js";import{c as H,i as P,r as N,N as we,C as Ie}from"./NavigationBar.ff166a92.js";import{L as _e,c as $e,b as S,S as U,o as z}from"./index.bd9adf92.js";import{d as Me,a as Oe,b as Le,C as je}from"./ConfirmationDialog.30128307.js";import{A as We}from"./ActionBar.ab3d85e9.js";import{B as Ge,S as He,g as Pe,c as ue,d as ne,s as Ne,e as Ue,h as ze,i as Ve,a as qe,G as re,b as Ye}from"./shipCounter.b2ce0a07.js";import{d as Ke,g as Ze}from"./userSettingsUtils.337fefff.js";import{R as Je}from"./ResponsiveDialog.fa559a51.js";import{c as Qe,S as Xe}from"./ShipTypeFilterButton.dd6a296b.js";import"./domUtils.e9df6b0f.js";import"./sorting.c6946657.js";import"./WishState.3db35fd5.js";const et=r=>{const{fleetSetup:e,onChange:t,errors:n,columnCount:i}=r,o=a=>{t(C(f({},e),{name:a.target.value.trim()}))},p=a=>{t(C(f({},e),{maxCost:Number(a.target.value)}))},c=a=>{t(C(f({},e),{maxReinforcement:Number(a.target.value)}))},h=a=>{t(C(f({},e),{myListOnly:a.target.value==="myListOnly"}))};return u(I,{children:u(R,{p:1,children:u(_e,{sx:{alignItems:"center"},offsetValue:!1,rowGap:1,columnCount:i,rows:[{key:"name",label:"\u8266\u968A\u540D",value:a=>u(L,{variant:"outlined",size:"small",value:e.name,onChange:o,error:!!n.name,helperText:n.name,fullWidth:a})},{key:"reinforcementCount",label:"\u6700\u5927\u5897\u63F4\u6570",value:a=>l(L,{variant:"outlined",size:"small",select:!0,value:e.maxReinforcement,onChange:c,error:!!n.maxReinforcement,helperText:n.maxReinforcement,fullWidth:a,SelectProps:{renderValue:()=>u(F,{variant:"body1",whiteSpace:"normal",children:e.maxReinforcement})},children:[u(B,{value:"5",children:"\uFF15\u96BB\uFF08\u7D50\u5408\u52B9\u679C\u7121\u3057\uFF09"}),u(B,{value:"6",children:"\uFF16\u96BB\uFF08\u5C0F\u578B\u88DC\u7D66\u57FA\u5730\u306B\u7D50\u5408\uFF09"}),u(B,{value:"9",children:"\uFF19\u96BB\uFF08\u4E2D\u7D99\u88DC\u7D66\u65BD\u8A2D\u306B\u7D50\u5408\uFF09"})]})},{key:"maxCost",label:"\u6700\u5927\u53F8\u4EE4Pt",value:a=>l(L,{variant:"outlined",size:"small",select:!0,value:e.maxCost,onChange:p,error:!!n.maxCost,helperText:n.maxCost,fullWidth:a,SelectProps:{renderValue:()=>u(F,{variant:"body1",whiteSpace:"normal",children:e.maxCost})},children:[u(B,{value:"450",children:"\uFF14\uFF15\uFF10\uFF08\u6226\u5730\u6307\u4EE4\u30BB\u30F3\u30BF\u30FC\u306B\u7D50\u5408\uFF09"}),u(B,{value:"430",children:"\uFF14\uFF13\uFF10\uFF08\u5354\u540C\u4F5C\u6226\u6A5F\u69CB\u306B\u7D50\u5408\uFF09"}),u(B,{value:"415",children:"\uFF14\uFF11\uFF15\uFF08\u9060\u8DDD\u96E2\u6307\u4EE4\u5C40\u306B\u7D50\u5408\uFF09"}),u(B,{value:"400",children:"\uFF14\uFF10\uFF10\uFF08\u7D50\u5408\u52B9\u679C\u7121\u3057\uFF09"}),u(B,{value:"350",children:"\uFF13\uFF15\uFF10\uFF08\u6226\u5730\u6307\u4EE4\u30BB\u30F3\u30BF\u30FC\u306B\u7D50\u5408\uFF09"}),u(B,{value:"330",children:"\uFF13\uFF13\uFF10\uFF08\u5354\u540C\u4F5C\u6226\u6A5F\u69CB\u306B\u7D50\u5408\uFF09"}),u(B,{value:"315",children:"\uFF13\uFF11\uFF15\uFF08\u9060\u8DDD\u96E2\u6307\u4EE4\u5C40\u306B\u7D50\u5408\uFF09"}),u(B,{value:"300",children:"\uFF13\uFF10\uFF10\uFF08\u7D50\u5408\u52B9\u679C\u7121\u3057\uFF09"})]})},{key:"myListOnly",label:"\u8FFD\u52A0\u3067\u304D\u308B\u8266\u8239",value:a=>l(L,{variant:"outlined",size:"small",select:!0,value:e.myListOnly?"myListOnly":"all",onChange:h,error:!!n.myListOnly,helperText:n.myListOnly,fullWidth:a,SelectProps:{renderValue:()=>u(F,{variant:"body1",whiteSpace:"normal",children:e.myListOnly?"\u6240\u6301\u3057\u3066\u3044\u308B\u8266\u8239":"\u5168\u3066\u306E\u8266\u8239"})},children:[u(B,{value:"all",children:"\u5168\u3066\u306E\u8266\u8239"}),u(B,{value:"myListOnly",children:"\u6240\u6301\u3057\u3066\u3044\u308B\u8266\u8239"})]})}]})})})};var V={},tt=P.exports;Object.defineProperty(V,"__esModule",{value:!0});var q=V.default=void 0,ut=tt(H),nt=N,rt=(0,ut.default)((0,nt.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");q=V.default=rt;const ie=r=>{const{onOpenAddShips:e,filter:t,buttonProps:n}=r;return u(Ge,{icon:u(q,{}),text:"\u8266\u8239\u3092\u8FFD\u52A0",onClick:o=>{switch(o){case"addInitialShip":{e(null,t);break}case"addSelfReinforcement":{e("self",t);break}case"addAllyReinforcement":{e("ally",t);break}}},buttonProps:n,options:[{key:"addInitialShip",text:"\u901A\u5E38\u914D\u5099",value:"addInitialShip"},{key:"addSelfReinforcement",text:"\u5897\u63F4",value:"addSelfReinforcement"},{key:"addAllyReinforcement",text:"\u30E6\u30CB\u30AA\u30F3\u5897\u63F4",value:"addAllyReinforcement"}]})},it=r=>{const{grouping:e,onChangeGrouping:t,onCancel:n,onSave:i,onReset:o,onOpenAddShips:p,saveDisabled:c}=r;return u(We,{left:h=>l(_,{children:[u(He,{value:e,onChange:t,buttonProps:h}),u(ie,{onOpenAddShips:p,buttonProps:h})]}),right:h=>l(_,{children:[u(k,C(f({variant:"outlined",startIcon:u(Me,{}),onClick:o},h),{children:"\u521D\u671F\u5316"}),"reset"),u(k,C(f({variant:"outlined",startIcon:u(Oe,{}),onClick:n},h),{children:"\u30AD\u30E3\u30F3\u30BB\u30EB"}),"cancel"),u(k,C(f({variant:"contained",startIcon:u(Le,{}),onClick:i,disabled:c},h),{children:"\u4FDD\u5B58"}),"save")]})})};function ot(r){var t,n;const e={};return r.name.length===0&&(e.name="\u5FC5\u9808\u9805\u76EE"),(!Number.isFinite(r.maxReinforcement)||r.maxReinforcement<0)&&(e.maxReinforcement="\u7121\u52B9\u306A\u5024"),(!Number.isFinite(r.maxCost)||r.maxCost<300||r.maxCost>450)&&(e.maxCost="\u7121\u52B9\u306A\u5024"),r.maxCost>400&&r.maxReinforcement>5&&(e.maxReinforcement=(t=e.maxReinforcement)!=null?t:"\u57FA\u5730\u7D50\u5408\u52B9\u679C\u306F\uFF11\u3064\u307E\u3067\u3067\u3059",e.maxCost=(n=e.maxCost)!=null?n:"\u57FA\u5730\u7D50\u5408\u52B9\u679C\u306F\uFF11\u3064\u307E\u3067\u3067\u3059"),e}function oe(r){const e={},t={};return r.ships.filter(n=>n.reinforcement!=="ally").forEach(n=>{const i=n.shipDefinition.id;if(t[i]){const o=t[i];t[i]={count:n.reinforcement===null?n.count:o.count,reinforcementCount:n.reinforcement!==null?n.count:o.reinforcementCount,operationLimit:n.shipDefinition.operationLimit};return}t[i]={count:n.reinforcement===null?n.count:0,reinforcementCount:n.reinforcement!==null?n.count:0,operationLimit:n.shipDefinition.operationLimit}}),Object.keys(t).forEach(n=>{const i=t[n];i.count+i.reinforcementCount>i.operationLimit&&(e[j(n,null)]="\u5897\u63F4\u3068\u5408\u308F\u305B\u3066\u7A3C\u50CD\u4E0A\u9650\u3092\u8D85\u3048\u3066\u3044\u307E\u3059\u3002",e[j(n,"self")]="\u901A\u5E38\u914D\u5099\u3068\u5408\u308F\u305B\u3066\u7A3C\u50CD\u4E0A\u9650\u3092\u8D85\u3048\u3066\u3044\u307E\u3059\u3002")}),e}function j(r,e){return`${r}_${e!=null?e:"initial"}`}const at=r=>{var m;const{initialFleetKey:e,userSettings:t}=r,n=Q(),i=d.exports.useMemo(()=>Pe(t),[t]),[o,p]=d.exports.useState(e&&(m=i.find(x=>x.key===e))!=null?m:i[0]),c=d.exports.useCallback((x,v,y)=>{p(b=>ue({shipId:x,count:v,reinforcement:y,fleetSetup:b,userSettings:t}))},[t]),h=d.exports.useCallback((x,v,y,b)=>{p(A=>ne({shipId:x,carrierShipId:v,count:y,reinforcement:b,fleetSetup:A}))},[]),a=d.exports.useCallback(()=>{Ne(o),n("/fleetSetup")},[o]),s=d.exports.useCallback(()=>{const x=Number(o.key.substring("fleet".length));p(Ue(x))},[o]),E=d.exports.useMemo(()=>ot(o),[o]),D=d.exports.useMemo(()=>oe(o),[o]);return{fleetSetup:o,errors:E,shipWarnings:D,setFleetSetup:p,setShipCount:c,setCarriedShipCount:h,save:a,reset:s}},st=r=>{const{fleetSetup:e,fleetShipCount:t}=r,n=t.totalCost>e.maxCost,i=e.totalReinforcementCount>e.maxReinforcement;return u(R,{sx:{height:"100px"},children:u(I,{square:!0,sx:{position:"fixed",right:0,bottom:0,zIndex:1,width:"100%",borderTop:"1px solid rgba(0, 0, 0, 0.2)"},children:u(Re,{maxWidth:"md",disableGutters:!0,children:u(R,{p:1,children:l(g,{spacing:1,flexWrap:"wrap",direction:"row",children:[u(R,{sx:{flexGrow:1,display:"flex",justifyContent:"center"},children:l("div",{children:[u(F,{variant:"body2",color:"text.secondary",children:"\u5897\u63F4"}),u(F,{variant:"body1",sx:{color:i?"red":void 0},children:u("strong",{children:`${e.totalReinforcementCount} / ${e.maxReinforcement}`})})]})}),u(R,{sx:{flexGrow:1,display:"flex",justifyContent:"center"},children:l("div",{children:[u(F,{variant:"body2",color:"text.secondary",children:"\u53F8\u4EE4pt"}),u(F,{variant:"body1",sx:{color:n?"red":void 0},children:u("strong",{children:`${t.totalCost} / ${e.maxCost}`})})]})})]})})})})})};function lt(r,e,t,n){const i={};e.ships.forEach(p=>{i[`${p.shipDefinition.id}_${p.reinforcement}`]=!0});const o=ct($e,r,e.myListOnly,t);return{fleetSetup:C(f({},e),{ships:[...e.ships,...o.flatMap(p=>i[`${p.id}_${r}`]?[]:[ze({shipDefinition:p,count:0,reinforcement:r,userSettings:t,maxReinforcement:e.maxReinforcement,temporary:!0})])]}),reinforcement:r,filter:n}}function ct(r,e,t,n){const i=r.filter(o=>o.type!==S.CORVETTE&&o.type!==S.FIGHTER);return e==="ally"||!t?i:r.filter(o=>Ke(o.id,n))}function dt(r){return C(f({},r.fleetSetup),{ships:r.fleetSetup.ships.flatMap(e=>e.temporary?e.count===0?[]:[C(f({},e),{temporary:!1})]:[e])})}function pt(r,e){let t=C(f({},e),{fleetSetup:C(f({},e.fleetSetup),{ships:e.fleetSetup.ships.filter(n=>n.temporary===!0)})});return Object.keys(r).filter(n=>r[n]).forEach(n=>{switch(n){case U.FRONT:case U.MIDDLE:case U.BACK:{t=C(f({},t),{fleetSetup:C(f({},t.fleetSetup),{ships:t.fleetSetup.ships.filter(i=>i.shipDefinition.row===n)})});break}case S.CARRIER:case S.BATTLE_CRUISER:case S.CRUISER:case S.DESTROYER:case S.FRIGATE:{t=C(f({},t),{fleetSetup:C(f({},t.fleetSetup),{ships:t.fleetSetup.ships.filter(i=>i.shipDefinition.type===n)})});break}}}),t}const ht=r=>{const{userSettings:e,fleetSetup:t,setFleetSetup:n}=r,[i,o]=d.exports.useState(null),[p,c]=d.exports.useState(null),h=d.exports.useCallback((v,y)=>{o(lt(v,t,e,y!=null?y:null))},[t,e]),a=d.exports.useCallback((v,y)=>{c(v)},[]),s=d.exports.useCallback(()=>{o(null),c(null)},[]),E=d.exports.useCallback(()=>{i&&(n(dt(i)),o(null))},[i,n]),D=d.exports.useCallback((v,y,b)=>{o(A=>A?C(f({},A),{fleetSetup:ue({shipId:v,count:y,reinforcement:b,fleetSetup:A.fleetSetup,userSettings:e,keepZero:!0})}):null)},[e]),m=d.exports.useCallback((v,y,b,A)=>{o(T=>T?C(f({},T),{fleetSetup:ne({shipId:v,carrierShipId:y,count:b,reinforcement:A,fleetSetup:T.fleetSetup,keepZero:!0})}):null)},[e]),x=d.exports.useMemo(()=>i?oe(i.fleetSetup):{},[i]);return{shipsForAddDialog:i,carrierShipId:p,shipWarnings:x,openForShips:h,openForCarriedShips:a,cancel:s,apply:E,setShipCount:D,setCarriedShipCount:m}};var Y={},mt=P.exports;Object.defineProperty(Y,"__esModule",{value:!0});var ae=Y.default=void 0,Ft=mt(H),ft=N,Ct=(0,Ft.default)((0,ft.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");ae=Y.default=Ct;var K={},gt=P.exports;Object.defineProperty(K,"__esModule",{value:!0});var se=K.default=void 0,xt=gt(H),vt=N,yt=(0,xt.default)((0,vt.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),"AddBox");se=K.default=yt;const St=r=>{const{shipDefinition:e,count:t,maxCount:n,reinforcement:i,showCost:o,showReinforcement:p,carrierShipId:c,shipWarning:h,onChangeShipCount:a,onChangeCarriedShipCount:s}=r,E=X(),D=ee(E.breakpoints.down("sm")),m=l(_,{children:[u(F,{variant:"body1",children:e.name}),o&&i===null&&u(F,{variant:"body2",color:"text.secondary",children:`\u6307\u4EE4\uFF30\uFF54\uFF1A${e.cost}\u3000\u5408\u8A08\uFF1A${e.cost*t}`}),p&&i==="self"&&u(F,{variant:"body2",color:"text.secondary",children:"\u5897\u63F4"}),p&&i==="ally"&&u(F,{variant:"body2",color:"text.secondary",children:"\u30E6\u30CB\u30AA\u30F3\u5897\u63F4"})]}),x=h&&u(F,{variant:"caption",color:"red",textAlign:"end",children:h}),v=u(k,{onClick:()=>{c?s==null||s(e.id,c,0,i):a==null||a(e.id,0,i)},disabled:t<=0,children:"\u5916\u3059"}),y=u(te,{onClick:()=>{c?s==null||s(e.id,c,t-1,i):a==null||a(e.id,t-1,i)},disabled:t<=0,children:u(ae,{color:t<=0?"disabled":"primary"})}),b=u(F,{variant:"body1",sx:{minWidth:"55px"},textAlign:"center",children:u("strong",{children:`${t} / ${n}`})}),A=u(te,{onClick:()=>{c?s==null||s(e.id,c,t+1,i):a==null||a(e.id,t+1,i)},disabled:t>=n,children:u(se,{color:t>=n?"disabled":"primary"})}),T=u(k,{onClick:()=>{c?s==null||s(e.id,c,n,i):a==null||a(e.id,n,i)},disabled:t>=n,children:"\u6700\u5927"});return u(I,{variant:"outlined",children:l(R,{p:1,children:[D&&l(g,{spacing:1,children:[m,l(I,{variant:"outlined",sx:{display:"flex",justifyContent:"center",flexWrap:"wrap"},children:[l(g,{direction:"row",spacing:1,sx:{alignItems:"center"},children:[y,b,A]}),l(g,{direction:"row",spacing:1,sx:{alignItems:"center"},children:[v,T]})]}),x]}),!D&&l(g,{spacing:1,children:[l(g,{spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[u(R,{pb:1,children:u(g,{spacing:1,children:m})}),u(R,{sx:{display:"flex",justifyContent:"end",flexGrow:1},children:u(I,{variant:"outlined",sx:{display:"inline-block"},children:l(g,{direction:"row",spacing:1,sx:{alignItems:"center"},children:[v,y,b,A,T]})})})]}),x]})]})})};function Dt(r){const e={corvette:{key:"corvette",name:"\u8B77\u9001\u8266",count:r.carriedShips.filter(t=>t.shipDefinition.type===S.CORVETTE).map(t=>t.count).reduce((t,n)=>t+n,0),maxCount:r.carryCorvette*r.count},upToLargeFighter:{key:"upToLargeFighter",name:"\u5927\u578B\u6226\u95D8\u6A5F",count:r.carriedShips.filter(t=>t.shipDefinition.type===S.FIGHTER&&t.shipDefinition.subType===z.LARGE_FIGHTER).map(t=>t.count).reduce((t,n)=>t+n,0),maxCount:r.carryUpToLargeFighter*r.count},upToMediumFighter:{key:"upToMediumFighter",name:"\u4E2D\u91CF\u7D1A\u6226\u95D8\u6A5F",count:r.carriedShips.filter(t=>t.shipDefinition.type===S.FIGHTER&&t.shipDefinition.subType===z.MEDIUM_FIGHTER).map(t=>t.count).reduce((t,n)=>t+n,0),maxCount:r.carryUpToMediumFighter*r.count},upToSmallFighter:{key:"upToSmallFighter",name:"\u5C0F\u578B\u6226\u95D8\u6A5F",count:r.carriedShips.filter(t=>t.shipDefinition.type===S.FIGHTER&&t.shipDefinition.subType===z.SMALL_FIGHTER).map(t=>t.count).reduce((t,n)=>t+n,0),maxCount:r.carryUpToSmallFighter*r.count},removedHangar:{key:"removedHangar",name:"\u8266\u8F09\u6A5F",count:0,maxCount:0}};return M(e.upToSmallFighter,[e.upToMediumFighter,e.upToLargeFighter]),M(e.upToMediumFighter,[e.upToLargeFighter]),e.upToSmallFighter.maxCount===0&&M(e.upToSmallFighter,[e.removedHangar]),e.upToMediumFighter.maxCount===0&&M(e.upToMediumFighter,[e.removedHangar]),e.upToLargeFighter.maxCount===0&&M(e.upToLargeFighter,[e.removedHangar]),e}function M(r,e){let t=r.count-r.maxCount;t<=0||e.forEach(n=>{if(t<=0||n.maxCount===0)return;const i=n.maxCount-n.count;if(i<=0)return;const o=Math.min(i,t);t-=o,n.count+=o})}function At(r){return r.count>0||r.maxCount>0}const Bt=r=>{const{shipSelection:e,onOpenAddCarriedShips:t}=r,n=d.exports.useMemo(()=>Dt(e),[e]);return l(g,{spacing:3,direction:"row",alignItems:"center",justifyContent:"space-between",children:[u(F,{variant:"body2",color:"text.secondary",children:"\u30CF\u30F3\u30AC\u30FC"}),l(g,{spacing:1,direction:"row",alignItems:"center",children:[Object.keys(n).filter(i=>At(n[i])).map(i=>n[i]).map(i=>l(d.exports.Fragment,{children:[u(F,{variant:"body2",color:"text.secondary",children:i.name}),u(F,{variant:"body2",color:"text.secondary",sx:{color:i.count>i.maxCount?"red":void 0},children:u("strong",{children:`${i.count} / ${i.maxCount}`})})]},i.key)),u(k,{variant:"outlined",startIcon:u(q,{}),onClick:()=>{t==null||t(e.shipDefinition.id,e.reinforcement)},children:"\u8266\u8F09\u6A5F\u3092\u8FFD\u52A0"})]})]})},le=d.exports.memo(St),ce=r=>{const{shipSelections:e,showCost:t,showReinforcement:n,showHangar:i,shipWarnings:o,carrierShipId:p,onChangeShipCount:c,onChangeCarriedShipCount:h,onOpenAddCarriedShips:a}=r;return console.log(e),u(g,{spacing:1,children:e==null?void 0:e.map(s=>{var E,D;return l(d.exports.Fragment,{children:[u(le,{shipDefinition:s.shipDefinition,count:s.count,maxCount:s.maxCount,reinforcement:s.reinforcement,showCost:t,showReinforcement:n,carrierShipId:p,onChangeShipCount:c,onChangeCarriedShipCount:h,shipWarning:o[j(s.shipDefinition.id,s.reinforcement)]}),i&&Ve(s)&&u(I,{variant:"outlined",children:u(R,{p:1,children:l(g,{spacing:1,children:[u(Bt,{shipSelection:s,onOpenAddCarriedShips:a}),(E=s.carriedShips)==null?void 0:E.map(m=>{var x;return u(le,{shipDefinition:m.shipDefinition,count:m.count,maxCount:m.shipDefinition.operationLimit,reinforcement:m.reinforcement,carrierShipId:s.shipDefinition.id,showCost:!1,showReinforcement:n,onChangeCarriedShipCount:h,shipWarning:o[j(m.shipDefinition.id,m.reinforcement)]},`${s.shipDefinition.id}_${m.shipDefinition.id}_${(x=m.reinforcement)!=null?x:"initial"}`)})]})})})]},`${s.shipDefinition.id}_${(D=s.reinforcement)!=null?D:"initial"}`)})})},Et=r=>{const{ships:e,carrierShipId:t,shipWarnings:n,onCancel:i,onApply:o,onChangeShipCount:p,onChangeCarriedShipCount:c}=r,[h,a]=d.exports.useState(!1),[s,E]=d.exports.useState(()=>{const m=Qe();return e.filter&&typeof m[e.filter]=="boolean"?C(f({},m),{[e.filter]:!0}):m}),D=d.exports.useMemo(()=>pt(s,e),[s,e]);return d.exports.useEffect(()=>{const m=setTimeout(()=>{a(!0)},0);return()=>{clearTimeout(m)}},[]),u(Je,{title:l(g,{spacing:1,direction:"row",justifyContent:"space-between",alignItems:"center",children:[u(F,{variant:"h6",children:bt(e.reinforcement)}),e.reinforcement===null?l("div",{children:[u(F,{variant:"body1",component:"span",children:"\u6307\u4EE4Pt\uFF1A"}),u(F,{variant:"body1",component:"span",sx:{color:e.fleetSetup.totalCost>e.fleetSetup.maxCost?"red":void 0},children:u("strong",{children:`${e.fleetSetup.totalCost} / ${e.fleetSetup.maxCost}`})})]}):l("div",{children:[u(F,{variant:"body1",component:"span",children:"\u5897\u63F4\uFF1A"}),u(F,{variant:"body1",component:"span",sx:{color:e.fleetSetup.totalReinforcementCount>e.fleetSetup.maxReinforcement?"red":void 0},children:u("strong",{children:`${e.fleetSetup.totalReinforcementCount} / ${e.fleetSetup.maxReinforcement}`})})]})]}),content:l(g,{spacing:2,children:[u(F,{variant:"body2",children:Rt(e.reinforcement)}),u("div",{children:u(Xe,{filter:s,shipTypes:[S.CARRIER,S.BATTLE_CRUISER,S.CRUISER,S.DESTROYER,S.FRIGATE],onChange:E,popperProps:{disablePortal:!1,placement:"bottom-start",style:{zIndex:1300}}})}),D.fleetSetup.ships.length===0&&u(Te,{severity:"info",children:"\u8A72\u5F53\u3059\u308B\u8266\u8239\u304C\u3042\u308A\u307E\u305B\u3093\u3002"}),h?u(ce,{shipSelections:D.fleetSetup.ships,showCost:!D.reinforcement,showReinforcement:!1,showHangar:!1,shipWarnings:n,carrierShipId:t,onChangeShipCount:p,onChangeCarriedShipCount:c}):l(g,{spacing:1,children:[u($,{variant:"rectangular",height:90}),u($,{variant:"rectangular",animation:"wave",height:90}),u($,{variant:"rectangular",height:90}),u($,{variant:"rectangular",animation:"wave",height:90}),u($,{variant:"rectangular",height:90})]})]}),actions:l(_,{children:[u(k,{variant:"outlined",onClick:i,children:"\u30AD\u30E3\u30F3\u30BB\u30EB"}),u(k,{variant:"contained",onClick:o,children:"\uFF2F\uFF2B"})]}),onClose:i})};function bt(r){switch(r){case"ally":case"self":return"\u5897\u63F4\u3092\u8FFD\u52A0";default:return"\u8266\u8239\u3092\u8FFD\u52A0"}}function Rt(r){switch(r){case"ally":return"\u30E6\u30CB\u30AA\u30F3\u30E1\u30F3\u30D0\u30FC\u304B\u3089\u9001\u3089\u308C\u308B\u5897\u63F4\u3092\u8FFD\u52A0\u3057\u307E\u3059\u3002";case"self":return"\u81EA\u8EAB\u306E\u57FA\u5730\u304B\u3089\u9001\u308B\u5897\u63F4\u3092\u8FFD\u52A0\u3057\u307E\u3059\u3002\u6240\u6301\u3057\u3066\u3044\u308B\u8266\u8239\u306F\u30DE\u30A4\u30EA\u30B9\u30C8\u3067\u8A2D\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002";default:return"\u8266\u8239\u3092\u901A\u5E38\u914D\u5099\u3057\u307E\u3059\u3002\u6240\u6301\u3057\u3066\u3044\u308B\u8266\u8239\u306F\u30DE\u30A4\u30EA\u30B9\u30C8\u3067\u8A2D\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002"}}const Pt=()=>{const r=Q(),{fleetKey:e}=ke(),t=X(),n=ee(t.breakpoints.up("lg")),i=d.exports.useMemo(()=>Ze(),[]),[o,p]=d.exports.useState(!1),{fleetSetup:c,errors:h,shipWarnings:a,setFleetSetup:s,setShipCount:E,setCarriedShipCount:D,save:m,reset:x}=at({initialFleetKey:e,userSettings:i}),{shipsForAddDialog:v,carrierShipId:y,shipWarnings:b,openForShips:A,openForCarriedShips:T,cancel:de,apply:pe,setShipCount:he,setCarriedShipCount:me}=ht({userSettings:i,fleetSetup:c,setFleetSetup:s}),Fe=d.exports.useMemo(()=>qe(c.ships),[c.ships]),[W,fe]=d.exports.useState(re.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME),G=d.exports.useMemo(()=>Ye(W,c),[c,W]),Ce=()=>{r(`/fleetSetup/${c.key}`)},ge=()=>{Object.keys(h).length>0||(m(),r(`/fleetSetup/${c.key}`))},xe=()=>{p(!1)},ve=()=>{p(!0)},ye=()=>{p(!1),x()},O=n&&G.groupedBy===re.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME?"row":"column",Se=O==="row"?4:2;return l(_,{children:[u(we,{currentRoute:"/fleetSetup"}),u(it,{grouping:W,onChangeGrouping:fe,onSave:ge,onCancel:Ce,onReset:ve,onOpenAddShips:A,saveDisabled:Object.keys(h).length>0}),u(Ie,{disabled:O==="row",children:u(R,{p:1,children:l(g,{spacing:1,children:[u(et,{fleetSetup:c,onChange:s,errors:h,columnCount:Se}),u(g,{spacing:1,direction:O,children:G.groups.map(w=>u(I,{sx:{width:O==="row"?`${100/G.groups.length}%`:void 0},children:u(R,{p:1,children:l(g,{spacing:1,children:[l(g,{spacing:1,direction:"row",alignItems:"center",sx:{width:"100%"},children:[u(R,{sx:{flexGrow:1},children:u(F,{variant:"body1",children:`${w.name}${w.count>0?`\uFF08${w.count}\u96BB\uFF09`:""}`})}),u(ie,{filter:w.id,onOpenAddShips:A})]}),w.ships.length>0&&u(ce,{shipSelections:w.ships,onChangeShipCount:E,onChangeCarriedShipCount:D,onOpenAddCarriedShips:T,showCost:!0,showReinforcement:!0,showHangar:!0,shipWarnings:a,carrierShipId:null})]})})},w.id))})]})})}),u(st,{fleetSetup:c,fleetShipCount:Fe}),v&&u(Et,{ships:v,carrierShipId:y,shipWarnings:b,onCancel:de,onApply:pe,onChangeShipCount:he,onChangeCarriedShipCount:me}),o&&u(je,{title:"\u521D\u671F\u5316",question:"\u8266\u968A\u3092\u521D\u671F\u72B6\u614B\u306B\u623B\u3057\u307E\u3059\u304B\uFF1F",cancelText:"\u30AD\u30E3\u30F3\u30BB\u30EB",confirmText:"\u521D\u671F\u5316",onCancel:xe,onConfirm:ye})]})};export{Pt as FleetSetupEditPage,Pt as default};
