import{E as D,G as _,H as R,r as F,j as e,F as y,a as d,B as A,K as z,S as C,T as n,b3 as N,f as v,e as B,d as V,t as H,ap as Y,b as E,ah as I,h as q,i as L,k as U,b5 as K,a2 as Q,af as Z,Z as O,$ as J}from"./index.9f9b351b.js";import{N as X,P as ee}from"./PageContent.5249989f.js";import{d as te}from"./Settings.6da274d0.js";import{d as ne,a as ae}from"./ContentCopy.f196e967.js";import{A as re}from"./ActionBar.a7b2dc0b.js";import{B as ue,S as oe,g as ie,a as se,v as le,f as ce,G as P,b as de,A as pe}from"./fleetSetupValidation.6420d03f.js";import{d as he}from"./ExpandMore.0622fb61.js";import{A as Fe,a as fe,b as me}from"./AccordionSummary.2ded0dcb.js";import{E as ve}from"./ExpandStack.bc877919.js";import{R as Ce}from"./ResponsiveDialog.001ed184.js";import{T as ge}from"./TextField.b1a1048c.js";import{P as xe}from"./PageFooter.99b900d4.js";import"./domUtils.0fc10fd6.js";import"./MenuItem.a46a301d.js";import"./sorting.c6946657.js";import"./Select.acc1025b.js";var k={},ye=_.exports;Object.defineProperty(k,"__esModule",{value:!0});var M=k.default=void 0,Ee=ye(D),$e=R,Se=(0,Ee.default)((0,$e.jsx)("path",{d:"M16 7c0 2.21-1.79 4-4 4S8 9.21 8 7s1.79-4 4-4 4 1.79 4 4zm-9 6c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm10 0c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"}),"Spoke");M=k.default=Se;const Ae=h=>{const{fleetSetups:t,fleetSetup:o,onChange:r,buttonProps:l}=h,i=F.exports.useMemo(()=>t.map(a=>({key:a.key,text:a.name,value:a.key})),[t]);return e(y,{children:e(ue,{icon:e(M,{}),text:"\u8266\u968A\u9078\u629E",value:o.key,options:i,onClick:r,buttonProps:l})})},be=h=>{const{fleetSetups:t,fleetSetup:o,grouping:r,onChangeFleet:l,onChangeGrouping:i,onEdit:a,onShare:s}=h;return e(re,{left:c=>d(y,{children:[e(oe,{value:r,onChange:i,buttonProps:c}),e(Ae,{fleetSetups:t,fleetSetup:o,onChange:l,buttonProps:c}),e(A,{variant:"outlined",startIcon:e(te,{}),onClick:a,...c,children:"\u7DE8\u96C6"},"edit")]}),right:c=>e(y,{children:e(A,{variant:"outlined",startIcon:e(ne,{}),onClick:s,...c,children:"\u5171\u6709"},"share")})})},Be=h=>{var a;const{initialFleetKey:t}=h,o=F.exports.useMemo(()=>ie(),[]),[r,l]=F.exports.useState(t&&(a=o.find(s=>s.key===t))!=null?a:o[0]),i=F.exports.useCallback(s=>{const c=o.find(f=>f.key===s);if(!c)throw new Error(`Invalid fleet key "${s}"`);l(c)},[o]);return{fleetSetups:o,fleetSetup:r,switchFleet:i}};var w={},De=_.exports;Object.defineProperty(w,"__esModule",{value:!0});var j=w.default=void 0,_e=De(D),Re=R,ke=(0,_e.default)((0,Re.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");j=w.default=ke;var T={},we=_.exports;Object.defineProperty(T,"__esModule",{value:!0});var W=T.default=void 0,Te=we(D),Ie=R,Oe=(0,Te.default)((0,Ie.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error");W=T.default=Oe;const Pe=h=>{const{fleetSetup:t}=h,[o,r]=F.exports.useState(!1),{totalCost:l,shipCount:i,shipCountByType:a,shipCountByRow:s}=F.exports.useMemo(()=>se(t.ships),[t.ships]),c=l>t.maxCost,f=t.totalReinforcementCount>t.maxReinforcement,x=F.exports.useMemo(()=>{const u=le(t);return Object.keys(u).map(m=>{const[$,p]=m.split("#"),S=z($);switch(p){case"self":return`${S.name}\uFF1A${u[m]}`;case"ally":return`${S.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF21\uFF09\uFF1A${u[m]}`;case"ally2":return`${S.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF22\uFF09\uFF1A${u[m]}`;case"ally3":return`${S.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF23\uFF09\uFF1A${u[m]}`;default:return`${S.name}\uFF1A${u[m]}`}})},[t]),b=c||f||x.length>0?e(W,{color:"error"}):e(j,{color:"primary"});return d(Fe,{expanded:o,onChange:()=>r(!o),children:[e(fe,{expandIcon:o?e(he,{}):b,children:d(C,{spacing:1,children:[e(n,{variant:"body1",children:t.name}),!o&&d("div",{children:[e(n,{variant:"body2",color:"text.secondary",component:"span",children:"\u5897\u63F4\uFF1A"}),e(n,{variant:"body2",color:"text.secondary",component:"span",sx:f?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`}),e(n,{variant:"body2",color:"text.secondary",component:"span",children:"\u3001\u53F8\u4EE4Pt\uFF1A"}),e(n,{variant:"body2",color:"text.secondary",component:"span",sx:c?{color:"red"}:{},children:`${l} / ${t.maxCost}`})]})]})}),e(me,{children:o&&e(N,{rows:[{key:"reinforcementCount",label:"\u5897\u63F4",value:e(n,{variant:"body2",sx:f?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`})},{key:"cost",label:"\u8266\u968A\u53F8\u4EE4Pt",value:e(n,{variant:"body2",sx:c?{color:"red"}:{},children:`${l} / ${t.maxCost}`})},{key:"shipCount",label:"\u8266\u8239",value:i>0?d(y,{children:[e(n,{variant:"body2",children:`\u5408\u8A08\u3000${i}`}),Object.keys(a).filter(u=>a[u]>0&&u!==v.CORVETTE&&u!==v.FIGHTER).map(u=>e(n,{variant:"body2",children:`${B(u)}\u3000${a[u]}`},u))]}):e(n,{variant:"body2",children:"-"})},{key:"carriedShipCount",label:"\u8266\u8F09\u6A5F",value:a[v.FIGHTER]+a[v.CORVETTE]>0?d(y,{children:[a[v.FIGHTER]>0&&e(n,{variant:"body2",children:`${B(v.FIGHTER)}\u3000${a[v.FIGHTER]}`}),a[v.CORVETTE]>0&&e(n,{variant:"body2",children:`${B(v.CORVETTE)}\u3000${a[v.CORVETTE]}`})]}):e(n,{variant:"body2",children:"-"})},{key:"rowCount",label:"\u914D\u7F6E",value:i>0?e(y,{children:Object.keys(s).filter(u=>u!==V.NONE).map(u=>e(n,{variant:"body2",children:`${H(u)}\u3000${s[u]}`},u))}):e(n,{variant:"body2",children:"-"})},...x.length>0?[{key:"warnings",label:"\u8B66\u544A",value:x.map((u,m)=>e(n,{variant:"body2",sx:{color:"red"},children:u},`warning_${m}`))}]:[]]})})]})},G=h=>{const{shipSelections:t}=h,{openShipDetailDialog:o}=Y();return e(C,{spacing:1,children:t==null?void 0:t.map(r=>{var l;return d(F.exports.Fragment,{children:[d(C,{spacing:1,direction:"row",children:[d(C,{spacing:1,direction:"row",flexWrap:"wrap",sx:{flexGrow:1},children:[e(E,{sx:{width:"25px"},children:e(n,{variant:"body2",textAlign:"end",children:`${r.count}\xD7`})}),e(n,{variant:"body2",children:e(I,{onClick:()=>{o(r.shipDefinition.id)},children:r.shipDefinition.name})}),r.reinforcement==="self"&&e(n,{variant:"body2",noWrap:!0,children:"\uFF08\u5897\u63F4\uFF09"}),r.reinforcement==="ally"&&e(n,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF21\uFF09"}),r.reinforcement==="ally2"&&e(n,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF22\uFF09"}),r.reinforcement==="ally3"&&e(n,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF23\uFF09"})]}),e(E,{sx:{width:"50px"},children:r.reinforcement===null&&e(n,{variant:"body2",textAlign:"end",children:`${r.shipDefinition.cost*r.count} Pt`})})]}),r.carriedShips.map(i=>{var a;return d(C,{spacing:1,direction:"row",flexWrap:"wrap",children:[e(n,{variant:"body2",color:"text.secondary",sx:{paddingLeft:"30px",opacity:.5},children:"\u2517"}),e(E,{sx:{width:"25px"},children:e(n,{variant:"body2",textAlign:"end",children:`${i.count}\xD7`})}),e(n,{variant:"body2",children:e(I,{onClick:()=>{o(i.shipDefinition.id)},children:i.shipDefinition.name})})]},`${i.shipDefinition.id}_${(a=i.reinforcement)!=null?a:"initial"}`)})]},`${r.shipDefinition.id}_${(l=r.reinforcement)!=null?l:"initial"}`)})})},Ge=h=>{const{fleetSetup:t,groupedShips:o,onClose:r}=h,[l,i]=F.exports.useState(!1),[a,s]=F.exports.useState(()=>ce(t,o)),c=()=>{a&&L(a).then(()=>{i(!0)})},f=g=>{s(g.target.value)},x=()=>{r(),i(!1)};return e(Ce,{title:"\u5171\u6709",content:d(C,{spacing:1,children:[e(ge,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:f,rows:10,defaultValue:a,fullWidth:!0}),!!navigator.clipboard&&e(A,{variant:"outlined",startIcon:l?e(q,{}):e(ae,{}),onClick:c,fullWidth:!0,children:"\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u306B\u30B3\u30D4\u30FC"})]}),actions:e(A,{variant:"outlined",onClick:x,children:"\u9589\u3058\u308B"}),onClose:x})},et=()=>{const h=U(),{fleetKey:t}=K(),o=Q(),r=Z(o.breakpoints.up("lg")),[l,i]=F.exports.useState(!1),{fleetSetups:a,fleetSetup:s,switchFleet:c}=Be({initialFleetKey:t!=null?t:null}),[f,x]=F.exports.useState(P.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME),g=F.exports.useMemo(()=>de(f,s),[s,f]),b=()=>{h("/fleetSetup/edit/"+s.key)},u=()=>{i(!0)},m=()=>{i(!1)},$=r&&g.groupedBy===P.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME?"row":"column";return d(y,{children:[e(X,{currentRoute:"/fleetSetup"}),e(be,{fleetSetups:a,fleetSetup:s,grouping:f,onChangeFleet:c,onChangeGrouping:x,onEdit:b,onShare:u}),e(ee,{disableContainer:$==="row",children:e(E,{p:1,children:d(C,{spacing:1,children:[e(Pe,{fleetSetup:s}),s.ships.length>0?e(y,{children:$==="row"?e(C,{spacing:1,direction:"row",sx:{width:"100%"},children:g.groups.map(p=>e(O,{sx:{width:`${100/g.groups.length}%`},children:e(E,{p:1,children:d(C,{spacing:1,children:[e(n,{variant:"body1",children:`${p.name}${p.count>0?`\uFF08${p.count}\u96BB\uFF09`:""}`}),e(J,{}),e(G,{shipSelections:p.ships})]})})},p.id))}):e(ve,{expandables:g.groups.map(p=>({id:p.id,initiallyOpened:!0,summary:e(n,{variant:"body1",children:`${p.name}${p.count>0?`\uFF08${p.count}\u96BB\uFF09`:""}`}),details:e(G,{shipSelections:p.ships}),skip:p.ships.length===0}))},g.groupedBy)}):e(O,{children:e(E,{p:2,children:d(C,{spacing:1,children:[e(n,{variant:"body1",children:"\u7DE8\u6210"}),e(pe,{severity:"info",children:"\u3053\u306E\u8266\u968A\u306B\u306F\u307E\u3060\u8266\u8239\u304C\u8FFD\u52A0\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002\u4E0A\u306E\u300C\u7DE8\u96C6\u300D\u30DC\u30BF\u30F3\u3067\u7DE8\u96C6\u30E2\u30FC\u30C9\u306B\u5207\u308A\u66FF\u3048\u308B\u3068\u8266\u8239\u306E\u8FFD\u52A0\u3084\u5897\u63F4\u306E\u8A2D\u5B9A\u7B49\u304C\u884C\u3048\u307E\u3059\u3002"})]})})}),e(n,{variant:"caption",align:"right",paragraph:!0,children:"\u203B\u8A2D\u5B9A\u30C7\u30FC\u30BF\u306F\u30D6\u30E9\u30A6\u30B6\u306E\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u306B\u4FDD\u5B58\u3055\u308C\u3066\u3044\u307E\u3059\u3002"})]})})}),l&&e(Ge,{fleetSetup:s,groupedShips:g,onClose:m}),e(xe,{disableContainer:$==="row"})]})};export{et as FleetSetupPage,et as default};
