var re=Object.defineProperty,ie=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var U=(n,a,r)=>a in n?re(n,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[a]=r,v=(n,a)=>{for(var r in a||(a={}))ue.call(a,r)&&U(n,r,a[r]);if(L)for(var r of L(a))le.call(a,r)&&U(n,r,a[r]);return n},g=(n,a)=>ie(n,ne(a));import{u as se,a as ce,r as C,j as t,b as d,c as S,T as h,F as I,am as P,v as V,w as G,x as q,ac as he,ad as J,au as b,af as E,ag as B,ah as R,E as y,D as T,av as M,h as Q,S as O,A as de}from"./vendor.612e55a5.js";import{N as oe,C as pe}from"./NavigationBar.e91af742.js";import{d as me,R as w,f as A,h as _,p as x,l as j,m as $,n as k,z as Fe,L as fe}from"./index.c9d82ed2.js";import{d as Y,i as K,b as Ce,g as Se}from"./userSettingsUtils.d186ff19.js";import{u as ye,T as ve}from"./useTable.a69db608.js";import{E as ge}from"./ExpandStack.42dab450.js";import{R as be}from"./ResponsiveDialog.418e97d8.js";import"./WishState.3db35fd5.js";import"./sorting.c6946657.js";import"./ExpandMore.57c07b9b.js";function Te(){return me.filter(n=>!!n.researchManufacturer||!!n.researchStrategyTypes||!!n.researchTacticTypes)}function De(n,a){const r=[],l=[],u=[];return n.forEach(c=>{if(Y(c.id,a)){l.push(c);return}if(K(c.id,a)){r.push(c);return}u.push(c)}),{wantedShips:r.sort((c,m)=>c.name.localeCompare(m.name)),possessedShips:l.sort((c,m)=>c.name.localeCompare(m.name)),remainingShips:u.sort((c,m)=>c.name.localeCompare(m.name))}}function we(){const n=[w.NOMA_SHIPPING_GROUP,w.JUPITER_INDUSTRIES,w.ANTONIOS_CONSORTIUM,w.DAWN_ACCORD,null],a=[A.OUTSTANDING_FIREPOWER,A.SUSTAINED_COMBAT,A.STRATEGY_AND_SUPPORT,A.FIGHTER_AND_CORVETTE,null],r=[_.PROJECTILE_WEAPONS,_.DIRECT_FIRE_WEAPONS,null];return n.flatMap(l=>a.flatMap(u=>r.map(c=>({shipId:null,manufacturerFilter:l,strategyTypeFilter:u,tacticTypeFilter:c}))))}let Ae=0;function xe(n,a,r){const l=a.filter(e=>!(n.manufacturerFilter!==null&&e.researchManufacturer!==n.manufacturerFilter||n.strategyTypeFilter!==null&&e.researchStrategyTypes&&!e.researchStrategyTypes.includes(n.strategyTypeFilter)||n.tacticTypeFilter!==null&&e.researchTacticTypes&&!e.researchTacticTypes.includes(n.tacticTypeFilter))),u=l.reduce((e,i)=>e+i.weight,0),c=l.map(e=>{const i=Y(e.id,r);return{shipDefinition:e,chance:e.weight/u,formula:`${e.weight} / ${u}`,possessed:i,wished:K(e.id,r),unwished:Ce(e.id,r)}});let m=0,f=0,o=0,p=0,F=0;return c.forEach(e=>{if(!e.possessed){m+=e.chance,e.wished&&(o+=e.chance),e.unwished&&(p+=e.chance);return}if(e.shipDefinition.modules&&e.shipDefinition.modules.length>0){f+=e.chance;return}F+=e.chance}),{id:`${Ae++}`,filterState:n,shipChances:c,totalShipChance:m,totalModuleChance:f,wishedShipChance:o,unwishedShipChance:p,techPointChance:F}}function Ee(n){var a,r,l;return`${(a=n.manufacturerFilter)!=null?a:"null"}.${(r=n.strategyTypeFilter)!=null?r:"null"}.${(l=n.tacticTypeFilter)!=null?l:"null"}`}function Be(n,a){if(a.shipId!==null)return n.filter(u=>!u.filterState.manufacturerFilter&&!u.filterState.strategyTypeFilter&&!u.filterState.tacticTypeFilter?!1:u.shipChances.find(c=>c.shipDefinition.id===a.shipId)).sort((u,c)=>{var o,p,F,e;const m=(p=(o=u.shipChances.find(i=>i.shipDefinition.id===a.shipId))==null?void 0:o.chance)!=null?p:0;return((e=(F=c.shipChances.find(i=>i.shipDefinition.id===a.shipId))==null?void 0:F.chance)!=null?e:0)-m});const r=[],l=n.filter(u=>a.manufacturerFilter!==null&&u.filterState.manufacturerFilter!==a.manufacturerFilter||a.strategyTypeFilter!==null&&u.filterState.strategyTypeFilter!==a.strategyTypeFilter||a.tacticTypeFilter!==null&&u.filterState.tacticTypeFilter!==a.tacticTypeFilter||!u.filterState.manufacturerFilter&&!u.filterState.strategyTypeFilter&&!u.filterState.tacticTypeFilter?!1:u.filterState.manufacturerFilter===a.manufacturerFilter&&u.filterState.strategyTypeFilter===a.strategyTypeFilter&&u.filterState.tacticTypeFilter===a.tacticTypeFilter?(r.push(u),!1):u);return[...r,...l]}const Re=n=>{const{configurations:a,filterState:r,onClickConfiguration:l}=n,{table:u,setTableData:c}=ye(),m=se(),o=ce(m.breakpoints.down("sm"))?"38px":"50px",p=r.shipId;return C.exports.useEffect(()=>{const F={columns:[{id:"filter",renderHeader:()=>"\u30D5\u30A3\u30EB\u30BF\u30FC",renderCell:e=>d(S,{sx:{minWidth:"120px"},children:[e.filterState.manufacturerFilter&&t(h,{variant:"body2",children:t(x,{onClick:()=>l(e),children:j(e.filterState.manufacturerFilter)})}),e.filterState.strategyTypeFilter&&t(h,{variant:"body2",children:t(x,{onClick:()=>l(e),children:$(e.filterState.strategyTypeFilter)})}),e.filterState.tacticTypeFilter&&t(h,{variant:"body2",children:t(x,{onClick:()=>l(e),children:k(e.filterState.tacticTypeFilter)})}),!e.filterState.manufacturerFilter&&!e.filterState.strategyTypeFilter&&!e.filterState.tacticTypeFilter&&t(h,{variant:"body2",children:t(x,{onClick:()=>l(e),children:"\u7121\u3057"})})]})},...p?[{id:"selectedShipChance",renderHeader:()=>"\u9078\u629E\u3057\u305F\u8266\u8239",renderCell:e=>t(S,{sx:{minWidth:o},children:t(h,{variant:"body2",children:D(N(e,p))})}),sortFn:[(e,i)=>N(e,p)-N(i,p),(e,i)=>e.totalShipChance-i.totalShipChance,(e,i)=>i.techPointChance-e.techPointChance,(e,i)=>e.wishedShipChance-i.wishedShipChance,(e,i)=>i.unwishedShipChance-e.unwishedShipChance]}]:[],{id:"totalShipChance",renderHeader:()=>"\u8A2D\u8A08\u56F3",renderCell:e=>t(S,{sx:{minWidth:o},children:t(h,{variant:"body2",children:D(e.totalShipChance)})}),sortFn:[(e,i)=>e.totalShipChance-i.totalShipChance,(e,i)=>i.techPointChance-e.techPointChance,(e,i)=>e.wishedShipChance-i.wishedShipChance,(e,i)=>i.unwishedShipChance-e.unwishedShipChance]},{id:"totalModuleChance",renderHeader:()=>"\u30E2\u30B8\u30E5\u30FC\u30EB",renderCell:e=>t(S,{sx:{minWidth:o},children:t(h,{variant:"body2",children:D(e.totalModuleChance)})}),sortFn:[(e,i)=>e.totalModuleChance-i.totalModuleChance,(e,i)=>e.totalShipChance-i.totalShipChance,(e,i)=>i.techPointChance-e.techPointChance,(e,i)=>e.wishedShipChance-i.wishedShipChance,(e,i)=>i.unwishedShipChance-e.unwishedShipChance]},{id:"techPointChance",renderHeader:()=>"\u6280\u8853Pt",renderCell:e=>t(S,{sx:{minWidth:o},children:t(h,{variant:"body2",children:D(e.techPointChance)})}),sortFn:[(e,i)=>e.techPointChance-i.techPointChance,(e,i)=>i.totalShipChance-e.totalShipChance,(e,i)=>i.wishedShipChance-e.wishedShipChance,(e,i)=>e.unwishedShipChance-i.unwishedShipChance]},{id:"wishedShipChance",renderHeader:()=>"\u6B32\u3057\u3044\u8266\u8239",renderCell:e=>t(S,{sx:{minWidth:o},children:t(h,{variant:"body2",children:D(e.wishedShipChance)})}),sortFn:[(e,i)=>e.wishedShipChance-i.wishedShipChance,(e,i)=>i.techPointChance-e.techPointChance,(e,i)=>e.totalShipChance-i.totalShipChance,(e,i)=>i.unwishedShipChance-e.unwishedShipChance]},{id:"unwishedShipChance",renderHeader:()=>"\u6B32\u3057\u304F\u306A\u3044\u8266\u8239",renderCell:e=>t(S,{sx:{minWidth:o},children:t(h,{variant:"body2",children:D(e.unwishedShipChance)})}),sortFn:[(e,i)=>e.unwishedShipChance-i.unwishedShipChance,(e,i)=>i.totalShipChance-e.totalShipChance,(e,i)=>i.wishedShipChance-e.wishedShipChance,(e,i)=>e.techPointChance-i.techPointChance]}],data:a,rowIdFn:e=>Ee(e.filterState)};c(F)},[c,a,p,l,o]),t(ve,{table:u,size:"small"})};function D(n){return`${Number((n*100).toFixed(2))} %`}function N(n,a){var r,l;return(l=(r=n.shipChances.find(u=>u.shipDefinition.id===a))==null?void 0:r.chance)!=null?l:0}const Ie=n=>{const{shipDefinition:a}=n,{openShipDetailDialog:r}=Fe();return t(h,{variant:"body2",component:"span",children:t(x,{onClick:()=>{r(a.id)},children:a.name})})},X=n=>{const{configuration:a}=n;return t(fe,{rows:[{key:`${a.id}.wishedShipChance`,label:"\u6B32\u3057\u3044\u8A2D\u8A08\u56F3",value:W(a.wishedShipChance),separatorAfter:!0},...a.techPointChance>0?[{key:`${a.id}.techPointChance`,label:t(h,{variant:"body2",sx:a.techPointChance>0?{color:"red"}:void 0,children:"\u6280\u8853Pt \xD7\uFF15"}),value:t(h,{variant:"body2",sx:a.techPointChance>0?{color:"red"}:void 0,children:W(a.techPointChance)}),separatorAfter:!0}]:[],...a.shipChances.map(r=>{const l=r.possessed&&r.shipDefinition.modules&&r.shipDefinition.modules.length>0;return{key:`${a.id}.${r.shipDefinition.id}`,label:d(I,{children:[t(Ie,{shipDefinition:r.shipDefinition}),l&&t(h,{variant:"body2",component:"span",children:"\uFF08\u8FFD\u52A0\u30E2\u30B8\u30E5\u30FC\u30EB\uFF09"}),!l&&r.possessed&&t(h,{variant:"body2",component:"span",children:"\uFF08\u6280\u8853Pt\uFF09"}),r.wished&&t(P,{arrow:!0,disableFocusListener:!0,title:"\u6B32\u3057\u3044\u8266\u8239",children:t(h,{variant:"body2",component:"span",sx:{color:"#ffc107",marginLeft:"4px"},children:"\u2605"})})]}),value:t(P,{arrow:!0,disableFocusListener:!0,title:d(I,{children:[t(h,{variant:"body2",gutterBottom:!0,children:"\u78BA\u7387\u306E\u91CD\u307F / \u5408\u8A08"}),t(h,{variant:"body2",children:r.formula})]}),children:t(h,{variant:"body2",sx:{color:!l&&r.possessed?"red":void 0},children:W(r.chance)})})}})],rowGap:1})};function W(n){return`${Number((n*100).toFixed(3))} %`}const Z=n=>{var l,u;const{configuration:a,filterState:r}=n;return d(h,{variant:"body2",children:[[...a.filterState.manufacturerFilter!==null?[j(a.filterState.manufacturerFilter)]:[],...a.filterState.strategyTypeFilter!==null?[$(a.filterState.strategyTypeFilter)]:[],...a.filterState.tacticTypeFilter!==null?[k(a.filterState.tacticTypeFilter)]:[],...!a.filterState.manufacturerFilter&&!a.filterState.strategyTypeFilter&&!a.filterState.tacticTypeFilter?["\u7121\u3057"]:[]].map(c=>`\u300C${c}\u300D`).join("+"),r.shipId===null&&a.wishedShipChance>0&&t(P,{arrow:!0,disableFocusListener:!0,title:`\u6B32\u3057\u3044\u8266\u8239\u304C\u5F53\u305F\u308B\u78BA\u7387\uFF1A${ee(a.wishedShipChance)}`,children:t(h,{variant:"body2",component:"span",sx:{color:"#ffc107",marginLeft:"4px"},children:"\u2605"})}),r.shipId!==null&&t(h,{variant:"body2",component:"span",children:`\u3000\u21D2\u3000${ee((u=(l=a.shipChances.find(c=>c.shipDefinition.id===r.shipId))==null?void 0:l.chance)!=null?u:0)}`})]})};function ee(n){return`${Number((n*100).toFixed(3))} %`}const Pe=n=>{const{configurations:a,filterState:r}=n,l=!!r.manufacturerFilter||!!r.strategyTypeFilter||!!r.tacticTypeFilter;return t(ge,{expandables:a.map(u=>({id:u.id,initiallyOpened:l,summary:t(Z,{configuration:u,filterState:r}),details:t(X,{configuration:u})})),unmount:!0})};var z={},Me=G.exports;Object.defineProperty(z,"__esModule",{value:!0});var te=z.default=void 0,Oe=Me(V),_e=q,je=(0,Oe.default)((0,_e.jsx)("path",{d:"M22 11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3z"}),"AccountTree");te=z.default=je;var H={},$e=G.exports;Object.defineProperty(H,"__esModule",{value:!0});var ae=H.default=void 0,ke=$e(V),Ne=q,We=(0,ke.default)((0,Ne.jsx)("path",{d:"M21 8H3V4h18v4zm0 2H3v4h18v-4zm0 6H3v4h18v-4z"}),"TableRows");ae=H.default=We;const ze=n=>{const{mode:a,onChange:r}=n;return d(he,{value:a,exclusive:!0,onChange:(u,c)=>{r(c)},size:"small","aria-label":"view mode",children:[t(J,{value:"ships","aria-label":"ships",children:t(te,{})}),t(J,{value:"table","aria-label":"table",children:t(ae,{})})]})},He=n=>{var p,F,e,i;const{filterState:a,shipFilterOptions:r,onChange:l}=n,u=s=>{l(g(v({},a),{shipId:s.target.value===""?null:s.target.value,manufacturerFilter:null,strategyTypeFilter:null,tacticTypeFilter:null}))},c=s=>{l(g(v({},a),{shipId:null,manufacturerFilter:s.target.value===""?null:s.target.value}))},m=s=>{l(g(v({},a),{shipId:null,strategyTypeFilter:s.target.value===""?null:s.target.value}))},f=s=>{l(g(v({},a),{shipId:null,tacticTypeFilter:s.target.value===""?null:s.target.value}))},o=()=>{l(g(v({},a),{shipId:null,manufacturerFilter:null,strategyTypeFilter:null,tacticTypeFilter:null}))};return d(b,{container:!0,spacing:2,children:[t(b,{item:!0,xs:12,sm:8,md:4,children:d(E,{fullWidth:!0,size:"small",children:[t(B,{id:"manufacturer-select-label",children:"\u59D4\u8A17\u4F01\u696D"}),d(R,{labelId:"manufacturer-select-label",value:(p=a.manufacturerFilter)!=null?p:"",label:"\u59D4\u8A17\u4F01\u696D",onChange:c,children:[t(y,{value:"",children:"\u7121\u3057"}),t(T,{}),Object.values(w).map(s=>t(y,{value:s,children:j(s)},s))]})]})}),t(b,{item:!0,xs:12,sm:8,md:4,children:d(E,{fullWidth:!0,size:"small",children:[t(B,{id:"strategy-select-label",children:"\u6226\u7565\u80FD\u529B"}),d(R,{labelId:"strategy-select-label",value:(F=a.strategyTypeFilter)!=null?F:"",label:"\u6226\u7565\u80FD\u529B",onChange:m,children:[t(y,{value:"",children:"\u7121\u3057"}),t(T,{}),Object.values(A).map(s=>t(y,{value:s,children:$(s)},s))]})]})}),t(b,{item:!0,xs:12,sm:8,md:4,children:d(E,{fullWidth:!0,size:"small",children:[t(B,{id:"tactics-select-label",children:"\u6226\u8853\u6027\u80FD"}),d(R,{labelId:"tactics-select-label",value:(e=a.tacticTypeFilter)!=null?e:"",label:"\u6226\u8853\u6027\u80FD",onChange:f,children:[t(y,{value:"",children:"\u7121\u3057"}),t(T,{}),Object.values(_).map(s=>t(y,{value:s,children:k(s)},s))]})]})}),t(b,{item:!0,xs:12,sm:8,children:d(E,{fullWidth:!0,size:"small",children:[t(B,{id:"ship-select-label",children:"\u8266\u8239"}),d(R,{labelId:"ship-select-label",value:(i=a.shipId)!=null?i:"",label:"\u8266\u8239",onChange:u,children:[t(y,{value:"",children:"\u7121\u3057"}),r.wantedShips.length>0&&t(T,{}),r.wantedShips.length>0&&t(M,{disableSticky:!0,children:"\u6B32\u3057\u3044\u8266\u8239\uFF1A"}),r.wantedShips.map(s=>d(y,{value:s.id,children:[s.name,t(h,{variant:"body1",component:"span",sx:{color:"#ffc107",marginLeft:"4px"},children:"\u2605"})]},s.id)),r.remainingShips.length>0&&t(T,{}),r.remainingShips.length>0&&t(M,{disableSticky:!0,children:"\u53D6\u5F97\u53EF\u80FD\u306A\u8266\u8239\uFF1A"}),r.remainingShips.map(s=>t(y,{value:s.id,children:s.name},s.id)),r.possessedShips.length>0&&t(T,{}),r.possessedShips.length>0&&t(M,{disableSticky:!0,children:"\u53D6\u5F97\u6E08\u307F\u306E\u8266\u8239\uFF1A"}),r.possessedShips.map(s=>t(y,{value:s.id,children:s.name},s.id))]})]})}),t(b,{item:!0,xs:12,sm:4,sx:{display:"flex",justifyContent:"end"},children:t(Q,{variant:"outlined",onClick:o,children:"\u30EA\u30BB\u30C3\u30C8"})})]})},Le=C.exports.memo(Re),Ue=C.exports.memo(Pe),at=()=>{const[n,a]=C.exports.useState("ships"),r=C.exports.useMemo(()=>Te(),[]),l=C.exports.useMemo(()=>Se(),[]),u=C.exports.useMemo(()=>we(),[]),c=C.exports.useMemo(()=>u.map(i=>xe(i,r,l)),[u,r]),m=C.exports.useMemo(()=>De(r,l),[r,l]),[f,o]=C.exports.useState({shipId:null,manufacturerFilter:null,strategyTypeFilter:null,tacticTypeFilter:null}),p=C.exports.useMemo(()=>Be(c,f),[c,f]),[F,e]=C.exports.useState(null);return d(I,{children:[t(oe,{currentRoute:"/researchAgreement"}),t(pe,{children:t(S,{p:1,children:d(O,{spacing:1,children:[d(O,{pt:1,pb:1,spacing:2,children:[t(h,{variant:"body2",children:"\u3053\u3053\u3067\u306F\u300C\u7814\u7A76\u5354\u5B9A\u300D\u306B\u95A2\u3059\u308B\u5404\u7A2E\u78BA\u7387\u3092\u8868\u793A\u3057\u3066\u3044\u307E\u3059\u3002"}),t(h,{variant:"body2",children:"\u7814\u7A76\u65B9\u91DD\uFF08\u59D4\u8A17\u4F01\u696D\u3001\u6226\u7565\u80FD\u529B\u3001\u6226\u8853\u80FD\u529B\uFF09\u3092\u9078\u629E\u3057\u305F\u5834\u5408\u306F\u305D\u306E\u7D44\u307F\u5408\u308F\u305B\u3067\u624B\u306B\u5165\u308B\u8A2D\u8A08\u56F3\u3084\u8FFD\u52A0\u30E2\u30B8\u30E5\u30FC\u30EB\u306E\u78BA\u7387\u304C\u8868\u793A\u3055\u308C\u307E\u3059\u3002\u8266\u8239\u3092\u9078\u629E\u3057\u305F\u5834\u5408\u306F\u305D\u306E\u8266\u8239\u3092\u542B\u3080\u7814\u7A76\u65B9\u91DD\u304C\u78BA\u7387\u9806\u306B\u8868\u793A\u3055\u308C\u307E\u3059\u3002"}),t(h,{variant:"body2",children:"\u53D6\u5F97\u6E08\u307F\u306E\u8A2D\u8A08\u56F3\u306F\u30DE\u30A4\u30EA\u30B9\u30C8\u3067\u8A2D\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002"})]}),t(de,{children:t(S,{p:2,children:d(O,{spacing:2,children:[t(h,{variant:"body2",children:"\u7814\u7A76\u65B9\u91DD"}),t("div",{children:t(He,{filterState:f,onChange:o,shipFilterOptions:m})}),t(S,{sx:{display:"flex",justifyContent:"end"},children:t(ze,{mode:n,onChange:a})})]})})}),n==="ships"&&t(Ue,{configurations:p,filterState:f})]})})}),n==="table"&&t(S,{p:1,children:t(Le,{configurations:p,filterState:f,onClickConfiguration:e})}),F&&t(be,{maxWidth:"sm",title:t(Z,{configuration:F,filterState:f}),content:t(X,{configuration:F}),actions:t(Q,{variant:"outlined",onClick:()=>e(null),children:"\u9589\u3058\u308B"}),onClose:()=>e(null)})]})};export{at as ResearchAgreementPage,at as default};
