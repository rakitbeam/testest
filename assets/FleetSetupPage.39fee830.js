var q=Object.defineProperty,U=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var T=(r,t,n)=>t in r?q(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,b=(r,t)=>{for(var n in t||(t={}))Y.call(t,n)&&T(r,n,t[n]);if(w)for(var n of w(t))L.call(t,n)&&T(r,n,t[n]);return r},E=(r,t)=>U(r,V(t));import{r as f,j as e,F as g,b as p,h as y,$ as H,a0 as Q,S as C,T as a,a1 as J,c as S,p as K,q as X,ar as Z,u as ee,a as te,t as I,D as ne,as as ae}from"./vendor.4663e7d5.js";import{c as $,i as B,r as _,N as re,C as oe}from"./NavigationBar.ff166a92.js";import{d as ue}from"./Settings.4b71925b.js";import{d as ie,a as se,b as le,c as ce,E as de}from"./clipboardUtils.c98a6f1d.js";import{A as pe}from"./ActionBar.ab3d85e9.js";import{B as he,S as fe,g as me,a as ve,f as Ce,G as O,b as ge}from"./shipCounter.b2ce0a07.js";import{g as Fe}from"./userSettingsUtils.337fefff.js";import{d as xe}from"./ExpandMore.af037a98.js";import{L as Se,a as D,b as x,S as ye,t as be}from"./index.bd9adf92.js";import{R as Ee}from"./ResponsiveDialog.fa559a51.js";import"./domUtils.e9df6b0f.js";import"./sorting.c6946657.js";import"./WishState.3db35fd5.js";var A={},$e=B.exports;Object.defineProperty(A,"__esModule",{value:!0});var M=A.default=void 0,Be=$e($),_e=_,De=(0,Be.default)((0,_e.jsx)("path",{d:"M16 7c0 2.21-1.79 4-4 4S8 9.21 8 7s1.79-4 4-4 4 1.79 4 4zm-9 6c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm10 0c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"}),"Spoke");M=A.default=De;const Ae=r=>{const{fleetSetups:t,fleetSetup:n,onChange:u,buttonProps:c}=r,l=f.exports.useMemo(()=>t.map(o=>({key:o.key,text:o.name,value:o.key})),[t]);return e(g,{children:e(he,{icon:e(M,{}),text:"\u8266\u968A\u9078\u629E",value:n.key,options:l,onClick:u,buttonProps:c})})},Re=r=>{const{fleetSetups:t,fleetSetup:n,grouping:u,onChangeFleet:c,onChangeGrouping:l,onEdit:o,onShare:s}=r;return e(pe,{left:i=>p(g,{children:[e(fe,{value:u,onChange:l,buttonProps:i}),e(Ae,{fleetSetups:t,fleetSetup:n,onChange:c,buttonProps:i}),e(y,E(b({variant:"outlined",startIcon:e(ue,{}),onClick:o},i),{children:"\u7DE8\u96C6"}),"edit")]}),right:i=>e(g,{children:e(y,E(b({variant:"outlined",startIcon:e(ie,{}),onClick:s},i),{children:"\u5171\u6709"}),"share")})})},ke=r=>{var s;const{initialFleetKey:t}=r;console.log(t);const n=f.exports.useMemo(()=>Fe(),[]),u=f.exports.useMemo(()=>me(n),[n]),[c,l]=f.exports.useState(t&&(s=u.find(i=>i.key===t))!=null?s:u[0]),o=f.exports.useCallback(i=>{const h=u.find(F=>F.key===i);if(!h)throw new Error(`Invalid fleet key "${i}"`);l(h)},[u]);return{fleetSetups:u,fleetSetup:c,switchFleet:o}};var R={},je=B.exports;Object.defineProperty(R,"__esModule",{value:!0});var G=R.default=void 0,we=je($),Te=_,Ie=(0,we.default)((0,Te.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");G=R.default=Ie;var k={},Oe=B.exports;Object.defineProperty(k,"__esModule",{value:!0});var P=k.default=void 0,Me=Oe($),Ge=_,Pe=(0,Me.default)((0,Ge.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error");P=k.default=Pe;const Ne=r=>{const{fleetSetup:t}=r,[n,u]=f.exports.useState(!1),{totalCost:c,shipCount:l,shipCountByType:o,shipCountByRow:s}=f.exports.useMemo(()=>ve(t.ships),[t.ships]),i=c>t.maxCost,h=t.totalReinforcementCount>t.maxReinforcement;return p(H,{expanded:n,onChange:()=>u(!n),children:[e(Q,{expandIcon:n?e(xe,{}):i||h?e(P,{color:"error"}):e(G,{color:"primary"}),children:p(C,{spacing:1,children:[e(a,{variant:"body1",children:t.name}),!n&&p("div",{children:[e(a,{variant:"body2",color:"text.secondary",component:"span",children:"\u5897\u63F4\uFF1A"}),e(a,{variant:"body2",color:"text.secondary",component:"span",sx:h?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`}),e(a,{variant:"body2",color:"text.secondary",component:"span",children:"\u3001\u53F8\u4EE4Pt\uFF1A"}),e(a,{variant:"body2",color:"text.secondary",component:"span",sx:i?{color:"red"}:{},children:`${c} / ${t.maxCost}`})]})]})}),e(J,{children:n&&e(Se,{rows:[{key:"reinforcementCount",label:"\u5897\u63F4",value:e(a,{variant:"body2",sx:h?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`})},{key:"cost",label:"\u8266\u968A\u53F8\u4EE4Pt",value:e(a,{variant:"body2",sx:i?{color:"red"}:{},children:`${c} / ${t.maxCost}`})},{key:"shipCount",label:"\u8266\u8239",value:l>0?p(g,{children:[e(a,{variant:"body2",children:`\u5408\u8A08\u3000${l}`}),Object.keys(o).filter(d=>o[d]>0).map(d=>e(a,{variant:"body2",children:`${D(d)}\u3000${o[d]}`},d))]}):e(a,{variant:"body2",children:"-"})},{key:"carriedShipCount",label:"\u8266\u8F09\u6A5F",value:o[x.FIGHTER]+o[x.CORVETTE]>0?p(g,{children:[e(a,{variant:"body2",children:`${D(x.FIGHTER)}\u3000${o[x.FIGHTER]}`}),e(a,{variant:"body2",children:`${D(x.CORVETTE)}\u3000${o[x.CORVETTE]}`})]}):e(a,{variant:"body2",children:"-"})},{key:"rowCount",label:"\u914D\u7F6E",value:l>0?e(g,{children:Object.keys(s).filter(d=>d!==ye.NONE).map(d=>e(a,{variant:"body2",children:`${be(d)}\u3000${s[d]}`},d))}):e(a,{variant:"body2",children:"-"})}]})})]})},N=r=>{const{shipSelections:t}=r;return e(C,{spacing:1,children:t==null?void 0:t.map(n=>{var u;return p(C,{spacing:1,direction:"row",children:[p(C,{spacing:1,direction:"row",flexWrap:"wrap",sx:{flexGrow:1},children:[e(S,{sx:{width:"25px"},children:e(a,{variant:"body2",textAlign:"end",children:`${n.count}\xD7`})}),e(a,{variant:"body2",children:n.shipDefinition.name}),n.reinforcement==="self"&&e(a,{variant:"body2",noWrap:!0,children:"\uFF08\u5897\u63F4\uFF09"}),n.reinforcement==="ally"&&e(a,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF09"})]}),e(S,{sx:{width:"50px"},children:n.reinforcement===null&&e(a,{variant:"body2",textAlign:"end",children:`${n.shipDefinition.cost*n.count} Pt`})})]},`${n.shipDefinition.id}_${(u=n.reinforcement)!=null?u:"initial"}`)})})},ze=r=>{const{fleetSetup:t,groupedShips:n,onClose:u}=r,[c,l]=f.exports.useState(!1),[o,s]=f.exports.useState(()=>Ce(t,n)),i=()=>{o&&ce(o).then(()=>{l(!0)})},h=v=>{s(v.target.value)},F=()=>{u(),l(!1)};return e(Ee,{title:"\u5171\u6709",content:p(C,{spacing:1,children:[e(K,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:h,rows:10,defaultValue:o,fullWidth:!0}),!!navigator.clipboard&&e(y,{variant:"outlined",startIcon:c?e(se,{}):e(le,{}),onClick:i,fullWidth:!0,children:"\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u306B\u30B3\u30D4\u30FC"})]}),actions:e(y,{variant:"outlined",onClick:F,children:"\u9589\u3058\u308B"}),onClose:F})},nt=()=>{const r=X(),{fleetKey:t}=Z(),n=ee(),u=te(n.breakpoints.up("lg")),[c,l]=f.exports.useState(!1),{fleetSetups:o,fleetSetup:s,switchFleet:i}=ke({initialFleetKey:t!=null?t:null}),[h,F]=f.exports.useState(O.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME),v=f.exports.useMemo(()=>ge(h,s),[s,h]),d=()=>{r("/fleetSetup/edit/"+s.key)},z=()=>{l(!0)},W=()=>{l(!1)},j=u&&v.groupedBy===O.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME?"row":"column";return p(g,{children:[e(re,{currentRoute:"/fleetSetup"}),e(Re,{fleetSetups:o,fleetSetup:s,grouping:h,onChangeFleet:i,onChangeGrouping:F,onEdit:d,onShare:z}),e(oe,{disabled:j==="row",children:e(S,{p:1,children:p(C,{spacing:1,children:[e(Ne,{fleetSetup:s}),s.ships.length>0?e(g,{children:j==="row"?e(C,{spacing:1,direction:"row",sx:{width:"100%"},children:v.groups.map(m=>e(I,{sx:{width:`${100/v.groups.length}%`},children:e(S,{p:1,children:p(C,{spacing:1,children:[e(a,{variant:"body1",children:`${m.name}${m.count>0?`\uFF08${m.count}\u96BB\uFF09`:""}`}),e(ne,{}),e(N,{shipSelections:m.ships})]})})},v.groupedBy))}):e(de,{expandables:v.groups.map(m=>({id:m.id,initiallyOpened:!0,summary:e(a,{variant:"body1",children:`${m.name}${m.count>0?`\uFF08${m.count}\u96BB\uFF09`:""}`}),details:e(N,{shipSelections:m.ships}),skip:m.ships.length===0}))},v.groupedBy)}):e(I,{children:e(S,{p:2,children:p(C,{spacing:1,children:[e(a,{variant:"body1",children:"\u7DE8\u6210"}),e(ae,{severity:"info",children:"\u3053\u306E\u8266\u968A\u306B\u306F\u307E\u3060\u8266\u8239\u304C\u8FFD\u52A0\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002\u4E0A\u306E\u300C\u7DE8\u96C6\u300D\u30DC\u30BF\u30F3\u3067\u7DE8\u96C6\u30E2\u30FC\u30C9\u306B\u5207\u308A\u66FF\u3048\u308B\u3068\u8266\u8239\u306E\u8FFD\u52A0\u3084\u5897\u63F4\u306E\u8A2D\u5B9A\u7B49\u304C\u884C\u3048\u307E\u3059\u3002"})]})})}),e(a,{variant:"caption",align:"right",paragraph:!0,children:"\u203B\u8A2D\u5B9A\u30C7\u30FC\u30BF\u306F\u30D6\u30E9\u30A6\u30B6\u306E\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u306B\u4FDD\u5B58\u3055\u308C\u3066\u3044\u307E\u3059\u3002"})]})})}),c&&e(ze,{fleetSetup:s,groupedShips:v,onClose:W})]})};export{nt as FleetSetupPage,nt as default};
