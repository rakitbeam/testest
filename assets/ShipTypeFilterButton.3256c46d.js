var q=Object.defineProperty,Y=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var k=(t,e,r)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,f=(t,e)=>{for(var r in e||(e={}))Q.call(e,r)&&k(t,r,e[r]);if(j)for(var r of j(e))X.call(e,r)&&k(t,r,e[r]);return t},_=(t,e)=>Y(t,V(e));import{v as B,w as H,x as w,r as R,b as A,F as Z,y as ee,j as l,h as C,P as te,G as re,z as ae,A as se,c as K,M as le,E as ne,I as ue,J as oe,K as ie,D as ce,S as de}from"./vendor.612e55a5.js";import{P as U,a as Oe,W as y,i as L,f as Se,h as Te,S as O,j as p,M as u,R as o,k as i,l as E,m as I,t as fe,n as Ie,o as he,p as _e,q as Ee}from"./index.50b861ee.js";import{g as Ne}from"./domUtils.e9df6b0f.js";var b={},Re=H.exports;Object.defineProperty(b,"__esModule",{value:!0});var $=b.default=void 0,Ae=Re(B),Fe=w,Pe=(0,Ae.default)((0,Fe.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAlt");$=b.default=Pe;var v={},Ce=H.exports;Object.defineProperty(v,"__esModule",{value:!0});var g=v.default=void 0,pe=Ce(B),me=w,De=(0,pe.default)((0,me.jsx)("path",{d:"M19.79 5.61C20.3 4.95 19.83 4 19 4H6.83l7.97 7.97 4.99-6.36zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41L2.81 2.81z"}),"FilterAltOff");g=v.default=De;function Me(t){return(t!=null?t:[O.FRONT,O.MIDDLE,O.BACK]).map(e=>({filterKey:e,name:fe(e)}))}function Ue(t){return(t!=null?t:Object.keys(p)).map(e=>({filterKey:e,name:p[e].name}))}function ye(t){return(t!=null?t:[u.JUPITER_INDUSTRIES,u.NOMA_SHIPPING_GROUP,u.ANTONIOS_CONSORTIUM,u.DAWN_ACCORD]).map(e=>({filterKey:e,name:Ie(e)}))}function be(t){return(t!=null?t:[o.JUPITER_INDUSTRIES,o.NOMA_SHIPPING_GROUP,o.ANTONIOS_CONSORTIUM,o.DAWN_ACCORD]).map(e=>({filterKey:e,name:`\u59D4\u8A17\u4F01\u696D\uFF1A${he(e)}`}))}function ve(t){return(t!=null?t:[i.OUTSTANDING_FIREPOWER,i.SUSTAINED_COMBAT,i.STRATEGY_AND_SUPPORT,i.FIGHTER_AND_CORVETTE]).map(e=>({filterKey:e,name:`\u6226\u7565\u80FD\u529B\uFF1A${_e(e)}`}))}function xe(t){return(t!=null?t:[E.PROJECTILE_WEAPONS,E.DIRECT_FIRE_WEAPONS]).map(e=>({filterKey:e,name:`\u6226\u8853\u6027\u80FD\uFF1A${Ee(e)}`}))}function We(t={}){var e,r,a,s,n,S;return[...Me((e=t.shipRows)!=null?e:null),...Ue((r=t.shipTypes)!=null?r:null),...ye((a=t.manufacturer)!=null?a:null),...t.researchManufacturer===!1?[]:be((s=t.researchManufacturer)!=null?s:null),...t.researchStrategyTypes===!1?[]:ve((n=t.researchStrategyTypes)!=null?n:null),...t.researchTacticTypes===!1?[]:xe((S=t.researchTacticTypes)!=null?S:null)]}function qe(){return _(f({[O.FRONT]:!1,[O.MIDDLE]:!1,[O.BACK]:!1},Object.keys(p).reduce((t,e)=>_(f({},t),{[e]:!1}),{})),{[u.JUPITER_INDUSTRIES]:!1,[u.NOMA_SHIPPING_GROUP]:!1,[u.ANTONIOS_CONSORTIUM]:!1,[u.DAWN_ACCORD]:!1,[o.JUPITER_INDUSTRIES]:!1,[o.NOMA_SHIPPING_GROUP]:!1,[o.ANTONIOS_CONSORTIUM]:!1,[o.DAWN_ACCORD]:!1,[i.OUTSTANDING_FIREPOWER]:!1,[i.SUSTAINED_COMBAT]:!1,[i.STRATEGY_AND_SUPPORT]:!1,[i.FIGHTER_AND_CORVETTE]:!1,[E.PROJECTILE_WEAPONS]:!1,[E.DIRECT_FIRE_WEAPONS]:!1})}function Ge(t){const e=f({},t);return Object.keys(e).forEach(r=>{e[r]=!1}),e}function Ye(t,e){let r=t;return je(e)&&(r=r.filter(a=>e[a.row]===!0)),ke(e)&&(r=r.filter(a=>e[a.type]===!0)),Be(e)&&(r=r.filter(a=>e[a.manufacturer]===!0)),He(e)&&(r=r.filter(a=>a.researchManufacturer&&e[a.researchManufacturer]===!0)),we(e)&&(r=r.filter(a=>{var s;return((s=a.researchStrategyTypes)!=null?s:[]).some(n=>e[n]===!0)})),Ke(e)&&(r=r.filter(a=>{var s;return((s=a.researchTacticTypes)!=null?s:[]).some(n=>e[n]===!0)})),r}function Ve(t){const e={[I.STARTER_SHIP]:[],[I.TECH_FILE]:[],[I.CITY_TRADE]:[],[I.DOCK_EFFECT]:[],[I.UNKNOWN]:[]};return t.forEach(r=>{e[r.source].push(r)}),e}function je(t){return[O.FRONT,O.MIDDLE,O.BACK].some(e=>t[e]===!0)}function ke(t){return Object.keys(p).some(e=>t[e]===!0)}function Be(t){return[u.JUPITER_INDUSTRIES,u.NOMA_SHIPPING_GROUP,u.ANTONIOS_CONSORTIUM,u.DAWN_ACCORD].some(e=>t[e]===!0)}function He(t){return[o.JUPITER_INDUSTRIES,o.NOMA_SHIPPING_GROUP,o.ANTONIOS_CONSORTIUM,o.DAWN_ACCORD].some(e=>t[e]===!0)}function we(t){return[i.OUTSTANDING_FIREPOWER,i.SUSTAINED_COMBAT,i.STRATEGY_AND_SUPPORT,i.FIGHTER_AND_CORVETTE].some(e=>t[e]===!0)}function Ke(t){return[E.PROJECTILE_WEAPONS,E.DIRECT_FIRE_WEAPONS].some(e=>t[e]===!0)}function Qe(t,e){return t.filter(r=>{var a;return((a=e[r.id])==null?void 0:a.possession)===U.POSSESSED})}function Xe(t,e){return t.filter(r=>{var a;return Oe(r,e).length>0?!0:((a=e.ships[r.id])==null?void 0:a.wish)===y.WANTED})}function Ze(t,e){return t.filter(r=>{var a;return L(r.id)&&((a=e[r.id])==null?void 0:a.wish)===y.NOT_WANTED})}function et(t,e){return t.filter(s=>s.source===I.TECH_FILE||s.source===I.STARTER_SHIP).filter(s=>{var n;return((n=e.ships[s.id])==null?void 0:n.possession)===U.POSSESSED}).filter(s=>{var n,S,F;if(!!s.modules&&Se(s,e).length>0||s.baseModelId)return!1;if(!!s.subModelIds||!!s.baseModelId){const d=(F=(S=s.subModelIds)!=null?S:(n=Te(s.baseModelId))==null?void 0:n.subModelIds)!=null?F:[];return Le(d,e.ships)?!(d.filter(T=>L(T)&&!!e.ships[T]&&e.ships[T].possession!==U.POSSESSED).filter(T=>e.ships[T].wish!==y.NOT_WANTED).length>0):!1}return!0})}function Le(t,e){return t.length>0&&t.every(r=>{var a;return!!((a=e[r])==null?void 0:a.possession)})}const tt=t=>{const{onChange:e,popperProps:r,shipRows:a,shipTypes:s,researchManufacturer:n,researchStrategyTypes:S,researchTacticTypes:F,buttonProps:d}=t,[h,m]=R.exports.useState(t.filter),[T,D]=R.exports.useState(!1),[J]=R.exports.useState(()=>We({shipRows:a,shipTypes:s,researchManufacturer:n,researchStrategyTypes:S,researchTacticTypes:F})),M=R.exports.useRef(null),z=c=>{m(P=>_(f({},P),{[c]:!P[c]}))},x=()=>{m(c=>Ge(c))};R.exports.useEffect(()=>{const c=setTimeout(()=>{e(h)},0);return()=>clearTimeout(c)},[h,e]);const W=Object.values(h).some(c=>c);return A(Z,{children:[A(ee,{variant:"outlined",ref:M,fullWidth:d==null?void 0:d.fullWidth,size:d==null?void 0:d.size,children:[l(C,{startIcon:l($,{}),onClick:()=>D(!0),sx:{flexShrink:1},children:"\u30D5\u30A3\u30EB\u30BF\u30FC"}),W&&l(C,{size:"small",onClick:x,sx:{flexShrink:3},children:l(g,{})})]},"filter"),l(te,_(f({open:T,anchorEl:M.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:1}},r),{children:({TransitionProps:c,placement:P})=>{var G;return l(re,_(f({},c),{style:{transformOrigin:P==="bottom"?"center top":"center bottom"},children:l("div",{children:l(ae,{onClickAway:()=>D(!1),children:A(se,{children:[l(K,{sx:{overflowY:"auto",maxHeight:`${((G=Ne(M.current))!=null?G:0)-50}px`},children:l(le,{id:"split-button-menu",children:J.map(N=>A(ne,{selected:h[N.filterKey],onClick:()=>z(N.filterKey),children:[l(ue,{children:l(oe,{edge:"start",checked:h[N.filterKey],tabIndex:-1,disableRipple:!0})}),l(ie,{children:N.name})]},N.filterKey))})}),l(ce,{}),l(K,{p:1,display:"flex",justifyContent:"end",children:A(de,{spacing:1,direction:"row",children:[l(C,{variant:"outlined",onClick:x,disabled:!W,children:"\u5168\u3066\u5916\u3059"}),l(C,{variant:"outlined",onClick:()=>D(!1),children:"\u9589\u3058\u308B"})]})})]})})})}))}}))]})};export{tt as S,Ye as a,Xe as b,qe as c,Ze as d,Qe as e,et as f,Ve as s};
