var Y=Object.defineProperty,q=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var M=(i,t,n)=>t in i?Y(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,B=(i,t)=>{for(var n in t||(t={}))U.call(t,n)&&M(i,n,t[n]);if(O)for(var n of O(t))Q.call(t,n)&&M(i,n,t[n]);return i},D=(i,t)=>q(i,H(t));import{v as _,w as R,x as k,r as F,j as e,F as y,b as p,h as b,a1 as J,a2 as K,S as C,T as r,a3 as X,c as S,s as Z,i as ee,t as te,aw as ne,u as ae,a as re,A as G,D as ue,ax as oe}from"./vendor.612e55a5.js";import{N as ie,C as se}from"./NavigationBar.e91af742.js";import{d as le}from"./Settings.1acf125d.js";import{d as ce,a as de}from"./ContentCopy.968408c1.js";import{A as pe}from"./ActionBar.a2802d77.js";import{B as he,S as Fe,g as fe,a as me,v as ve,f as Ce,G as P,b as ge}from"./fleetSetupValidation.f5aaa80d.js";import{g as xe}from"./userSettingsUtils.304511e2.js";import{d as ye}from"./ExpandMore.57c07b9b.js";import{g as Se,L as Ee,b as g,a as w,S as $e,t as be,z as Ae,p as W,c as Be}from"./index.bcaed592.js";import{E as De}from"./ExpandStack.42dab450.js";import{R as _e}from"./ResponsiveDialog.418e97d8.js";import"./domUtils.e9df6b0f.js";import"./sorting.c6946657.js";import"./WishState.3db35fd5.js";var j={},Re=R.exports;Object.defineProperty(j,"__esModule",{value:!0});var z=j.default=void 0,ke=Re(_),we=k,je=(0,ke.default)((0,we.jsx)("path",{d:"M16 7c0 2.21-1.79 4-4 4S8 9.21 8 7s1.79-4 4-4 4 1.79 4 4zm-9 6c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm10 0c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"}),"Spoke");z=j.default=je;const Te=i=>{const{fleetSetups:t,fleetSetup:n,onChange:a,buttonProps:d}=i,s=F.exports.useMemo(()=>t.map(u=>({key:u.key,text:u.name,value:u.key})),[t]);return e(y,{children:e(he,{icon:e(z,{}),text:"\u8266\u968A\u9078\u629E",value:n.key,options:s,onClick:a,buttonProps:d})})},Ie=i=>{const{fleetSetups:t,fleetSetup:n,grouping:a,onChangeFleet:d,onChangeGrouping:s,onEdit:u,onShare:c}=i;return e(pe,{left:l=>p(y,{children:[e(Fe,{value:a,onChange:s,buttonProps:l}),e(Te,{fleetSetups:t,fleetSetup:n,onChange:d,buttonProps:l}),e(b,D(B({variant:"outlined",startIcon:e(le,{}),onClick:u},l),{children:"\u7DE8\u96C6"}),"edit")]}),right:l=>e(y,{children:e(b,D(B({variant:"outlined",startIcon:e(ce,{}),onClick:c},l),{children:"\u5171\u6709"}),"share")})})},Oe=i=>{var c;const{initialFleetKey:t}=i,n=F.exports.useMemo(()=>xe(),[]),a=F.exports.useMemo(()=>fe(n),[n]),[d,s]=F.exports.useState(t&&(c=a.find(l=>l.key===t))!=null?c:a[0]),u=F.exports.useCallback(l=>{const f=a.find(m=>m.key===l);if(!f)throw new Error(`Invalid fleet key "${l}"`);s(f)},[a]);return{fleetSetups:a,fleetSetup:d,switchFleet:u}};var T={},Me=R.exports;Object.defineProperty(T,"__esModule",{value:!0});var N=T.default=void 0,Ge=Me(_),Pe=k,We=(0,Ge.default)((0,Pe.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");N=T.default=We;var I={},ze=R.exports;Object.defineProperty(I,"__esModule",{value:!0});var V=I.default=void 0,Ne=ze(_),Ve=k,Le=(0,Ne.default)((0,Ve.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error");V=I.default=Le;const Ye=i=>{const{fleetSetup:t}=i,[n,a]=F.exports.useState(!1),{totalCost:d,shipCount:s,shipCountByType:u,shipCountByRow:c}=F.exports.useMemo(()=>me(t.ships),[t.ships]),l=d>t.maxCost,f=t.totalReinforcementCount>t.maxReinforcement,m=F.exports.useMemo(()=>{const o=ve(t);return Object.keys(o).map(v=>{const[$,h]=v.split("#"),E=Se($);switch(h){case"self":return`${E.name}\uFF1A${o[v]}`;case"ally":return`${E.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF21\uFF09\uFF1A${o[v]}`;case"ally2":return`${E.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF22\uFF09\uFF1A${o[v]}`;case"ally3":return`${E.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF23\uFF09\uFF1A${o[v]}`;default:return`${E.name}\uFF1A${o[v]}`}})},[t]),A=l||f||m.length>0?e(V,{color:"error"}):e(N,{color:"primary"});return p(J,{expanded:n,onChange:()=>a(!n),children:[e(K,{expandIcon:n?e(ye,{}):A,children:p(C,{spacing:1,children:[e(r,{variant:"body1",children:t.name}),!n&&p("div",{children:[e(r,{variant:"body2",color:"text.secondary",component:"span",children:"\u5897\u63F4\uFF1A"}),e(r,{variant:"body2",color:"text.secondary",component:"span",sx:f?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`}),e(r,{variant:"body2",color:"text.secondary",component:"span",children:"\u3001\u53F8\u4EE4Pt\uFF1A"}),e(r,{variant:"body2",color:"text.secondary",component:"span",sx:l?{color:"red"}:{},children:`${d} / ${t.maxCost}`})]})]})}),e(X,{children:n&&e(Ee,{rows:[{key:"reinforcementCount",label:"\u5897\u63F4",value:e(r,{variant:"body2",sx:f?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`})},{key:"cost",label:"\u8266\u968A\u53F8\u4EE4Pt",value:e(r,{variant:"body2",sx:l?{color:"red"}:{},children:`${d} / ${t.maxCost}`})},{key:"shipCount",label:"\u8266\u8239",value:s>0?p(y,{children:[e(r,{variant:"body2",children:`\u5408\u8A08\u3000${s}`}),Object.keys(u).filter(o=>u[o]>0&&o!==g.CORVETTE&&o!==g.FIGHTER).map(o=>e(r,{variant:"body2",children:`${w(o)}\u3000${u[o]}`},o))]}):e(r,{variant:"body2",children:"-"})},{key:"carriedShipCount",label:"\u8266\u8F09\u6A5F",value:u[g.FIGHTER]+u[g.CORVETTE]>0?p(y,{children:[u[g.FIGHTER]>0&&e(r,{variant:"body2",children:`${w(g.FIGHTER)}\u3000${u[g.FIGHTER]}`}),u[g.CORVETTE]>0&&e(r,{variant:"body2",children:`${w(g.CORVETTE)}\u3000${u[g.CORVETTE]}`})]}):e(r,{variant:"body2",children:"-"})},{key:"rowCount",label:"\u914D\u7F6E",value:s>0?e(y,{children:Object.keys(c).filter(o=>o!==$e.NONE).map(o=>e(r,{variant:"body2",children:`${be(o)}\u3000${c[o]}`},o))}):e(r,{variant:"body2",children:"-"})},...m.length>0?[{key:"warnings",label:"\u8B66\u544A",value:m.map((o,v)=>e(r,{variant:"body2",sx:{color:"red"},children:o},`warning_${v}`))}]:[]]})})]})},L=i=>{const{shipSelections:t}=i,{openShipDetailDialog:n}=Ae();return e(C,{spacing:1,children:t==null?void 0:t.map(a=>{var d;return p(F.exports.Fragment,{children:[p(C,{spacing:1,direction:"row",children:[p(C,{spacing:1,direction:"row",flexWrap:"wrap",sx:{flexGrow:1},children:[e(S,{sx:{width:"25px"},children:e(r,{variant:"body2",textAlign:"end",children:`${a.count}\xD7`})}),e(r,{variant:"body2",children:e(W,{onClick:()=>{n(a.shipDefinition.id)},children:a.shipDefinition.name})}),a.reinforcement==="self"&&e(r,{variant:"body2",noWrap:!0,children:"\uFF08\u5897\u63F4\uFF09"}),a.reinforcement==="ally"&&e(r,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF21\uFF09"}),a.reinforcement==="ally2"&&e(r,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF22\uFF09"}),a.reinforcement==="ally3"&&e(r,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF23\uFF09"})]}),e(S,{sx:{width:"50px"},children:a.reinforcement===null&&e(r,{variant:"body2",textAlign:"end",children:`${a.shipDefinition.cost*a.count} Pt`})})]}),a.carriedShips.map(s=>{var u;return p(C,{spacing:1,direction:"row",flexWrap:"wrap",children:[e(r,{variant:"body2",color:"text.secondary",sx:{paddingLeft:"30px",opacity:.5},children:"\u2517"}),e(S,{sx:{width:"25px"},children:e(r,{variant:"body2",textAlign:"end",children:`${s.count}\xD7`})}),e(r,{variant:"body2",children:e(W,{onClick:()=>{n(s.shipDefinition.id)},children:s.shipDefinition.name})})]},`${s.shipDefinition.id}_${(u=s.reinforcement)!=null?u:"initial"}`)})]},`${a.shipDefinition.id}_${(d=a.reinforcement)!=null?d:"initial"}`)})})},qe=i=>{const{fleetSetup:t,groupedShips:n,onClose:a}=i,[d,s]=F.exports.useState(!1),[u,c]=F.exports.useState(()=>Ce(t,n)),l=()=>{u&&Be(u).then(()=>{s(!0)})},f=x=>{c(x.target.value)},m=()=>{a(),s(!1)};return e(_e,{title:"\u5171\u6709",content:p(C,{spacing:1,children:[e(Z,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:f,rows:10,defaultValue:u,fullWidth:!0}),!!navigator.clipboard&&e(b,{variant:"outlined",startIcon:d?e(ee,{}):e(de,{}),onClick:l,fullWidth:!0,children:"\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u306B\u30B3\u30D4\u30FC"})]}),actions:e(b,{variant:"outlined",onClick:m,children:"\u9589\u3058\u308B"}),onClose:m})},st=()=>{const i=te(),{fleetKey:t}=ne(),n=ae(),a=re(n.breakpoints.up("lg")),[d,s]=F.exports.useState(!1),{fleetSetups:u,fleetSetup:c,switchFleet:l}=Oe({initialFleetKey:t!=null?t:null}),[f,m]=F.exports.useState(P.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME),x=F.exports.useMemo(()=>ge(f,c),[c,f]),A=()=>{i("/fleetSetup/edit/"+c.key)},o=()=>{s(!0)},v=()=>{s(!1)},$=a&&x.groupedBy===P.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME?"row":"column";return p(y,{children:[e(ie,{currentRoute:"/fleetSetup"}),e(Ie,{fleetSetups:u,fleetSetup:c,grouping:f,onChangeFleet:l,onChangeGrouping:m,onEdit:A,onShare:o}),e(se,{disabled:$==="row",children:e(S,{p:1,children:p(C,{spacing:1,children:[e(Ye,{fleetSetup:c}),c.ships.length>0?e(y,{children:$==="row"?e(C,{spacing:1,direction:"row",sx:{width:"100%"},children:x.groups.map(h=>e(G,{sx:{width:`${100/x.groups.length}%`},children:e(S,{p:1,children:p(C,{spacing:1,children:[e(r,{variant:"body1",children:`${h.name}${h.count>0?`\uFF08${h.count}\u96BB\uFF09`:""}`}),e(ue,{}),e(L,{shipSelections:h.ships})]})})},h.id))}):e(De,{expandables:x.groups.map(h=>({id:h.id,initiallyOpened:!0,summary:e(r,{variant:"body1",children:`${h.name}${h.count>0?`\uFF08${h.count}\u96BB\uFF09`:""}`}),details:e(L,{shipSelections:h.ships}),skip:h.ships.length===0}))},x.groupedBy)}):e(G,{children:e(S,{p:2,children:p(C,{spacing:1,children:[e(r,{variant:"body1",children:"\u7DE8\u6210"}),e(oe,{severity:"info",children:"\u3053\u306E\u8266\u968A\u306B\u306F\u307E\u3060\u8266\u8239\u304C\u8FFD\u52A0\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002\u4E0A\u306E\u300C\u7DE8\u96C6\u300D\u30DC\u30BF\u30F3\u3067\u7DE8\u96C6\u30E2\u30FC\u30C9\u306B\u5207\u308A\u66FF\u3048\u308B\u3068\u8266\u8239\u306E\u8FFD\u52A0\u3084\u5897\u63F4\u306E\u8A2D\u5B9A\u7B49\u304C\u884C\u3048\u307E\u3059\u3002"})]})})}),e(r,{variant:"caption",align:"right",paragraph:!0,children:"\u203B\u8A2D\u5B9A\u30C7\u30FC\u30BF\u306F\u30D6\u30E9\u30A6\u30B6\u306E\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u306B\u4FDD\u5B58\u3055\u308C\u3066\u3044\u307E\u3059\u3002"})]})})}),d&&e(qe,{fleetSetup:c,groupedShips:x,onClose:v})]})};export{st as FleetSetupPage,st as default};
