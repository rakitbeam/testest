var q=Object.defineProperty,H=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var M=(i,t,n)=>t in i?q(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,B=(i,t)=>{for(var n in t||(t={}))U.call(t,n)&&M(i,n,t[n]);if(I)for(var n of I(t))Q.call(t,n)&&M(i,n,t[n]);return i},D=(i,t)=>H(i,L(t));import{v as _,w as R,x as k,r as F,j as e,F as y,b as p,h as b,a1 as J,a2 as K,S as v,T as a,a3 as X,c as E,s as Z,i as ee,t as te,aw as ne,u as ae,a as ue,A as G,D as re,ax as oe}from"./vendor.612e55a5.js";import{N as ie,C as se}from"./NavigationBar.e91af742.js";import{d as le}from"./Settings.1acf125d.js";import{d as ce,a as de}from"./ContentCopy.968408c1.js";import{A as pe}from"./ActionBar.a2802d77.js";import{B as he,S as Fe,g as fe,a as me,v as ve,f as Ce,G as P,b as xe}from"./fleetSetupValidation.a72b1394.js";import{d as ge}from"./ExpandMore.57c07b9b.js";import{h as ye,O as Ee,c as C,b as w,S as Se,t as $e,C as be,r as W,d as Ae}from"./index.e495074f.js";import{E as Be}from"./ExpandStack.42dab450.js";import{R as De}from"./ResponsiveDialog.418e97d8.js";import"./domUtils.e9df6b0f.js";import"./sorting.c6946657.js";var j={},_e=R.exports;Object.defineProperty(j,"__esModule",{value:!0});var N=j.default=void 0,Re=_e(_),ke=k,we=(0,Re.default)((0,ke.jsx)("path",{d:"M16 7c0 2.21-1.79 4-4 4S8 9.21 8 7s1.79-4 4-4 4 1.79 4 4zm-9 6c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm10 0c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"}),"Spoke");N=j.default=we;const je=i=>{const{fleetSetups:t,fleetSetup:n,onChange:r,buttonProps:c}=i,s=F.exports.useMemo(()=>t.map(u=>({key:u.key,text:u.name,value:u.key})),[t]);return e(y,{children:e(he,{icon:e(N,{}),text:"\u8266\u968A\u9078\u629E",value:n.key,options:s,onClick:r,buttonProps:c})})},Te=i=>{const{fleetSetups:t,fleetSetup:n,grouping:r,onChangeFleet:c,onChangeGrouping:s,onEdit:u,onShare:l}=i;return e(pe,{left:d=>p(y,{children:[e(Fe,{value:r,onChange:s,buttonProps:d}),e(je,{fleetSetups:t,fleetSetup:n,onChange:c,buttonProps:d}),e(b,D(B({variant:"outlined",startIcon:e(le,{}),onClick:u},d),{children:"\u7DE8\u96C6"}),"edit")]}),right:d=>e(y,{children:e(b,D(B({variant:"outlined",startIcon:e(ce,{}),onClick:l},d),{children:"\u5171\u6709"}),"share")})})},Oe=i=>{var u;const{initialFleetKey:t}=i,n=F.exports.useMemo(()=>fe(),[]),[r,c]=F.exports.useState(t&&(u=n.find(l=>l.key===t))!=null?u:n[0]),s=F.exports.useCallback(l=>{const d=n.find(f=>f.key===l);if(!d)throw new Error(`Invalid fleet key "${l}"`);c(d)},[n]);return{fleetSetups:n,fleetSetup:r,switchFleet:s}};var T={},Ie=R.exports;Object.defineProperty(T,"__esModule",{value:!0});var z=T.default=void 0,Me=Ie(_),Ge=k,Pe=(0,Me.default)((0,Ge.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");z=T.default=Pe;var O={},We=R.exports;Object.defineProperty(O,"__esModule",{value:!0});var V=O.default=void 0,Ne=We(_),ze=k,Ve=(0,Ne.default)((0,ze.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error");V=O.default=Ve;const Ye=i=>{const{fleetSetup:t}=i,[n,r]=F.exports.useState(!1),{totalCost:c,shipCount:s,shipCountByType:u,shipCountByRow:l}=F.exports.useMemo(()=>me(t.ships),[t.ships]),d=c>t.maxCost,f=t.totalReinforcementCount>t.maxReinforcement,g=F.exports.useMemo(()=>{const o=ve(t);return Object.keys(o).map(m=>{const[$,h]=m.split("#"),S=ye($);switch(h){case"self":return`${S.name}\uFF1A${o[m]}`;case"ally":return`${S.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF21\uFF09\uFF1A${o[m]}`;case"ally2":return`${S.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF22\uFF09\uFF1A${o[m]}`;case"ally3":return`${S.name}\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF23\uFF09\uFF1A${o[m]}`;default:return`${S.name}\uFF1A${o[m]}`}})},[t]),A=d||f||g.length>0?e(V,{color:"error"}):e(z,{color:"primary"});return p(J,{expanded:n,onChange:()=>r(!n),children:[e(K,{expandIcon:n?e(ge,{}):A,children:p(v,{spacing:1,children:[e(a,{variant:"body1",children:t.name}),!n&&p("div",{children:[e(a,{variant:"body2",color:"text.secondary",component:"span",children:"\u5897\u63F4\uFF1A"}),e(a,{variant:"body2",color:"text.secondary",component:"span",sx:f?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`}),e(a,{variant:"body2",color:"text.secondary",component:"span",children:"\u3001\u53F8\u4EE4Pt\uFF1A"}),e(a,{variant:"body2",color:"text.secondary",component:"span",sx:d?{color:"red"}:{},children:`${c} / ${t.maxCost}`})]})]})}),e(X,{children:n&&e(Ee,{rows:[{key:"reinforcementCount",label:"\u5897\u63F4",value:e(a,{variant:"body2",sx:f?{color:"red"}:{},children:`${t.totalReinforcementCount} / ${t.maxReinforcement}`})},{key:"cost",label:"\u8266\u968A\u53F8\u4EE4Pt",value:e(a,{variant:"body2",sx:d?{color:"red"}:{},children:`${c} / ${t.maxCost}`})},{key:"shipCount",label:"\u8266\u8239",value:s>0?p(y,{children:[e(a,{variant:"body2",children:`\u5408\u8A08\u3000${s}`}),Object.keys(u).filter(o=>u[o]>0&&o!==C.CORVETTE&&o!==C.FIGHTER).map(o=>e(a,{variant:"body2",children:`${w(o)}\u3000${u[o]}`},o))]}):e(a,{variant:"body2",children:"-"})},{key:"carriedShipCount",label:"\u8266\u8F09\u6A5F",value:u[C.FIGHTER]+u[C.CORVETTE]>0?p(y,{children:[u[C.FIGHTER]>0&&e(a,{variant:"body2",children:`${w(C.FIGHTER)}\u3000${u[C.FIGHTER]}`}),u[C.CORVETTE]>0&&e(a,{variant:"body2",children:`${w(C.CORVETTE)}\u3000${u[C.CORVETTE]}`})]}):e(a,{variant:"body2",children:"-"})},{key:"rowCount",label:"\u914D\u7F6E",value:s>0?e(y,{children:Object.keys(l).filter(o=>o!==Se.NONE).map(o=>e(a,{variant:"body2",children:`${$e(o)}\u3000${l[o]}`},o))}):e(a,{variant:"body2",children:"-"})},...g.length>0?[{key:"warnings",label:"\u8B66\u544A",value:g.map((o,m)=>e(a,{variant:"body2",sx:{color:"red"},children:o},`warning_${m}`))}]:[]]})})]})},Y=i=>{const{shipSelections:t}=i,{openShipDetailDialog:n}=be();return e(v,{spacing:1,children:t==null?void 0:t.map(r=>{var c;return p(F.exports.Fragment,{children:[p(v,{spacing:1,direction:"row",children:[p(v,{spacing:1,direction:"row",flexWrap:"wrap",sx:{flexGrow:1},children:[e(E,{sx:{width:"25px"},children:e(a,{variant:"body2",textAlign:"end",children:`${r.count}\xD7`})}),e(a,{variant:"body2",children:e(W,{onClick:()=>{n(r.shipDefinition.id)},children:r.shipDefinition.name})}),r.reinforcement==="self"&&e(a,{variant:"body2",noWrap:!0,children:"\uFF08\u5897\u63F4\uFF09"}),r.reinforcement==="ally"&&e(a,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF21\uFF09"}),r.reinforcement==="ally2"&&e(a,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF22\uFF09"}),r.reinforcement==="ally3"&&e(a,{variant:"body2",noWrap:!0,children:"\uFF08\u30E6\u30CB\u30AA\u30F3\u5897\u63F4\uFF23\uFF09"})]}),e(E,{sx:{width:"50px"},children:r.reinforcement===null&&e(a,{variant:"body2",textAlign:"end",children:`${r.shipDefinition.cost*r.count} Pt`})})]}),r.carriedShips.map(s=>{var u;return p(v,{spacing:1,direction:"row",flexWrap:"wrap",children:[e(a,{variant:"body2",color:"text.secondary",sx:{paddingLeft:"30px",opacity:.5},children:"\u2517"}),e(E,{sx:{width:"25px"},children:e(a,{variant:"body2",textAlign:"end",children:`${s.count}\xD7`})}),e(a,{variant:"body2",children:e(W,{onClick:()=>{n(s.shipDefinition.id)},children:s.shipDefinition.name})})]},`${s.shipDefinition.id}_${(u=s.reinforcement)!=null?u:"initial"}`)})]},`${r.shipDefinition.id}_${(c=r.reinforcement)!=null?c:"initial"}`)})})},qe=i=>{const{fleetSetup:t,groupedShips:n,onClose:r}=i,[c,s]=F.exports.useState(!1),[u,l]=F.exports.useState(()=>Ce(t,n)),d=()=>{u&&Ae(u).then(()=>{s(!0)})},f=x=>{l(x.target.value)},g=()=>{r(),s(!1)};return e(De,{title:"\u5171\u6709",content:p(v,{spacing:1,children:[e(Z,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:f,rows:10,defaultValue:u,fullWidth:!0}),!!navigator.clipboard&&e(b,{variant:"outlined",startIcon:c?e(ee,{}):e(de,{}),onClick:d,fullWidth:!0,children:"\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u306B\u30B3\u30D4\u30FC"})]}),actions:e(b,{variant:"outlined",onClick:g,children:"\u9589\u3058\u308B"}),onClose:g})},rt=()=>{const i=te(),{fleetKey:t}=ne(),n=ae(),r=ue(n.breakpoints.up("lg")),[c,s]=F.exports.useState(!1),{fleetSetups:u,fleetSetup:l,switchFleet:d}=Oe({initialFleetKey:t!=null?t:null}),[f,g]=F.exports.useState(P.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME),x=F.exports.useMemo(()=>xe(f,l),[l,f]),A=()=>{i("/fleetSetup/edit/"+l.key)},o=()=>{s(!0)},m=()=>{s(!1)},$=r&&x.groupedBy===P.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME?"row":"column";return p(y,{children:[e(ie,{currentRoute:"/fleetSetup"}),e(Te,{fleetSetups:u,fleetSetup:l,grouping:f,onChangeFleet:d,onChangeGrouping:g,onEdit:A,onShare:o}),e(se,{disabled:$==="row",children:e(E,{p:1,children:p(v,{spacing:1,children:[e(Ye,{fleetSetup:l}),l.ships.length>0?e(y,{children:$==="row"?e(v,{spacing:1,direction:"row",sx:{width:"100%"},children:x.groups.map(h=>e(G,{sx:{width:`${100/x.groups.length}%`},children:e(E,{p:1,children:p(v,{spacing:1,children:[e(a,{variant:"body1",children:`${h.name}${h.count>0?`\uFF08${h.count}\u96BB\uFF09`:""}`}),e(re,{}),e(Y,{shipSelections:h.ships})]})})},h.id))}):e(Be,{expandables:x.groups.map(h=>({id:h.id,initiallyOpened:!0,summary:e(a,{variant:"body1",children:`${h.name}${h.count>0?`\uFF08${h.count}\u96BB\uFF09`:""}`}),details:e(Y,{shipSelections:h.ships}),skip:h.ships.length===0}))},x.groupedBy)}):e(G,{children:e(E,{p:2,children:p(v,{spacing:1,children:[e(a,{variant:"body1",children:"\u7DE8\u6210"}),e(oe,{severity:"info",children:"\u3053\u306E\u8266\u968A\u306B\u306F\u307E\u3060\u8266\u8239\u304C\u8FFD\u52A0\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002\u4E0A\u306E\u300C\u7DE8\u96C6\u300D\u30DC\u30BF\u30F3\u3067\u7DE8\u96C6\u30E2\u30FC\u30C9\u306B\u5207\u308A\u66FF\u3048\u308B\u3068\u8266\u8239\u306E\u8FFD\u52A0\u3084\u5897\u63F4\u306E\u8A2D\u5B9A\u7B49\u304C\u884C\u3048\u307E\u3059\u3002"})]})})}),e(a,{variant:"caption",align:"right",paragraph:!0,children:"\u203B\u8A2D\u5B9A\u30C7\u30FC\u30BF\u306F\u30D6\u30E9\u30A6\u30B6\u306E\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u306B\u4FDD\u5B58\u3055\u308C\u3066\u3044\u307E\u3059\u3002"})]})})}),c&&e(qe,{fleetSetup:l,groupedShips:x,onClose:m})]})};export{rt as FleetSetupPage,rt as default};
