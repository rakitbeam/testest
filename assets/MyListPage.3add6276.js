import{t as o,a as B,S as C,b as E,c as F,s as R,g as T,d as j,e as N,f as L,r as p,h as O,i as q,j as h,F as f,k as e,p as W,l as P,m as A,n as _,o as V,B as D,u as w,q as k,T as u,v as z,w as M,x as G,y as H,z as K}from"./index.17be86a6.js";import{d as J}from"./Settings.2a6d69a2.js";import{e as $,S as Q,c as X,a as Y,b as Z,d as ee,f as te}from"./ShipTypeFilterButton.9f397b29.js";import{A as ne}from"./ActionBar.7ce355b3.js";import{C as se,S as ae,c as ie}from"./ShipDataTable.4a75b7fb.js";import{d as oe,a as I,b as re,I as le,E as ce}from"./ExportDataDialog.44d8d33f.js";import{d as pe}from"./ConfirmationDialog.59fcf699.js";import{B as ue}from"./ButtonMenu.ee68ed99.js";import{n as de}from"./sorting.c6946657.js";import{E as he}from"./ExpandStack.111f71dd.js";import{R as me}from"./ResponsiveDialog.bd6c619c.js";import{T as ge}from"./TextField.6bd8f3de.js";import{N as ye,P as fe}from"./PageContent.3fdd2176.js";import{P as Se}from"./PageFooter.ebce7b1c.js";import"./domUtils.3220af31.js";import"./useFormControl.d62a9029.js";import"./useTable.75d37fec.js";import"./TableRow.84d95a53.js";import"./Download.6977c8d8.js";import"./DialogContentText.9ae2dfa9.js";import"./IconButton.7687540a.js";import"./Select.f918cb96.js";function U(a,t){const n=[],r=[],i=[],d=[],c=[];a.forEach(s=>{switch(s.row){case C.FRONT:{n.push(s);break}case C.MIDDLE:{r.push(s);break}case C.BACK:{i.push(s);break}default:switch(s.type){case F.CORVETTE:{d.push(s);break}case F.FIGHTER:{c.push(s);break}}}});const l=de([(s,m)=>R(s.type,s.subType)-R(m.type,m.subType),(s,m)=>T(s).localeCompare(T(m),j())]);return[o("label.acquiredShipsAndBlueprints"),[o("myList.groupNameForSharing",{name:B(C.FRONT)}),...n.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:B(C.MIDDLE)}),...r.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:B(C.BACK)}),...i.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(F.CORVETTE)}),...d.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(F.FIGHTER)}),...c.sort(l).map(s=>b(s,t))].join(`
`)].join(`

`)}function b(a,t){const n=N(a,t);return n.length===0?`\u3000${T(a)}`:[`\u3000${T(a)}`,n.map(r=>`\u3000\u2517 ${r.category}${r.categoryNumber} ${L(a.id,r)}`).join(`
`)].join(`
`)}const Ce=a=>{const{onCopyAsText:t,buttonProps:n}=a,[r,i]=p.exports.useState(!1),[d,c]=p.exports.useState(null),[l,s]=p.exports.useState(null),m=p.exports.useCallback(g=>{switch(g){case"copyAsText":{t();break}case"import":{s(q()),i(!0);break}case"export":{c(O());break}}},[]),S=p.exports.useCallback((g,x)=>{if(l===null){x();return}g(l)},[l]);return h(f,{children:[e(ue,{icon:e(oe,{}),text:o("button.share"),value:void 0,buttonProps:n,onClick:m,options:[{key:"copyAsText",icon:e(I,{}),text:o("label.copyAsText"),value:"copyAsText"},{key:"export",icon:e(pe,{}),text:o("label.dataExport"),value:"export"},{key:"import",icon:e(re,{}),text:o("label.dataImport"),value:"import"}]}),r&&e(le,{confirmDialogTitle:o("myList.importConfirmTitle"),confirmWarning:o("myList.importConfirmWarning"),createPreview:be,parseInput:W,canRestore:!!l,onImport:xe,onClose:()=>i(!1),onSelectFile:Fe,onRestoreFromBackup:S}),d&&e(ce,{fileName:"settings",jsonContent:d,onClose:()=>c(null),onStoreBackup:P})]})};function be(a){const t=$(A,a.ships);return U(t,a)}function xe(a){_(a),setTimeout(()=>{window.location.reload()},0)}function Fe(a,t){(async()=>{const n=await V();if(n===null){t();return}a(n)})()}const ve=a=>{const{shipFilter:t,columnConfig:n,onEdit:r,onFilter:i,onCopyAsText:d,onColumnConfigChange:c}=a;return e(ne,{left:l=>h(f,{children:[e(se,{columnConfig:n,onChange:c,disableResearchAgreementOptions:!0,buttonProps:l},"columnConfig"),e(Q,{filter:t,onChange:i,researchManufacturer:!1,researchStrategyTypes:!1,researchTacticTypes:!1,buttonProps:l},"filter"),e(D,{variant:"outlined",startIcon:e(J,{}),onClick:r,...l,children:o("myList.editMyList")},"edit")]}),right:l=>e(f,{children:e(Ce,{onCopyAsText:d,buttonProps:l})})})},Te=a=>{const{ship:t}=a,{userSettings:n}=w(),r=p.exports.useMemo(()=>N(t,n),[t,n]);return r.length===0?null:e(k,{component:"div",mt:.5,children:r.map(i=>h(u,{variant:"body2",color:"text.secondary",children:[e(u,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${i.category}${i.categoryNumber} ${L(t.id,i)}`]},i.id))})},we=a=>{const{ship:t}=a,{userSettings:n}=w(),r=p.exports.useMemo(()=>z(t,n),[t,n]);return r.length===0?null:e(k,{component:"div",mt:.5,children:r.map(i=>h(u,{variant:"body2",color:"text.secondary",children:[e(u,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${i.category}${i.categoryNumber} ${L(t.id,i)}`]},i.id))})},v=p.exports.memo(ae),ke=a=>{const{shipListState:t,columnConfig:n}=a;return h(M,{spacing:1,children:[e(he,{expandables:[{id:"possessed-ships",initiallyOpened:!0,summary:e(u,{variant:"body1",children:o("label.acquiredShipsAndBlueprints")}),details:e(v,{shipDefinitions:t.possessed,columnConfig:n,decorateName:(r,i)=>h(f,{children:[r,e(Te,{ship:i})]})})},{id:"wished-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("label.wantedBlueprints")}),details:e(v,{shipDefinitions:t.wished,columnConfig:n,decorateName:(r,i)=>h(f,{children:[r,e(we,{ship:i})]})})},{id:"unwished-by-user-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("label.unwantedBlueprints")}),details:e(v,{shipDefinitions:t.unwishedByUser,columnConfig:n})},{id:"unwished-by-data-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("myList.unwantedDuplicates")}),details:h(f,{children:[e(v,{shipDefinitions:t.unwishedByData,columnConfig:n}),e(k,{component:"div",pt:1,children:e(u,{variant:"caption",align:"right",paragraph:!0,children:o("myList.unwantedDuplicatesFootnote")})})]})}]}),e(u,{variant:"caption",align:"right",paragraph:!0,children:o("myList.pageFootnote")})]})},Be=a=>{const{ships:t,onClose:n}=a,[r,i]=p.exports.useState(!1),{userSettings:d}=w(),[c,l]=p.exports.useState(()=>U(t.possessed,d)),s=()=>{c&&H(c).then(()=>{i(!0)})},m=g=>{l(g.target.value)},S=()=>{n(),i(!1)};return e(me,{title:o("button.share"),content:h(M,{spacing:1,children:[e(ge,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:m,rows:10,defaultValue:c,fullWidth:!0}),!!navigator.clipboard&&e(D,{variant:"outlined",startIcon:r?e(G,{}):e(I,{}),onClick:s,fullWidth:!0,children:o("button.copyToClipboard")})]}),actions:e(D,{variant:"outlined",onClick:S,children:o("button.close")}),onClose:S})},Qe=()=>{const a=K(),{userSettings:t}=w(),[n,r]=p.exports.useState(X),[i,d]=p.exports.useState(null),[c,l]=p.exports.useState(()=>ie({name:!0,row:!0,type:!0,cost:!1,operationLimit:!1})),s=p.exports.useMemo(()=>{const y=Y(A,n);return{possessed:$(y,t.ships),wished:Z(y,t),unwishedByUser:ee(y,t.ships),unwishedByData:te(y,t)}},[t,n]),m=()=>{a("/myList/edit")},S=()=>{d(s)},g=()=>{d(null)},x=Object.values(c).filter(y=>typeof y=="boolean"&&y).length>3;return h(f,{children:[e(ye,{currentRoute:"/myList"}),e(ve,{shipFilter:n,columnConfig:c,onEdit:m,onFilter:r,onCopyAsText:S,onColumnConfigChange:l}),e(fe,{disableContainer:x,children:h(k,{component:"div",p:1,children:[h(M,{pt:1,pb:2,spacing:2,children:[e(u,{variant:"body2",children:o("myList.pageDescription1")}),e(u,{variant:"body2",children:o("myList.pageDescription2")}),e(u,{variant:"body2",children:o("myList.pageDescription3")})]}),e(ke,{shipListState:s,columnConfig:c})]})}),i&&e(Be,{ships:i,onClose:g}),e(Se,{disableContainer:x})]})};export{Qe as MyListPage,Qe as default};
