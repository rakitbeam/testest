import{q as ae,v as ie,E as $,j as l,w as k,a4 as Z,D as J,aV as z,aU as P,_ as I,r as F,I as se,y as ce,A as le,a as N,C as ue,F as Q,B as de,J as pe,K as fe,L as me,t as u,i as y,h as ge,f as C,e as ye,k as h,l as he,s as U,bp as Ce,c as ve,O as S,bx as j,by as x,Q as Re}from"./index.1802e277.js";import{I as Me,G as xe,M as _e,a as Ae,L as Be}from"./PageContent.c26f802a.js";import{B as Ee,g as Te,C as Se,L as De}from"./domUtils.b58e4008.js";import{P as $e}from"./useFormControl.7ef3b033.js";import{n as X}from"./sorting.c6946657.js";function Ie(e){return ae("MuiAlert",e)}const Oe=ie("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);var G=Oe,ke=$(l("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Fe=$(l("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Ne=$(l("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Le=$(l("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),be=$(l("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),H;const we=["action","children","className","closeText","color","icon","iconMapping","onClose","role","severity","variant"],Ye=e=>{const{variant:r,color:n,severity:o,classes:t}=e,a={root:["root",`${r}${J(n||o)}`,`${r}`],icon:["icon"],message:["message"],action:["action"]};return le(a,Ie,t)},ze=k(Z,{name:"MuiAlert",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:n}=e;return[r.root,r[n.variant],r[`${n.variant}${J(n.color||n.severity)}`]]}})(({theme:e,ownerState:r})=>{const n=e.palette.mode==="light"?z:P,o=e.palette.mode==="light"?P:z,t=r.color||r.severity;return I({},e.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},t&&r.variant==="standard"&&{color:e.vars?e.vars.palette.Alert[`${t}Color`]:n(e.palette[t].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${t}StandardBg`]:o(e.palette[t].light,.9),[`& .${G.icon}`]:e.vars?{color:e.vars.palette.Alert[`${t}IconColor`]}:{color:e.palette.mode==="dark"?e.palette[t].main:e.palette[t].light}},t&&r.variant==="outlined"&&{color:e.vars?e.vars.palette.Alert[`${t}Color`]:n(e.palette[t].light,.6),border:`1px solid ${(e.vars||e).palette[t].light}`,[`& .${G.icon}`]:e.vars?{color:e.vars.palette.Alert[`${t}IconColor`]}:{color:e.palette.mode==="dark"?e.palette[t].main:e.palette[t].light}},t&&r.variant==="filled"&&I({fontWeight:e.typography.fontWeightMedium},e.vars?{color:e.vars.palette.Alert[`${t}FilledColor`],backgroundColor:e.vars.palette.Alert[`${t}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[t].dark:e.palette[t].main,color:e.palette.getContrastText(e.palette.mode==="dark"?e.palette[t].dark:e.palette[t].main)}))}),Pe=k("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,r)=>r.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Ue=k("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,r)=>r.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),W=k("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,r)=>r.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),V={success:l(ke,{fontSize:"inherit"}),warning:l(Fe,{fontSize:"inherit"}),error:l(Ne,{fontSize:"inherit"}),info:l(Le,{fontSize:"inherit"})},je=F.exports.forwardRef(function(r,n){const o=se({props:r,name:"MuiAlert"}),{action:t,children:a,className:i,closeText:s="Close",color:c,icon:d,iconMapping:p=V,onClose:f,role:v="alert",severity:m="success",variant:R="standard"}=o,oe=ce(o,we),M=I({},o,{color:c,severity:m,variant:R}),A=Ye(M);return N(ze,I({role:v,elevation:0,ownerState:M,className:ue(A.root,i),ref:n},oe,{children:[d!==!1?l(Pe,{ownerState:M,className:A.icon,children:d||p[m]||V[m]}):null,l(Ue,{ownerState:M,className:A.message,children:a}),t!=null?l(W,{ownerState:M,className:A.action,children:t}):null,t==null&&f?l(W,{ownerState:M,className:A.action,children:l(Me,{size:"small","aria-label":s,title:s,color:"inherit",onClick:f,children:H||(H=l(be,{fontSize:"small"}))})}):null]}))});var lt=je;const Ge=e=>{const{options:r,icon:n,text:o,value:t,onClick:a,buttonProps:i}=e,[s,c]=F.exports.useState(!1),d=F.exports.useRef(null),p=f=>{c(!1),a(f)};return N(Q,{children:[l(Ee,{variant:"outlined",fullWidth:i==null?void 0:i.fullWidth,ref:d,disabled:i==null?void 0:i.disabled,size:i==null?void 0:i.size,children:l(de,{startIcon:n,onClick:f=>{f.stopPropagation(),c(!0)},disabled:i==null?void 0:i.disabled,children:o})}),l($e,{open:s,anchorEl:d.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:2},children:({TransitionProps:f,placement:v})=>l(xe,{...f,style:{transformOrigin:v==="bottom"?"center top":"center bottom"},children:l(Z,{style:{maxHeight:Te(d.current),overflowY:"auto"},children:l(Se,{onClickAway:()=>c(!1),children:l(_e,{children:r.map(m=>N(Ae,{selected:m.value===t,onClick:R=>{R.stopPropagation(),p(m.value)},disabled:m.disabled,children:[m.icon&&l(De,{children:m.icon}),l(Be,{children:m.text})]},m.key))})})})})})]})};var Y={},He=fe.exports;Object.defineProperty(Y,"__esModule",{value:!0});var ee=Y.default=void 0,We=He(pe),Ve=me,qe=(0,We.default)((0,Ve.jsx)("path",{d:"M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"}),"Sort");ee=Y.default=qe;var g=(e=>(e.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME="groupByRowSortByTypeAndName",e.GROUP_BY_TYPE_SORT_BY_NAME="groupByTypeSortByName",e.SORT_BY_TYPE_AND_NAME="sortByTypeAndName",e.SORT_BY_NAME="sortByName",e))(g||{});const q={initial:0,self:1,ally:2,ally2:3,ally3:4},te=(e,r)=>{var n,o;return q[(n=e.reinforcement)!=null?n:"initial"]-q[(o=r.reinforcement)!=null?o:"initial"]},D=X([(e,r)=>h(e.shipDefinition).localeCompare(h(r.shipDefinition),he()),te]),O=X([(e,r)=>U(e.shipDefinition.type,e.shipDefinition.subType)-U(r.shipDefinition.type,r.shipDefinition.subType),D,te]);function ut(e,r){switch(e){case"groupByRowSortByTypeAndName":return{groupedBy:e,groups:Ke(r.ships)};case"groupByTypeSortByName":return{groupedBy:e,groups:Ze(r.ships)};case"sortByTypeAndName":return{groupedBy:e,groups:[{id:"all",name:u("fleetSetup.fleetFormation"),ships:r.ships.map(n=>({...n,carriedShips:[...n.carriedShips].sort(O)})).sort(O),count:r.ships.map(n=>n.count).reduce((n,o)=>n+o,0)}]};case"sortByName":return{groupedBy:e,groups:[{id:"all",name:u("fleetSetup.fleetFormation"),ships:r.ships.map(n=>({...n,carriedShips:[...n.carriedShips].sort(D)})).sort(D),count:r.ships.map(n=>n.count).reduce((n,o)=>n+o,0)}]};default:throw new Error(`Unknown group and sort option "${e}"`)}}function Ke(e){return[C.FRONT,C.MIDDLE,C.BACK].map(r=>{const n=e.filter(t=>t.shipDefinition.row===r).map(t=>({...t,carriedShips:[...t.carriedShips].sort(O)})).sort(O),o=n.map(t=>t.count).reduce((t,a)=>t+a,0);return{id:r,name:ye(r),ships:n,count:o}})}function Ze(e){return[y.CARRIER,y.AUXILIARY,y.BATTLE_CRUISER,y.CRUISER,y.DESTROYER,y.FRIGATE].map(r=>{const n=e.filter(t=>t.shipDefinition.type===r).map(t=>({...t,carriedShips:[...t.carriedShips].sort(D)})).sort(D),o=n.map(t=>t.count).reduce((t,a)=>t+a,0);return{id:r,name:ge(r),ships:n,count:o}})}function dt(e,r){const n=Ce()?" ":"";return[e.name,r.groups.filter(o=>o.ships.length>0).map(o=>[...r.groups.length>1?[u("fleetSetup.groupNameForSharing",{name:o.name})]:[],...o.ships.flatMap(t=>{const a=t.count*t.shipDefinition.cost,i=Je(t);switch(t.reinforcement){case"self":return[`${_(t.count)}\xD7\u3000${h(t.shipDefinition)}${n}${u("fleetSetup.reinforcementBrackets")}`,...i?[i]:[],...B(t.carriedShips)];case"ally":return[`${_(t.count)}\xD7\u3000${h(t.shipDefinition)}${n}${u("fleetSetup.orgReinforcementABrackets")}`,...i?[i]:[],...B(t.carriedShips)];case"ally2":return[`${_(t.count)}\xD7\u3000${h(t.shipDefinition)}${n}${u("fleetSetup.orgReinforcementBBrackets")}`,...i?[i]:[],...B(t.carriedShips)];case"ally3":return[`${_(t.count)}\xD7\u3000${h(t.shipDefinition)}${n}${u("fleetSetup.orgReinforcementCBrackets")}`,...i?[i]:[],...B(t.carriedShips)];default:return[`${_(t.count)}\xD7\u3000${h(t.shipDefinition)}${n}${u("fleetSetup.commandPointsValueBrackets",{value:a})}`,...i?[i]:[],...B(t.carriedShips)]}})].join(`
`)).join(`

`),[`${u("fleetSetup.reinforcementColon")}${n}${e.totalReinforcementCount}/${e.maxReinforcement}`,`${u("label.commandPointsColon")}${n}${e.totalCost}/${e.maxCost}`].join(`
`)].join(`

`)}function B(e){return e.map(r=>`\u3000\u3000 ${_(r.count)}\xD7\u3000${h(r.shipDefinition)}`)}function Je(e){if(e.moduleSelection===null||e.moduleSelection.static)return null;const r=["M","A","B","C"].flatMap(n=>{var i,s,c;const t=Object.keys((s=(i=e.moduleSelection)==null?void 0:i.groups[n])!=null?s:{}).find(d=>{var p;return((p=e.moduleSelection)==null?void 0:p.groups[n][d].usage)==="used"});if(!t)return[];const a=(c=e.moduleSelection)==null?void 0:c.groups[n][t];return!a||a.module.defaultModule?[]:a?[`${ve(e.shipDefinition.id,a.module)}\uFF08${a.module.id}\uFF09`]:[]});return r.length===0?null:r.map(n=>`\u3000\u3000 ${n}`).join(`
`)}function _(e){return e<10?`${e}`.padStart(3):`${e}`}const pt=e=>{const{value:r,onChange:n,buttonProps:o}=e;return l(Q,{children:l(Ge,{icon:l(ee,{}),text:u("button.displayItems"),value:r,options:[{key:g.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME,text:u("fleetSetup.groupByRowSortByShipTypeAndName"),value:g.GROUP_BY_ROW_SORT_BY_TYPE_AND_NAME},{key:g.GROUP_BY_TYPE_SORT_BY_NAME,text:u("fleetSetup.groupByShipTypeSortByName"),value:g.GROUP_BY_TYPE_SORT_BY_NAME},{key:g.SORT_BY_TYPE_AND_NAME,text:u("fleetSetup.sortByShipTypeAndName"),value:g.SORT_BY_TYPE_AND_NAME},{key:g.SORT_BY_NAME,text:u("fleetSetup.sortByName"),value:g.SORT_BY_NAME}],onClick:n,buttonProps:o})})};function ft(){var e,r,n,o,t;return[(e=E("fleet1"))!=null?e:T(1),(r=E("fleet2"))!=null?r:T(2),(n=E("fleet3"))!=null?n:T(3),(o=E("fleet4"))!=null?o:T(4),(t=E("fleet5"))!=null?t:T(5)]}function mt(e){const r=JSON.stringify(Xe(e));window.localStorage.setItem(e.key,r)}function E(e){const r=window.localStorage.getItem(e);if(!r)return null;const n=rt(r);return n?Qe(et(n),e):null}function Qe(e,r){const n=e.myListOnly===!0,o=e.ships.map(t=>{var a;return{...re({shipDefinition:S(t.shipId),usedModules:(a=t.usedModules)!=null?a:null,count:t.count,reinforcement:t.reinforcement,maxReinforcement:e.maxReinforcement}),carriedShips:t.carriedShips.map(i=>ne({shipId:i.shipId,count:i.count,reinforcement:t.reinforcement}))}});return{key:r,name:e.name,ships:o,totalCost:b(o),totalReinforcementCount:w(o),maxReinforcement:e.maxReinforcement,maxCost:e.maxCost,myListOnly:n}}function Xe(e){return{name:e.name,ships:e.ships.map(r=>({shipId:r.shipDefinition.id,usedModules:r.moduleSelection?tt(r.moduleSelection):void 0,carriedShips:r.carriedShips.map(n=>({shipId:n.shipDefinition.id,count:n.count})),count:r.count,reinforcement:r.reinforcement})),maxReinforcement:e.maxReinforcement,maxCost:e.maxCost,myListOnly:e.myListOnly}}function et(e){const r=e.ships.reduce((o,t)=>{const a=j(t.shipId),i=S(a);if(!i)return o;let s;t.usedModules&&i.modules&&(s=t.usedModules.filter(d=>{var p;return!!((p=i.modules)!=null&&p.find(f=>f.id===d))}));const c=t.carriedShips.flatMap(d=>{const p=j(d.shipId);return S(p)?[{...d,shipId:p}]:[]});return[...o,{...t,shipId:a,usedModules:s,carriedShips:c}]},[]);return{...e,ships:r}}function tt(e){const r=[];return Object.keys(e.groups).forEach(n=>{Object.keys(e.groups[n]).forEach(o=>{e.groups[n][o].usage==="used"&&r.push(e.groups[n][o].module.id)})}),r}function rt(e){try{return JSON.parse(e)}catch(r){return alert("ERROR - Failed to restore fleet setup"),console.error(r),null}}function T(e){return{key:`fleet${e}`,name:u("fleetSetup.defaultFleetNameWithNumber",{fleetNumber:e}),ships:[],totalCost:0,totalReinforcementCount:0,maxReinforcement:5,maxCost:400,myListOnly:!0}}function re(e){const{shipDefinition:r,usedModules:n,count:o,reinforcement:t,maxReinforcement:a,temporary:i}=e,s=nt(r,n),c=L(r,s),d=t===null||r.type===y.FIGHTER||r.type===y.CORVETTE?r.operationLimit:Math.min(r.operationLimit,a);return{shipDefinition:r,carrierCapabilities:c,carriedShips:[],count:Math.max(0,o),reinforcement:t,maxCount:d,moduleSelection:s,temporary:i}}function nt(e,r){if(!e.modules||e.modules.length===0)return null;const n=r!=null?r:e.modules.filter(t=>t.defaultModule).map(t=>t.id),o={static:e.staticModules===!0,groups:{}};return e.modules.forEach(t=>{if(o.groups[t.category]||(o.groups[t.category]={}),o.static){o.groups[t.category][t.id]={module:t,usage:"used"};return}o.groups[t.category][t.id]={module:t,usage:n.includes(t.id)?"used":"not_used"}}),o}function L(e,r){var i;let n=0,o=0,t=0,a=(i=e.carryCorvette)!=null?i:0;if(e.carryFighter)switch(e.carryFighterType){case x.LARGE_FIGHTER:{n+=e.carryFighter;break}case x.MEDIUM_FIGHTER:{o+=e.carryFighter;break}case x.SMALL_FIGHTER:{t+=e.carryFighter;break}}return r&&Object.keys(r.groups).forEach(s=>{var c;Object.keys((c=r.groups[s])!=null?c:{}).forEach(d=>{var f,v,m,R;const p=r.groups[s][d];if(p.usage==="used"){switch(p.module.carryFighterType){case x.LARGE_FIGHTER:{n+=(f=p.module.carryFighter)!=null?f:0;break}case x.MEDIUM_FIGHTER:{o+=(v=p.module.carryFighter)!=null?v:0;break}case x.SMALL_FIGHTER:{t+=(m=p.module.carryFighter)!=null?m:0;break}}a+=(R=p.module.carryCorvette)!=null?R:0}})}),{canCarry:n+o+t+a>0,carryUpToLargeFighter:n,carryUpToMediumFighter:o,carryUpToSmallFighter:t,carryCorvette:a}}function ne(e){const{shipId:r,count:n,reinforcement:o,temporary:t}=e;return{shipDefinition:S(r),count:Math.max(0,n),reinforcement:o,temporary:t}}function gt(e){const{shipId:r,count:n,reinforcement:o,fleetSetup:t,keepZero:a}=e,i=S(r);let s=!0;const c={...t,ships:t.ships.flatMap(d=>d.shipDefinition.id!==r||d.reinforcement!==o?d:(s=!1,!a&&n<=0?[]:[{...d,count:n}]))};return s?{...c,ships:[...c.ships,re({shipDefinition:i,usedModules:null,count:n,reinforcement:o,maxReinforcement:t.maxReinforcement})],totalCost:b(c.ships),totalReinforcementCount:w(c.ships)}:{...c,totalCost:b(c.ships),totalReinforcementCount:w(c.ships)}}function yt(e){const{shipId:r,carrierShipId:n,count:o,reinforcement:t,fleetSetup:a,keepZero:i}=e;return{...a,ships:a.ships.map(s=>s.shipDefinition.id!==n||s.reinforcement!==t?s:s.carriedShips.find(c=>c.shipDefinition.id===r)?{...s,carriedShips:s.carriedShips.flatMap(c=>{if(c.shipDefinition.id!==r)return[c];if(c.reinforcement!==t)throw new Error("Detected invalid reinforcement");return!i&&o<=0?[]:[{...c,count:Math.max(0,o),reinforcement:t}]})}:{...s,carriedShips:[...s.carriedShips,ne({shipId:r,count:o,reinforcement:t})]})}}function ht(e){const{shipId:r,reinforcement:n,moduleSelection:o,fleetSetup:t}=e;return{...t,ships:t.ships.map(a=>a.shipDefinition.id!==r?a:n!=null&&n.includes("ally")?a.reinforcement===n?{...a,moduleSelection:o,carrierCapabilities:L(a.shipDefinition,o)}:a:!a.reinforcement||!a.reinforcement.includes("ally")?{...a,moduleSelection:o,carrierCapabilities:L(a.shipDefinition,o)}:a)}}function Ct(e,r,n){return{...n,groups:{...n.groups,[e]:Object.keys(n.groups[e]).reduce((o,t)=>{const a=n.groups[e][t];return{...o,[t]:t===r?{...a,usage:"used"}:{...a,usage:"not_used"}}},n.groups[e])}}}function b(e){return e.filter(r=>r.reinforcement===null).map(r=>r.count*r.shipDefinition.cost).reduce((r,n)=>r+n,0)}function w(e){return e.filter(r=>r.reinforcement!==null).map(r=>r.count).reduce((r,n)=>r+n,0)}function vt(e){let r=0;const n=e.map(a=>a.count).reduce((a,i)=>a+i,0),o=Object.keys(Re).reduce((a,i)=>({...a,[i]:0}),{}),t={[C.FRONT]:0,[C.MIDDLE]:0,[C.BACK]:0,[C.NONE]:0};return e.forEach(a=>{a.reinforcement===null&&(r+=a.count*a.shipDefinition.cost),o[a.shipDefinition.type]+=a.count,t[a.shipDefinition.row]+=a.count,a.carriedShips.length>0&&a.carriedShips.forEach(i=>{o[i.shipDefinition.type]+=i.count})}),{shipCount:n,shipCountByType:o,shipCountByRow:t,totalCost:r}}function Rt(e){var n,o;const r={};return e.name.length===0&&(r.name=u("validation.requiredField")),(!Number.isFinite(e.maxReinforcement)||e.maxReinforcement<0)&&(r.maxReinforcement=u("validation.invalidValue")),(!Number.isFinite(e.maxCost)||e.maxCost<300||e.maxCost>450)&&(r.maxCost=u("validation.invalidValue")),e.maxCost>400&&e.maxReinforcement>5&&(r.maxReinforcement=(n=r.maxReinforcement)!=null?n:u("fleetSetup.maxOneDockingEffect"),r.maxCost=(o=r.maxCost)!=null?o:u("fleetSetup.maxOneDockingEffect")),r}function Mt(e){const r={},n={},o={};return e.ships.forEach(t=>{const a=K(t.shipDefinition.id,t.reinforcement);if(n[a]){const i=n[a];n[a]={count:t.reinforcement===null?t.count:i.count,reinforcementCount:t.reinforcement!==null?t.count:i.reinforcementCount,operationLimit:t.shipDefinition.operationLimit}}else n[a]={count:t.reinforcement===null?t.count:0,reinforcementCount:t.reinforcement!==null?t.count:0,operationLimit:t.shipDefinition.operationLimit};t.carriedShips.forEach(i=>{const s=K(i.shipDefinition.id,t.reinforcement);o[s]?o[s].count+=i.count:o[s]={count:i.count,operationLimit:i.shipDefinition.operationLimit}})}),Object.keys(n).forEach(t=>{const a=n[t];a.count+a.reinforcementCount>a.operationLimit&&(r[t]=u("fleetSetup.exceedingTotalOperationLimit"))}),Object.keys(o).forEach(t=>{const a=o[t];a.count>a.operationLimit&&(r[t]=u("fleetSetup.exceedingTotalOperationLimit"))}),r}function K(e,r){const n=r!=null&&r.includes("ally")?r:"self";return`${e}#${n}`}export{lt as A,Ge as B,g as G,pt as S,vt as a,ut as b,gt as c,yt as d,ht as e,dt as f,ft as g,T as h,Rt as i,re as j,Ct as k,K as l,ne as m,mt as s,Mt as v};
