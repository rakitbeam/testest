import{t as o,a as k,S as f,b as A,c as x,s as N,g as w,d as I,e as R,f as B,r as d,h as $,i as U,o as q,j as P,k as u,F as g,l as e,m as W,n as v,B as C,T as p,p as D,u as F,q as _,v as V,w as z,x as G}from"./index.df824086.js";import{d as H}from"./Settings.765b9069.js";import{e as E,S as K,c as J,a as Q,b as X,d as Y,f as Z}from"./ShipTypeFilterButton.1dea46b6.js";import{A as ee}from"./ActionBar.fa92aca2.js";import{C as te,S as ie,c as ne}from"./ShipDataTable.04a70647.js";import{d as ae,a as j,b as se}from"./FileOpen.f7ebb4f7.js";import{d as oe,C as re}from"./ConfirmationDialog.801ded58.js";import{B as le}from"./ButtonMenu.3fec13e2.js";import{n as ce}from"./sorting.c6946657.js";import{A as pe,T as de}from"./TextField.8ef0655d.js";import{E as ue}from"./ExpandStack.baef4d25.js";import{R as he}from"./ResponsiveDialog.ae3e78b8.js";import{N as me,P as ye}from"./PageContent.e0cf103f.js";import{P as ge}from"./PageFooter.3068850e.js";import"./domUtils.998fc3f8.js";import"./useFormControl.be6cd742.js";import"./useTable.d8655044.js";import"./TableRow.3b62bc44.js";import"./DialogContentText.6a1f9cfa.js";import"./Select.d4086412.js";function O(r,t){const s=[],i=[],a=[],h=[],c=[];r.forEach(n=>{switch(n.row){case f.FRONT:{s.push(n);break}case f.MIDDLE:{i.push(n);break}case f.BACK:{a.push(n);break}default:switch(n.type){case x.CORVETTE:{h.push(n);break}case x.FIGHTER:{c.push(n);break}}}});const l=ce([(n,m)=>N(n.type,n.subType)-N(m.type,m.subType),(n,m)=>w(n).localeCompare(w(m),I())]);return[o("label.acquiredShipsAndBlueprints"),[o("myList.groupNameForSharing",{name:k(f.FRONT)}),...s.sort(l).map(n=>S(n,t))].join(`
`),[o("myList.groupNameForSharing",{name:k(f.MIDDLE)}),...i.sort(l).map(n=>S(n,t))].join(`
`),[o("myList.groupNameForSharing",{name:k(f.BACK)}),...a.sort(l).map(n=>S(n,t))].join(`
`),[o("myList.groupNameForSharing",{name:A(x.CORVETTE)}),...h.sort(l).map(n=>S(n,t))].join(`
`),[o("myList.groupNameForSharing",{name:A(x.FIGHTER)}),...c.sort(l).map(n=>S(n,t))].join(`
`)].join(`

`)}function S(r,t){const s=R(r,t);return s.length===0?`\u3000${w(r)}`:[`\u3000${w(r)}`,s.map(i=>`\u3000\u2517 ${i.category}${i.categoryNumber} ${B(r.id,i)}`).join(`
`)].join(`
`)}const fe=r=>{const{onCopyAsText:t,buttonProps:s}=r,[i,a]=d.exports.useState(null),h=d.exports.useMemo(()=>{if(!i)return null;const n=E($,i.ships);return O(n,i)},[i]),c=d.exports.useCallback(n=>{switch(n){case"copyAsText":{t();break}case"import":{(async()=>{const m=await q();m&&a(m)})();break}case"export":{U();break}}},[]),l=d.exports.useCallback(()=>{i&&(P(i),a(null),window.location.reload())},[i]);return u(g,{children:[e(le,{icon:e(ae,{}),text:o("button.share"),value:void 0,buttonProps:s,onClick:c,options:[{key:"copyAsText",icon:e(j,{}),text:o("label.copyAsText"),value:"copyAsText"},{key:"export",icon:e(oe,{}),text:o("label.exportToFile"),value:"export"},{key:"import",icon:e(se,{}),text:o("label.importFromFile"),value:"import",disabled:!W()}]}),i&&e(re,{title:o("myList.importConfirmTitle"),question:u(v,{children:[e(pe,{severity:"warning",children:o("myList.importConfirmWarning")}),e(C,{p:1,children:e(p,{variant:"body2",component:"div",children:e("pre",{children:h})})})]}),onConfirm:l,onCancel:()=>a(null)})]})},Se=r=>{const{shipFilter:t,columnConfig:s,onEdit:i,onFilter:a,onCopyAsText:h,onColumnConfigChange:c}=r;return e(ee,{left:l=>u(g,{children:[e(te,{columnConfig:s,onChange:c,disableResearchAgreementOptions:!0,buttonProps:l},"columnConfig"),e(K,{filter:t,onChange:a,researchManufacturer:!1,researchStrategyTypes:!1,researchTacticTypes:!1,buttonProps:l},"filter"),e(D,{variant:"outlined",startIcon:e(H,{}),onClick:i,...l,children:o("myList.editMyList")},"edit")]}),right:l=>e(g,{children:e(fe,{onCopyAsText:h,buttonProps:l})})})},Ce=r=>{const{ship:t}=r,{userSettings:s}=F(),i=d.exports.useMemo(()=>R(t,s),[t,s]);return i.length===0?null:e(C,{mt:.5,children:i.map(a=>u(p,{variant:"body2",color:"text.secondary",children:[e(p,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${a.category}${a.categoryNumber} ${B(t.id,a)}`]},a.id))})},be=r=>{const{ship:t}=r,{userSettings:s}=F(),i=d.exports.useMemo(()=>_(t,s),[t,s]);return i.length===0?null:e(C,{mt:.5,children:i.map(a=>u(p,{variant:"body2",color:"text.secondary",children:[e(p,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${a.category}${a.categoryNumber} ${B(t.id,a)}`]},a.id))})},T=d.exports.memo(ie),xe=r=>{const{shipListState:t,columnConfig:s}=r;return u(v,{spacing:1,children:[e(ue,{expandables:[{id:"possessed-ships",initiallyOpened:!0,summary:e(p,{variant:"body1",children:o("label.acquiredShipsAndBlueprints")}),details:e(T,{shipDefinitions:t.possessed,columnConfig:s,decorateName:(i,a)=>u(g,{children:[i,e(Ce,{ship:a})]})})},{id:"wished-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("label.wantedBlueprints")}),details:e(T,{shipDefinitions:t.wished,columnConfig:s,decorateName:(i,a)=>u(g,{children:[i,e(be,{ship:a})]})})},{id:"unwished-by-user-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("label.unwantedBlueprints")}),details:e(T,{shipDefinitions:t.unwishedByUser,columnConfig:s})},{id:"unwished-by-data-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("myList.unwantedDuplicates")}),details:u(g,{children:[e(T,{shipDefinitions:t.unwishedByData,columnConfig:s}),e(C,{pt:1,children:e(p,{variant:"caption",align:"right",paragraph:!0,children:o("myList.unwantedDuplicatesFootnote")})})]})}]}),e(p,{variant:"caption",align:"right",paragraph:!0,children:o("myList.pageFootnote")})]})},Te=r=>{const{ships:t,onClose:s}=r,[i,a]=d.exports.useState(!1),{userSettings:h}=F(),[c,l]=d.exports.useState(()=>O(t.possessed,h)),n=()=>{c&&z(c).then(()=>{a(!0)})},m=L=>{l(L.target.value)},b=()=>{s(),a(!1)};return e(he,{title:o("button.share"),content:u(v,{spacing:1,children:[e(de,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:m,rows:10,defaultValue:c,fullWidth:!0}),!!navigator.clipboard&&e(D,{variant:"outlined",startIcon:i?e(V,{}):e(j,{}),onClick:n,fullWidth:!0,children:o("button.copyToClipboard")})]}),actions:e(D,{variant:"outlined",onClick:b,children:o("button.close")}),onClose:b})},_e=()=>{const r=G(),{userSettings:t}=F(),[s,i]=d.exports.useState(J),[a,h]=d.exports.useState(null),[c,l]=d.exports.useState(()=>ne({name:!0,row:!0,type:!0,cost:!1,operationLimit:!1})),n=d.exports.useMemo(()=>{const y=Q($,s);return{possessed:E(y,t.ships),wished:X(y,t),unwishedByUser:Y(y,t.ships),unwishedByData:Z(y,t)}},[t,s]),m=()=>{r("/myList/edit")},b=()=>{h(n)},L=()=>{h(null)},M=Object.values(c).filter(y=>typeof y=="boolean"&&y).length>3;return u(g,{children:[e(me,{currentRoute:"/myList"}),e(Se,{shipFilter:s,columnConfig:c,onEdit:m,onFilter:i,onCopyAsText:b,onColumnConfigChange:l}),e(ye,{disableContainer:M,children:u(C,{p:1,children:[u(v,{pt:1,pb:2,spacing:2,children:[e(p,{variant:"body2",children:o("myList.pageDescription1")}),e(p,{variant:"body2",children:o("myList.pageDescription2")}),e(p,{variant:"body2",children:o("myList.pageDescription3")})]}),e(xe,{shipListState:n,columnConfig:c})]})}),a&&e(Te,{ships:a,onClose:L}),e(ge,{disableContainer:M})]})};export{_e as MyListPage,_e as default};
