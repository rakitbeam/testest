import{c as q,i as U,r as P,t as o,a as D,S as g,b as R,d as b,s as $,g as F,e as V,f as N,h as M,j as d,k as j,l as z,o as W,m as H,n as u,F as f,p as e,q as G,u as T,B as C,T as p,v as k,w,x as K,y as J,z as Q,A as X}from"./index.d26a588e.js";import{d as Y}from"./Settings.857fdba2.js";import{e as E,S as Z,c as ee,a as te,b as ie,d as ae,f as ne}from"./ShipTypeFilterButton.e3d4c7d1.js";import{A as se}from"./ActionBar.6f137e82.js";import{C as oe,S as re,c as le}from"./ShipDataTable.70490d8e.js";import{d as ce,a as O}from"./ContentCopy.f8e041bb.js";import{d as pe,C as de}from"./ConfirmationDialog.a59e29c8.js";import{B as ue}from"./ButtonMenu.62accbf2.js";import{n as he}from"./sorting.c6946657.js";import{A as me,T as ye}from"./TextField.f1e5bf8d.js";import{E as fe}from"./ExpandStack.e70cf32f.js";import{R as ge}from"./ResponsiveDialog.88b64cc2.js";import{N as Se,P as Ce}from"./PageContent.70e41135.js";import{P as xe}from"./PageFooter.b940f3e8.js";import"./domUtils.41cc6831.js";import"./useFormControl.93476e47.js";import"./useTable.8424afe8.js";import"./TableRow.fab1f005.js";import"./DialogContentText.fa62da23.js";import"./Select.a7210ce4.js";var B={},be=U.exports;Object.defineProperty(B,"__esModule",{value:!0});var I=B.default=void 0,ve=be(q),Fe=P,Te=(0,ve.default)((0,Fe.jsx)("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H15v-8h5V8l-6-6zm-1 7V3.5L18.5 9H13zm4 12.66V16h5.66v2h-2.24l2.95 2.95-1.41 1.41L19 19.41v2.24h-2z"}),"FileOpen");I=B.default=Te;function _(r,i){const t=[],n=[],s=[],h=[],c=[];r.forEach(a=>{switch(a.row){case g.FRONT:{t.push(a);break}case g.MIDDLE:{n.push(a);break}case g.BACK:{s.push(a);break}default:switch(a.type){case b.CORVETTE:{h.push(a);break}case b.FIGHTER:{c.push(a);break}}}});const l=he([(a,m)=>$(a.type,a.subType)-$(m.type,m.subType),(a,m)=>F(a).localeCompare(F(m),V())]);return[o("label.acquiredShipsAndBlueprints"),[o("myList.groupNameForSharing",{name:D(g.FRONT)}),...t.sort(l).map(a=>S(a,i))].join(`
`),[o("myList.groupNameForSharing",{name:D(g.MIDDLE)}),...n.sort(l).map(a=>S(a,i))].join(`
`),[o("myList.groupNameForSharing",{name:D(g.BACK)}),...s.sort(l).map(a=>S(a,i))].join(`
`),[o("myList.groupNameForSharing",{name:R(b.CORVETTE)}),...h.sort(l).map(a=>S(a,i))].join(`
`),[o("myList.groupNameForSharing",{name:R(b.FIGHTER)}),...c.sort(l).map(a=>S(a,i))].join(`
`)].join(`

`)}function S(r,i){const t=N(r,i);return t.length===0?`\u3000${F(r)}`:[`\u3000${F(r)}`,t.map(n=>`\u3000\u2517 ${n.category}${n.categoryNumber} ${M(r.id,n)}`).join(`
`)].join(`
`)}const we=r=>{const{onCopyAsText:i}=r,[t,n]=d.exports.useState(null),s=d.exports.useMemo(()=>{if(!t)return null;const l=E(j,t.ships);return _(l,t)},[t]),h=d.exports.useCallback(l=>{switch(l){case"copyAsText":{i();break}case"import":{(async()=>{const a=await W();a&&n(a)})();break}case"export":{z();break}}},[]),c=d.exports.useCallback(()=>{t&&(H(t),n(null),window.location.reload())},[t]);return u(f,{children:[e(ue,{icon:e(ce,{}),text:o("button.share"),value:void 0,onClick:h,options:[{key:"copyAsText",icon:e(O,{}),text:o("myList.copyAsText"),value:"copyAsText"},{key:"export",icon:e(pe,{}),text:o("myList.exportToFile"),value:"export"},{key:"import",icon:e(I,{}),text:o("myList.importFromFile"),value:"import",disabled:!G()}]}),t&&e(de,{title:o("myList.importConfirmTitle"),question:u(T,{children:[e(me,{severity:"warning",children:o("myList.importConfirmWarning")}),e(C,{p:1,children:e(p,{variant:"body2",component:"div",children:e("pre",{children:s})})})]}),onConfirm:c,onCancel:()=>n(null)})]})},Le=r=>{const{shipFilter:i,columnConfig:t,onEdit:n,onFilter:s,onCopyAsText:h,onColumnConfigChange:c}=r;return e(se,{left:l=>u(f,{children:[e(oe,{columnConfig:t,onChange:c,disableResearchAgreementOptions:!0,buttonProps:l},"columnConfig"),e(Z,{filter:i,onChange:s,researchManufacturer:!1,researchStrategyTypes:!1,researchTacticTypes:!1,buttonProps:l},"filter"),e(k,{variant:"outlined",startIcon:e(Y,{}),onClick:n,...l,children:o("myList.editMyList")},"edit")]}),right:l=>e(f,{children:e(we,{onCopyAsText:h})})})},De=r=>{const{ship:i}=r,{userSettings:t}=w(),n=d.exports.useMemo(()=>N(i,t),[i,t]);return n.length===0?null:e(C,{mt:.5,children:n.map(s=>u(p,{variant:"body2",color:"text.secondary",children:[e(p,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${s.category}${s.categoryNumber} ${M(i.id,s)}`]},s.id))})},ke=r=>{const{ship:i}=r,{userSettings:t}=w(),n=d.exports.useMemo(()=>K(i,t),[i,t]);return n.length===0?null:e(C,{mt:.5,children:n.map(s=>u(p,{variant:"body2",color:"text.secondary",children:[e(p,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${s.category}${s.categoryNumber} ${M(i.id,s)}`]},s.id))})},v=d.exports.memo(re),Me=r=>{const{shipListState:i,columnConfig:t}=r;return u(T,{spacing:1,children:[e(fe,{expandables:[{id:"possessed-ships",initiallyOpened:!0,summary:e(p,{variant:"body1",children:o("label.acquiredShipsAndBlueprints")}),details:e(v,{shipDefinitions:i.possessed,columnConfig:t,decorateName:(n,s)=>u(f,{children:[n,e(De,{ship:s})]})})},{id:"wished-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("label.wantedBlueprints")}),details:e(v,{shipDefinitions:i.wished,columnConfig:t,decorateName:(n,s)=>u(f,{children:[n,e(ke,{ship:s})]})})},{id:"unwished-by-user-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("label.unwantedBlueprints")}),details:e(v,{shipDefinitions:i.unwishedByUser,columnConfig:t})},{id:"unwished-by-data-ships",initiallyOpened:!1,summary:e(p,{variant:"body1",children:o("myList.unwantedDuplicates")}),details:u(f,{children:[e(v,{shipDefinitions:i.unwishedByData,columnConfig:t}),e(C,{pt:1,children:e(p,{variant:"caption",align:"right",paragraph:!0,children:o("myList.unwantedDuplicatesFootnote")})})]})}]}),e(p,{variant:"caption",align:"right",paragraph:!0,children:o("myList.pageFootnote")})]})},Be=r=>{const{ships:i,onClose:t}=r,[n,s]=d.exports.useState(!1),{userSettings:h}=w(),[c,l]=d.exports.useState(()=>_(i.possessed,h)),a=()=>{c&&Q(c).then(()=>{s(!0)})},m=L=>{l(L.target.value)},x=()=>{t(),s(!1)};return e(ge,{title:o("button.share"),content:u(T,{spacing:1,children:[e(ye,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:m,rows:10,defaultValue:c,fullWidth:!0}),!!navigator.clipboard&&e(k,{variant:"outlined",startIcon:n?e(J,{}):e(O,{}),onClick:a,fullWidth:!0,children:o("button.copyToClipboard")})]}),actions:e(k,{variant:"outlined",onClick:x,children:o("button.close")}),onClose:x})},Xe=()=>{const r=X(),{userSettings:i}=w(),[t,n]=d.exports.useState(ee),[s,h]=d.exports.useState(null),[c,l]=d.exports.useState(()=>le({name:!0,row:!0,type:!0,cost:!1,operationLimit:!1})),a=d.exports.useMemo(()=>{const y=te(j,t);return{possessed:E(y,i.ships),wished:ie(y,i),unwishedByUser:ae(y,i.ships),unwishedByData:ne(y,i)}},[i,t]),m=()=>{r("/myList/edit")},x=()=>{h(a)},L=()=>{h(null)},A=Object.values(c).filter(y=>typeof y=="boolean"&&y).length>3;return u(f,{children:[e(Se,{currentRoute:"/myList"}),e(Le,{shipFilter:t,columnConfig:c,onEdit:m,onFilter:n,onCopyAsText:x,onColumnConfigChange:l}),e(Ce,{disableContainer:A,children:u(C,{p:1,children:[u(T,{pt:1,pb:2,spacing:2,children:[e(p,{variant:"body2",children:o("myList.pageDescription1")}),e(p,{variant:"body2",children:o("myList.pageDescription2")}),e(p,{variant:"body2",children:o("myList.pageDescription3")})]}),e(Me,{shipListState:a,columnConfig:c})]})}),s&&e(Be,{ships:s,onClose:L}),e(xe,{disableContainer:A})]})};export{Xe as MyListPage,Xe as default};
