var Y=Object.defineProperty,q=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var k=(t,e,r)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,f=(t,e)=>{for(var r in e||(e={}))Q.call(e,r)&&k(t,r,e[r]);if(j)for(var r of j(e))X.call(e,r)&&k(t,r,e[r]);return t},E=(t,e)=>q(t,V(e));import{v as B,w as H,x as w,r as h,b as A,F as Z,y as ee,j as l,h as C,P as te,G as re,z as ae,A as se,c as K,M as le,E as ne,I as ue,J as oe,K as ie,D as ce,S as de}from"./vendor.612e55a5.js";import{i as L,g as Se,S,e as m,M as u,R as o,f as i,h as N,j as I,t as Oe,k as Te,l as fe,m as Ie,n as _e}from"./index.1d6337e7.js";import{P as U,W as y}from"./WishState.3db35fd5.js";import{g as Ee}from"./domUtils.e9df6b0f.js";var b={},Ne=H.exports;Object.defineProperty(b,"__esModule",{value:!0});var $=b.default=void 0,Re=Ne(B),he=w,Ae=(0,Re.default)((0,he.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAlt");$=b.default=Ae;var v={},Fe=H.exports;Object.defineProperty(v,"__esModule",{value:!0});var g=v.default=void 0,Pe=Fe(B),Ce=w,me=(0,Pe.default)((0,Ce.jsx)("path",{d:"M19.79 5.61C20.3 4.95 19.83 4 19 4H6.83l7.97 7.97 4.99-6.36zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41L2.81 2.81z"}),"FilterAltOff");g=v.default=me;function De(t){return(t!=null?t:[S.FRONT,S.MIDDLE,S.BACK]).map(e=>({filterKey:e,name:Oe(e)}))}function pe(t){return(t!=null?t:Object.keys(m)).map(e=>({filterKey:e,name:m[e].name}))}function Me(t){return(t!=null?t:[u.JUPITER_INDUSTRIES,u.NOMA_SHIPPING_GROUP,u.ANTONIOS_CONSORTIUM,u.DAWN_ACCORD]).map(e=>({filterKey:e,name:Te(e)}))}function Ue(t){return(t!=null?t:[o.JUPITER_INDUSTRIES,o.NOMA_SHIPPING_GROUP,o.ANTONIOS_CONSORTIUM,o.DAWN_ACCORD]).map(e=>({filterKey:e,name:`\u59D4\u8A17\u4F01\u696D\uFF1A${fe(e)}`}))}function ye(t){return(t!=null?t:[i.OUTSTANDING_FIREPOWER,i.SUSTAINED_COMBAT,i.STRATEGY_AND_SUPPORT,i.FIGHTER_AND_CORVETTE]).map(e=>({filterKey:e,name:`\u6226\u7565\u80FD\u529B\uFF1A${Ie(e)}`}))}function be(t){return(t!=null?t:[N.PROJECTILE_WEAPONS,N.DIRECT_FIRE_WEAPONS]).map(e=>({filterKey:e,name:`\u6226\u8853\u6027\u80FD\uFF1A${_e(e)}`}))}function ve(t={}){var e,r,a,s,n,O;return[...De((e=t.shipRows)!=null?e:null),...pe((r=t.shipTypes)!=null?r:null),...Me((a=t.manufacturer)!=null?a:null),...t.researchManufacturer===!1?[]:Ue((s=t.researchManufacturer)!=null?s:null),...t.researchStrategyTypes===!1?[]:ye((n=t.researchStrategyTypes)!=null?n:null),...t.researchTacticTypes===!1?[]:be((O=t.researchTacticTypes)!=null?O:null)]}function ze(){return E(f({[S.FRONT]:!1,[S.MIDDLE]:!1,[S.BACK]:!1},Object.keys(m).reduce((t,e)=>E(f({},t),{[e]:!1}),{})),{[u.JUPITER_INDUSTRIES]:!1,[u.NOMA_SHIPPING_GROUP]:!1,[u.ANTONIOS_CONSORTIUM]:!1,[u.DAWN_ACCORD]:!1,[o.JUPITER_INDUSTRIES]:!1,[o.NOMA_SHIPPING_GROUP]:!1,[o.ANTONIOS_CONSORTIUM]:!1,[o.DAWN_ACCORD]:!1,[i.OUTSTANDING_FIREPOWER]:!1,[i.SUSTAINED_COMBAT]:!1,[i.STRATEGY_AND_SUPPORT]:!1,[i.FIGHTER_AND_CORVETTE]:!1,[N.PROJECTILE_WEAPONS]:!1,[N.DIRECT_FIRE_WEAPONS]:!1})}function xe(t){const e=f({},t);return Object.keys(e).forEach(r=>{e[r]=!1}),e}function Ye(t,e){let r=t;return We(e)&&(r=r.filter(a=>e[a.row]===!0)),Ge(e)&&(r=r.filter(a=>e[a.type]===!0)),je(e)&&(r=r.filter(a=>e[a.manufacturer]===!0)),ke(e)&&(r=r.filter(a=>a.researchManufacturer&&e[a.researchManufacturer]===!0)),Be(e)&&(r=r.filter(a=>{var s;return((s=a.researchStrategyTypes)!=null?s:[]).some(n=>e[n]===!0)})),He(e)&&(r=r.filter(a=>{var s;return((s=a.researchTacticTypes)!=null?s:[]).some(n=>e[n]===!0)})),r}function qe(t){const e={[I.STARTER_SHIP]:[],[I.TECH_FILE]:[],[I.CITY_TRADE]:[],[I.DOCK_EFFECT]:[],[I.UNKNOWN]:[]};return t.forEach(r=>{e[r.source].push(r)}),e}function We(t){return[S.FRONT,S.MIDDLE,S.BACK].some(e=>t[e]===!0)}function Ge(t){return Object.keys(m).some(e=>t[e]===!0)}function je(t){return[u.JUPITER_INDUSTRIES,u.NOMA_SHIPPING_GROUP,u.ANTONIOS_CONSORTIUM,u.DAWN_ACCORD].some(e=>t[e]===!0)}function ke(t){return[o.JUPITER_INDUSTRIES,o.NOMA_SHIPPING_GROUP,o.ANTONIOS_CONSORTIUM,o.DAWN_ACCORD].some(e=>t[e]===!0)}function Be(t){return[i.OUTSTANDING_FIREPOWER,i.SUSTAINED_COMBAT,i.STRATEGY_AND_SUPPORT,i.FIGHTER_AND_CORVETTE].some(e=>t[e]===!0)}function He(t){return[N.PROJECTILE_WEAPONS,N.DIRECT_FIRE_WEAPONS].some(e=>t[e]===!0)}function Ve(t,e){return t.filter(r=>{var a;return((a=e[r.id])==null?void 0:a.possession)===U.POSSESSED})}function Qe(t,e){return t.filter(r=>{var a;return((a=e[r.id])==null?void 0:a.wish)===y.WANTED})}function Xe(t,e){return t.filter(r=>{var a;return L(r.id)&&((a=e[r.id])==null?void 0:a.wish)===y.NOT_WANTED})}function Ze(t,e){return t.filter(s=>s.source===I.TECH_FILE||s.source===I.STARTER_SHIP).filter(s=>{var n;return((n=e[s.id])==null?void 0:n.possession)===U.POSSESSED}).filter(s=>{var n,O,F;if(!!s.modules&&s.modules.length>0||s.baseModelId)return!1;if(!!s.subModelIds||!!s.baseModelId){const d=(F=(O=s.subModelIds)!=null?O:(n=Se(s.baseModelId))==null?void 0:n.subModelIds)!=null?F:[];return we(d,e)?!(d.filter(T=>L(T)&&!!e[T]&&e[T].possession!==U.POSSESSED).filter(T=>e[T].wish!==y.NOT_WANTED).length>0):!1}return!0})}function we(t,e){return t.length>0&&t.every(r=>{var a;return!!((a=e[r])==null?void 0:a.possession)})}const et=t=>{const{onChange:e,popperProps:r,shipRows:a,shipTypes:s,researchManufacturer:n,researchStrategyTypes:O,researchTacticTypes:F,buttonProps:d}=t,[_,D]=h.exports.useState(t.filter),[T,p]=h.exports.useState(!1),[J]=h.exports.useState(()=>ve({shipRows:a,shipTypes:s,researchManufacturer:n,researchStrategyTypes:O,researchTacticTypes:F})),M=h.exports.useRef(null),z=c=>{D(P=>E(f({},P),{[c]:!P[c]}))},x=()=>{D(c=>xe(c))};h.exports.useEffect(()=>{const c=setTimeout(()=>{e(_)},0);return()=>clearTimeout(c)},[_,e]);const W=Object.values(_).some(c=>c);return A(Z,{children:[A(ee,{variant:"outlined",ref:M,fullWidth:d==null?void 0:d.fullWidth,size:d==null?void 0:d.size,children:[l(C,{startIcon:l($,{}),onClick:()=>p(!0),sx:{flexShrink:1},children:"\u30D5\u30A3\u30EB\u30BF\u30FC"}),W&&l(C,{size:"small",onClick:x,sx:{flexShrink:3},children:l(g,{})})]},"filter"),l(te,E(f({open:T,anchorEl:M.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:1}},r),{children:({TransitionProps:c,placement:P})=>{var G;return l(re,E(f({},c),{style:{transformOrigin:P==="bottom"?"center top":"center bottom"},children:l("div",{children:l(ae,{onClickAway:()=>p(!1),children:A(se,{children:[l(K,{sx:{overflowY:"auto",maxHeight:`${((G=Ee(M.current))!=null?G:0)-50}px`},children:l(le,{id:"split-button-menu",children:J.map(R=>A(ne,{selected:_[R.filterKey],onClick:()=>z(R.filterKey),children:[l(ue,{children:l(oe,{edge:"start",checked:_[R.filterKey],tabIndex:-1,disableRipple:!0})}),l(ie,{children:R.name})]},R.filterKey))})}),l(ce,{}),l(K,{p:1,display:"flex",justifyContent:"end",children:A(de,{spacing:1,direction:"row",children:[l(C,{variant:"outlined",onClick:x,disabled:!W,children:"\u5168\u3066\u5916\u3059"}),l(C,{variant:"outlined",onClick:()=>p(!1),children:"\u9589\u3058\u308B"})]})})]})})})}))}}))]})};export{et as S,Ye as a,Qe as b,ze as c,Xe as d,Ve as e,Ze as f,qe as s};
